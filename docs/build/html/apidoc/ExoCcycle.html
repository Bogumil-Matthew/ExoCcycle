<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>ExoCcycle package &#8212; ExoCcycle  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="../_static/basic.css?v=686e5160" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=27fed22d" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="ExoCcycle" href="modules.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="exoccycle-package">
<h1>ExoCcycle package<a class="headerlink" href="#exoccycle-package" title="Link to this heading">¶</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading">¶</a></h2>
</section>
<section id="module-ExoCcycle.Bathymetry">
<span id="exoccycle-bathymetry-module"></span><h2>ExoCcycle.Bathymetry module<a class="headerlink" href="#module-ExoCcycle.Bathymetry" title="Link to this heading">¶</a></h2>
<p>Created on Tue Sep  6 15:20:00 2024</p>
<p>&#64;author: Matthew Bogumil</p>
<dl class="py class">
<dt class="sig sig-object py" id="ExoCcycle.Bathymetry.BathyMeasured">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ExoCcycle.Bathymetry.</span></span><span class="sig-name descname"><span class="pre">BathyMeasured</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">body</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/Bathymetry.html#BathyMeasured"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.Bathymetry.BathyMeasured" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Measured topography/bathymetry helper for Venus, Earth, Mars, and Moon.</p>
<p>This class downloads publicly available planetary topography datasets,
reprojects / converts them to NetCDF when needed, resamples to a chosen
angular resolution, and derives a bathymetry model by flooding the
topography to satisfy either an ocean-area or water-volume constraint.
It also exports bathymetry grids and related carbon-cycle distributions
in NetCDF format for downstream use in ExoCcycle.</p>
<p class="rubric">Notes</p>
<ul class="simple">
<li><dl class="simple">
<dt>Downloaded sources (indicative):</dt><dd><ul>
<li><p>Venus (Magellan): USGS Planetary Data (GeoTIFF → NetCDF) - <a class="reference external" href="https://astrogeology.usgs.gov/search/map/venus_magellan_global_c3_mdir_colorized_topographic_mosaic_6600m">https://astrogeology.usgs.gov/search/map/venus_magellan_global_c3_mdir_colorized_topographic_mosaic_6600m</a></p></li>
<li><p>Venus (PDS IMG): PDS Geosciences Node (IMG → NetCDF) - <a class="reference external" href="https://pds-geosciences.wustl.edu/mgn/mgn-v-rss-5-gravity-l2-v1/mg_5201/images/topogrd.img">https://pds-geosciences.wustl.edu/mgn/mgn-v-rss-5-gravity-l2-v1/mg_5201/images/topogrd.img</a></p></li>
<li><p>Earth: ETOPO1 (NetCDF/GRD) - <a class="reference external" href="https://www.ngdc.noaa.gov/mgg/global/relief/ETOPO1/data/ice_surface/cell_registered/netcdf/">https://www.ngdc.noaa.gov/mgg/global/relief/ETOPO1/data/ice_surface/cell_registered/netcdf/</a></p></li>
<li><p>Mars: MOLA (NetCDF) - <a class="reference external" href="https://github.com/andrebelem/PlanetaryMaps/raw/v1.0/mola32.nc">https://github.com/andrebelem/PlanetaryMaps/raw/v1.0/mola32.nc</a></p></li>
<li><p>Moon: Planetary Geodesy Data Archive (PGDA) - <a class="reference external" href="https://pgda.gsfc.nasa.gov/data/LOLA_PA/LDEM64_PA_pixel_202405.grd">https://pgda.gsfc.nasa.gov/data/LOLA_PA/LDEM64_PA_pixel_202405.grd</a></p></li>
</ul>
</dd>
</dl>
</li>
<li><p>Several steps invoke external CLI tools (GMT, GDAL, wget). Ensure they
are installed and available on <code class="docutils literal notranslate"><span class="pre">PATH</span></code>.</p></li>
<li><p>Longitudes are normalized to <code class="docutils literal notranslate"><span class="pre">[-180,</span> <span class="pre">180]</span></code> and latitudes to
<code class="docutils literal notranslate"><span class="pre">[-90,</span> <span class="pre">90]</span></code>; cell registration is preserved during resampling.</p></li>
</ul>
<section id="attributes-set-after-initialization-or-workflow-steps">
<h3>Attributes (set after initialization or workflow steps)<a class="headerlink" href="#attributes-set-after-initialization-or-workflow-steps" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>model<span class="classifier">str</span></dt><dd><p>One of <code class="docutils literal notranslate"><span class="pre">{&quot;Venus2&quot;,&quot;Venus&quot;,&quot;Earth&quot;,&quot;Mars&quot;,&quot;Moon&quot;}</span></code>.</p>
</dd>
<dt>fidName<span class="classifier">str</span></dt><dd><p>Canonical filename of the raw source grid for the selected body.</p>
</dd>
<dt>variables<span class="classifier">dict</span></dt><dd><p>Mapping of variable names present in the source NetCDF/GRD/IMG
(e.g., <code class="docutils literal notranslate"><span class="pre">{&quot;lat&quot;:&quot;lat&quot;,</span> <span class="pre">&quot;lon&quot;:&quot;lon&quot;,</span> <span class="pre">&quot;elev&quot;:&quot;z&quot;}</span></code>).</p>
</dd>
<dt>initiallykm<span class="classifier">bool</span></dt><dd><p>Whether the input elevation is given in kilometers (converted to meters).</p>
</dd>
<dt>radiuskm<span class="classifier">float</span></dt><dd><p>Planetary radius (km) used for area computations.</p>
</dd>
<dt>highlatP<span class="classifier">float</span></dt><dd><p>Decimal fraction of ocean area designated as “high-latitude box”
for LOSCAR-style parameterization.</p>
</dd>
<dt>resolution<span class="classifier">float</span></dt><dd><p>Target angular resolution (degrees) set by <a class="reference internal" href="#ExoCcycle.Bathymetry.BathyMeasured.readTopo" title="ExoCcycle.Bathymetry.BathyMeasured.readTopo"><code class="xref py py-meth docutils literal notranslate"><span class="pre">readTopo()</span></code></a>.</p>
</dd>
<dt>data_dir<span class="classifier">str</span></dt><dd><p>Root directory used to store inputs/outputs.</p>
</dd>
<dt>lon, lat<span class="classifier">ndarray</span></dt><dd><p>2-D cell-registered longitudes/latitudes (deg) for resampled grids.</p>
</dd>
<dt>elev<span class="classifier">ndarray</span></dt><dd><p>2-D topography (meters; positive above sea level).</p>
</dd>
<dt>bathymetry<span class="classifier">ndarray</span></dt><dd><p>2-D seafloor depth (meters; positive), land masked as NaN.</p>
</dd>
<dt>areaWeights<span class="classifier">ndarray</span></dt><dd><p>2-D area weight per cell (m²) for the selected radius/resolution.</p>
</dd>
<dt>AOC, VOC<span class="classifier">float</span></dt><dd><p>Ocean surface area (m²) and ocean volume (m³) of derived bathymetry.</p>
</dd>
<dt>highlatA<span class="classifier">float</span></dt><dd><p>High-latitude ocean area (m²) implied by <code class="docutils literal notranslate"><span class="pre">highlatP</span></code>.</p>
</dd>
<dt>highlatlat<span class="classifier">float</span></dt><dd><p>Latitude cutoff (deg) delimiting the high-latitude region.</p>
</dd>
<dt>bathymetryAreaDist, bathymetryAreaDist_wHighlat<span class="classifier">ndarray</span></dt><dd><p>Kernelized/semi-binned bathymetry distributions (global w/o and with
high-latitude contribution).</p>
</dd>
<dt>binEdges<span class="classifier">ndarray</span></dt><dd><p>Bin edges (km) used for bathymetry distributions.</p>
</dd>
<dt>nc, bathync<span class="classifier">netCDF4.Dataset</span></dt><dd><p>Open handles to resampled topography and saved bathymetry NetCDFs
(when used).</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.Bathymetry.BathyMeasured.getTopo">
<span class="sig-name descname"><span class="pre">getTopo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/Bathymetry.html#BathyMeasured.getTopo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.Bathymetry.BathyMeasured.getTopo" title="Link to this definition">¶</a></dt>
<dd><p>Download (if needed) and convert the selected body’s topography.</p>
<p>The method creates a structured directory tree under
<code class="docutils literal notranslate"><span class="pre">{data_dir}/topographies/{Body}</span></code>, pulls remote datasets using
<code class="docutils literal notranslate"><span class="pre">wget</span></code>, converts GRD/IMG/GeoTIFF to NetCDF (via GDAL/GMT), and
optionally produces a quicklook PostScript using GMT.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – Root directory for data storage. Subfolders will be created per body.</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <em>optional</em>) – If True, emits GMT preview commands to generate simple plots.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Creates</span></code></p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">-------</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{data_dir}</span></code><code class="xref py py-class docutils literal notranslate"><span class="pre">/topographies/```{Body}`</span></code><code class="xref py py-class docutils literal notranslate"><span class="pre">/&lt;source&gt;.nc</span></code> – NetCDF representation of the raw/global topography.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{data_dir}</span></code><code class="xref py py-class docutils literal notranslate"><span class="pre">/topographies/```{Body}`</span></code><code class="xref py py-class docutils literal notranslate"><span class="pre">/```{Body}`</span></code><code class="xref py py-class docutils literal notranslate"><span class="pre">ps</span></code> – (Optional) Quicklook GMT plot when <code class="docutils literal notranslate"><span class="pre">verbose=True</span></code>.</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Dependencies</span></code></p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">------------</span></code></p></li>
<li><p><strong>Requires external tools</strong> (<code class="docutils literal notranslate"><span class="pre">wget</span></code>, <code class="docutils literal notranslate"><span class="pre">gdalwarp</span></code>, <code class="docutils literal notranslate"><span class="pre">gdal_translate</span></code>,)</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">and/or</span> <span class="pre">``gmt`</span></code> depending on the source.`</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.Bathymetry.BathyMeasured.readBathymetry">
<span class="sig-name descname"><span class="pre">readBathymetry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/Bathymetry.html#BathyMeasured.readBathymetry"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.Bathymetry.BathyMeasured.readBathymetry" title="Link to this definition">¶</a></dt>
<dd><p>Open a previously saved bathymetry NetCDF for this body/resolution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <em>optional</em>) – Unused here (reserved for symmetry with other methods).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Side</span> <span class="pre">Effects</span></code></p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">------------</span></code></p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Opens</span></code> and <code class="xref py py-class docutils literal notranslate"><span class="pre">stores</span> <span class="pre">a</span> <span class="pre">handle</span></code> to <code class="xref py py-class docutils literal notranslate"><span class="pre">the</span> <span class="pre">dataset</span> <span class="pre">at</span></code></p></li>
<li><p>:class:<code class="docutils literal notranslate"><span class="pre">`self.bathync</span> <span class="pre">=</span> <span class="pre">Dataset(path`,</span> <span class="pre">``'r'</span></code><code class="xref py py-class docutils literal notranslate"><span class="pre">)`</span></code>. The path is resolved using`</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">self.data_dir</span></code>, <code class="docutils literal notranslate"><span class="pre">self.model</span></code>, and <code class="docutils literal notranslate"><span class="pre">self.resolution</span></code>.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.Bathymetry.BathyMeasured.readTopo">
<span class="sig-name descname"><span class="pre">readTopo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_resolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/Bathymetry.html#BathyMeasured.readTopo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.Bathymetry.BathyMeasured.readTopo" title="Link to this definition">¶</a></dt>
<dd><p>Load and resample topography to a uniform lat/lon grid.</p>
<p>If a resampled NetCDF at the requested resolution already exists, it
is read directly; otherwise the raw grid is opened, optionally
resampled via GMT for very high input resolutions (&gt;3600 columns),
normalized to conventional lat/lon ranges, and then interpolated
to a cell-registered grid of spacing <code class="docutils literal notranslate"><span class="pre">new_resolution</span></code> degrees
using nearest-neighbor interpolation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – Root directory containing the per-body <code class="docutils literal notranslate"><span class="pre">topographies</span></code> folder.</p></li>
<li><p><strong>new_resolution</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, <em>optional</em>) – Output angular resolution in degrees (e.g., 1, 0.5). Default 1.</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <em>optional</em>) – If True, prints array shapes/ranges and plots a global map.</p></li>
<li><p><strong>Defines</strong></p></li>
<li><p><strong>-------</strong></p></li>
<li><p><strong>self.resolution</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – Set to <code class="docutils literal notranslate"><span class="pre">new_resolution</span></code>.</p></li>
<li><p><strong>self.data_dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>)</p></li>
<li><p><strong>self.lon</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – 2-D cell-registered longitudes/latitudes (deg).</p></li>
<li><p><strong>self.lat</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – 2-D cell-registered longitudes/latitudes (deg).</p></li>
<li><p><strong>self.elev</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – 2-D elevation (meters).</p></li>
<li><p><strong>reuse.</strong> (<em>Also writes the resampled topography NetCDF for</em>)</p></li>
<li><p><strong>Writes</strong></p></li>
<li><p><strong>------</strong></p></li>
<li><p><strong>{data_dir}/topographies/{Body}/{Body}_resampled_{res}deg.nc</strong></p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Input units in km (e.g., some Venus/Moon products) are converted to meters.</p></li>
<li><p>Longitudes &gt;180 are wrapped to <code class="docutils literal notranslate"><span class="pre">[-180,180]</span></code> and arrays are rolled so that
longitudes are monotonic.</p></li>
<li><p>The output grid is cell-registered, spanning the full sphere.</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.Bathymetry.BathyMeasured.saveBathymetry">
<span class="sig-name descname"><span class="pre">saveBathymetry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/Bathymetry.html#BathyMeasured.saveBathymetry"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.Bathymetry.BathyMeasured.saveBathymetry" title="Link to this definition">¶</a></dt>
<dd><p>Save the derived bathymetry and summary parameters to NetCDF.</p>
<p>The output file contains gridded bathymetry plus global area weights,
bathymetry distributions (with/without high-latitude region),
bin edges, and scalar integrals (AOC, VOC, etc.).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <em>optional</em>) – If True, creates the output directory tree if needed
and prints paths/actions.</p></li>
<li><p><strong>Writes</strong></p></li>
<li><p><strong>------</strong></p></li>
<li><p><strong>{data_dir}/bathymetries/{Body}/{Body}_resampled_{res}deg.nc</strong> – <dl class="simple">
<dt>Variables:</dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">bathymetry(lat,lon)</span></code> : m</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lat(lat)</span></code> : deg_north</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lon(lon)</span></code> : deg_east</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">areaWeights(lat)</span></code> : m² (per-latitude row representative)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">binEdges(binEdges)</span></code> : km</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bathymetry-distribution-G(binEdges)</span></code> : kernel distribution</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bathymetry-distribution-whighlat-G(binEdges)</span></code> : kernel distribution</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">highlatlat</span></code> : deg</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">highlatA</span></code> : m²</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">VOC</span></code> : m³</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">AOC</span></code> : m²</p></li>
</ul>
</dd>
</dl>
</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The latitude/longitude axes are written as vectors paired with
cell-registered 2-D data.</p></li>
<li><p>Title metadata encodes the body and resolution.</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.Bathymetry.BathyMeasured.setSeaLevel">
<span class="sig-name descname"><span class="pre">setSeaLevel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">basinVolume</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'on':</span> <span class="pre">True,</span> <span class="pre">'uncompactedVol':</span> <span class="pre">None}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">oceanArea</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'area':</span> <span class="pre">0.7,</span> <span class="pre">'on':</span> <span class="pre">True}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">isostaticCompensation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'on':</span> <span class="pre">False}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/Bathymetry.html#BathyMeasured.setSeaLevel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.Bathymetry.BathyMeasured.setSeaLevel" title="Link to this definition">¶</a></dt>
<dd><p>Derive bathymetry from the resampled topography by flooding.</p>
<p>One of two constraints is used::
1) <strong>Area constraint</strong> (<code class="docutils literal notranslate"><span class="pre">oceanArea['on']</span></code>): Flood until oceans cover</p>
<blockquote>
<div><p>the specified decimal fraction of the globe.</p>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p><strong>Volume constraint</strong> (<code class="docutils literal notranslate"><span class="pre">basinVolume['on']</span></code>): Flood until the total
ocean volume equals <code class="docutils literal notranslate"><span class="pre">uncompactedVol</span></code> (m³).</p></li>
</ol>
<p>Optionally, a placeholder is provided for isostatic compensation of
water loading (not implemented).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>basinVolume</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>) – <code class="docutils literal notranslate"><span class="pre">{&quot;on&quot;:</span> <span class="pre">bool,</span> <span class="pre">&quot;uncompactedVol&quot;:</span> <span class="pre">float</span> <span class="pre">or</span> <span class="pre">None}</span></code>. Enable and set
the target ocean volume (m³).</p></li>
<li><p><strong>oceanArea</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>) – <code class="docutils literal notranslate"><span class="pre">{&quot;on&quot;:</span> <span class="pre">bool,</span> <span class="pre">&quot;area&quot;:</span> <span class="pre">float}</span></code>. Enable and set target ocean area
as a decimal fraction (e.g., 0.7 for 70%).</p></li>
<li><p><strong>isostaticCompensation</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>) – <code class="docutils literal notranslate"><span class="pre">{&quot;on&quot;:</span> <span class="pre">bool}</span></code>. If True, calls a placeholder routine
(currently non-functional).</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <em>optional</em>) – If True, prints progress when using the volume method.</p></li>
<li><p><strong>Defines</strong></p></li>
<li><p><strong>-------</strong></p></li>
<li><p><strong>self.bathymetry</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – Seafloor depth (meters, positive); land cells are NaN.</p></li>
<li><p><strong>self.areaWeights</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – Per-cell area weights (m²) from a spherical model at planet radius.</p></li>
<li><p><strong>self.AOC</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – Ocean surface area (m²).</p></li>
<li><p><strong>self.VOC</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – Ocean volume (m³).</p></li>
<li><p><strong>self.highlatlat</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – High-latitude cutoff latitude (deg) and high-latitude ocean area (m²),
via <code class="docutils literal notranslate"><span class="pre">calculateHighLatA</span></code>.</p></li>
<li><p><strong>self.highlatA</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – High-latitude cutoff latitude (deg) and high-latitude ocean area (m²),
via <code class="docutils literal notranslate"><span class="pre">calculateHighLatA</span></code>.</p></li>
<li><p><strong>self.bathymetryAreaDist</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – Global bathymetry distributions (excluding/including high-latitude),
via <code class="docutils literal notranslate"><span class="pre">calculateBathymetryDistributionGlobal</span></code>.</p></li>
<li><p><strong>self.bathymetryAreaDist_wHighlat</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – Global bathymetry distributions (excluding/including high-latitude),
via <code class="docutils literal notranslate"><span class="pre">calculateBathymetryDistributionGlobal</span></code>.</p></li>
<li><p><strong>self.binEdges</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – Bin edges (km) used for distributions.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Flooding is applied as an incremental sea-level rise (1 m steps for
area constraint, 10 m steps for volume constraint) until the target
is met.</p></li>
<li><p>Requires helper functions available as <code class="docutils literal notranslate"><span class="pre">utils.areaWeights</span></code>,
<code class="docutils literal notranslate"><span class="pre">calculateHighLatA</span></code> and <code class="docutils literal notranslate"><span class="pre">calculateBathymetryDistributionGlobal</span></code>.</p></li>
<li><p>The isostatic compensation routine is a stub.</p></li>
</ul>
</dd></dl>

</section>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ExoCcycle.Bathymetry.BathyRecon">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ExoCcycle.Bathymetry.</span></span><span class="sig-name descname"><span class="pre">BathyRecon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">directories</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/Bathymetry.html#BathyRecon"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.Bathymetry.BathyRecon" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Reconstructs global Earth bathymetry through time using a workflow
modeled after Bogumil et al. (2024, PNAS, doi:10.1073/pnas.2400232121).</p>
<section id="pipeline-conceptual">
<h3>Pipeline (conceptual)<a class="headerlink" href="#pipeline-conceptual" title="Link to this heading">¶</a></h3>
<ol class="arabic simple">
<li><p>Convert reconstructed oceanic lithosphere age (paleo-isochrons)
to first-order bathymetry via a chosen age–depth relation.</p></li>
<li><p>Add isostatically compensated deep-marine sediment thickness
using an empirical age/latitude relationship.</p></li>
<li><p>Fill continental shelves, flooded continents, and deep marine
not represented by plate reconstructions with paleoDEMs.</p></li>
<li><p>Apply a eustatic sea-level adjustment (Haq87 long-term curve).</p></li>
<li><p>Deform the global bathymetry distribution to match present-day
uncertainty and reproduce target ocean-container volumes (VOC).</p></li>
</ol>
</section>
<section id="inputs">
<h3>Inputs<a class="headerlink" href="#inputs" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>This class expects directory trees with NetCDF grids for:</dt><dd><ul class="simple">
<li><p>paleoDEMs:  files named like  &lt;prefix&gt;_&lt;Age&gt;Ma.nc</p></li>
<li><p>oceanLith:  files named like  &lt;prefix&gt;-&lt;Age&gt;.nc</p></li>
<li><p>etopo:      present-day topography/bathymetry NetCDF (single file)</p></li>
</ul>
</dd>
</dl>
</section>
<section id="attributes-high-level">
<h3>Attributes (high level)<a class="headerlink" href="#attributes-high-level" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>directories<span class="classifier">dict</span></dt><dd><p>Paths for ‘paleoDEMs’, ‘oceanLith’, and ‘etopo’.</p>
</dd>
<dt>ESL<span class="classifier">pandas.DataFrame</span></dt><dd><p>Long-term Haq87 eustatic sea-level curve with columns [‘Ma’,’m’].</p>
</dd>
<dt>radiuskm<span class="classifier">float</span></dt><dd><p>Earth radius (km), default 6371.0.</p>
</dd>
<dt>thermalSubMethod<span class="classifier">dict</span></dt><dd><p>Thermal subsidence method settings (see <cite>setThermalMethod</cite>).</p>
</dd>
<dt>VOCValuesPD, VOCValues, VOCAgeValues<span class="classifier">ndarray</span></dt><dd><p>Present-day and time-dependent target ocean volumes and their ages.</p>
</dd>
<dt>paleoDEMsfids, paleoDEMsAges<span class="classifier">ndarray</span></dt><dd><p>PaleodeM filenames and their parsed ages (Ma).</p>
</dd>
<dt>oceanLithfids, oceanLithReconAges<span class="classifier">ndarray</span></dt><dd><p>Lithosphere-age filenames and their parsed ages (Ma).</p>
</dd>
<dt>etopofid<span class="classifier">str</span></dt><dd><p>Filename for present-day ETOPO/Topo NetCDF.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Many steps call external tools (<cite>gmt</cite>, <cite>wget</cite>) and assume they are on PATH.</p></li>
<li><p>Numerous intermediate arrays (e.g., <cite>self.topography</cite>, <cite>self.bathymetry</cite>,
<cite>self.areaWeights</cite>, etc.) are defined during <cite>run</cite> or helper methods.</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.Bathymetry.BathyRecon.addThermalSub">
<span class="sig-name descname"><span class="pre">addThermalSub</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">topography</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seafloorAge</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'type':</span> <span class="pre">'CM2009'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/Bathymetry.html#BathyRecon.addThermalSub"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.Bathymetry.BathyRecon.addThermalSub" title="Link to this definition">¶</a></dt>
<dd><p>Apply thermal subsidence to an oceanic lithosphere surface using empirical
or parameterized age–depth relationships.</p>
<p>The function computes first-order bathymetric depth as a function of
seafloor age, representing the thermal contraction of the lithosphere
during conductive and convective cooling phases. The resulting depth field
is superimposed onto the existing topography array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>topography</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – 2-D array of surface elevation or base topography (m). Values at
oceanic locations will be overwritten by predicted oceanic depth.</p></li>
<li><p><strong>seafloorAge</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – 2-D grid of seafloor ages (Myr). NaN where non-oceanic.</p></li>
<li><p><strong>latitude</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – 2-D grid of latitudes (degrees), corresponding to <cite>seafloorAge</cite>.</p></li>
<li><p><strong>method</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>, <em>optional</em>) – Dictionary defining the thermal subsidence scheme. Defaults to
<code class="docutils literal notranslate"><span class="pre">{'type':</span> <span class="pre">'CM2009'}</span></code>. Accepted values are listed in <em>Notes</em>.</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <em>optional</em>) – If True, prints debug information or diagnostic comparisons.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Updated 2-D array of bathymetric depth (m) representing the thermal
subsidence of the oceanic lithosphere.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<dl>
<dt><strong>Available Methods</strong></dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'CM2009'</span></code> — Crosby &amp; McKenzie (2009):</p></li>
</ul>
<p>Empirical piecewise relation between seafloor age and depth.
- <code class="docutils literal notranslate"><span class="pre">'RK2021'</span></code> — Rosas &amp; Korenaga (2021):
Physically parameterized model with variable internal heating (H)
and mid-ocean ridge depth.</p>
</dd>
</dl>
<p><strong>Parameters used for RK2021 calculations</strong></p>
<blockquote>
<div><p>a1      = 0.001      (Slope, conductive phase [1/Myr^0.5]),
a2      = 0.0228     (Slope, convective phase [-]),
b2      = 0.0452     (Intercept, conductive phase [-]),
tmax    = 500        (Maximum seafloor age [Myr]),
ti      = 2.5        (Axis intercept (Fig. 2a RK2021) [Myr]),
rhoW    = 1000       (Water density [kg/m^3]),
rhoM    = 3300       (Surface mantle density [kg/m^3]),
rho0    = 4000       (Reference mantle density [kg/m^3]),
d       = 2.9e6      (Mantle thickness [m]),
kappa   = 4          (Thermal conductivity [W/m/K]),
alpha   = 1e-6       (Thermal expansivity [1/K]),
deltaT  = 1350       (Mantle potential temperature [K]),
nu0     = 1.3e20     (Reference viscosity [Pa·s]</p>
</div></blockquote>
<p><strong>Varying Parameters (from RK2021, Fig. 2a)</strong></p>
<blockquote>
<div><p>H* — Non-dimensionalized internal heating parameter (varies)
t* — Onset time of asthenospheric convection (varies)</p>
</div></blockquote>
<p>These values may be digitized or interpolated from Rosas &amp; Korenaga (2021)
to reconstruct the age–depth relation for specific internal heating regimes.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.Bathymetry.BathyRecon.addVOCCorrection">
<span class="sig-name descname"><span class="pre">addVOCCorrection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">age</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bathymetry</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">VOCTarget</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/Bathymetry.html#BathyRecon.addVOCCorrection"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.Bathymetry.BathyRecon.addVOCCorrection" title="Link to this definition">¶</a></dt>
<dd><p>Adjust bathymetry distributions to match a target global ocean volume (VOC).</p>
<section id="concept">
<h4>Concept<a class="headerlink" href="#concept" title="Link to this heading">¶</a></h4>
<p>This function ensures that modeled ocean basin volumes remain consistent
with a prescribed target VOC across geologic time.</p>
<ul class="simple">
<li><p>At present-day (<cite>age == 0</cite>), the model computes the depth-binned</p></li>
</ul>
<p>distribution mismatch between the simulated bathymetry and modern
ETOPO data. From this difference, a correction vector (<cite>sxbin_p</cite>)
is derived and cached.</p>
<ul class="simple">
<li><p>For nonzero ages, the bathymetry is redistributed within basins</p></li>
</ul>
<p>according to <cite>sxbin_p</cite> and each basin’s fractional volume until
the desired global VOC is achieved.</p>
<dl class="field-list simple">
<dt class="field-odd">type age<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">param age<span class="colon">:</span></dt>
<dd class="field-even"><p>Geological time (Ma).
If 0, compute and store the correction spectrum for reference.</p>
</dd>
<dt class="field-odd">type age<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></p>
</dd>
<dt class="field-even">type bathymetry<span class="colon">:</span></dt>
<dd class="field-even"><p></p></dd>
<dt class="field-odd">param bathymetry<span class="colon">:</span></dt>
<dd class="field-odd"><p>2-D bathymetry array (m; positive downward).
Land or emergent regions should be represented as NaN.</p>
</dd>
<dt class="field-even">type bathymetry<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a></p>
</dd>
<dt class="field-odd">type VOCTarget<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">param VOCTarget<span class="colon">:</span></dt>
<dd class="field-even"><p>Target global ocean volume (m³) to be matched after redistribution.</p>
</dd>
<dt class="field-odd">type VOCTarget<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></p>
</dd>
<dt class="field-even">type resolution<span class="colon">:</span></dt>
<dd class="field-even"><p></p></dd>
<dt class="field-odd">param resolution<span class="colon">:</span></dt>
<dd class="field-odd"><p>Working grid spacing (degrees) used for ETOPO resampling and
histogram comparisons.</p>
</dd>
<dt class="field-even">type resolution<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></p>
</dd>
<dt class="field-odd">type verbose<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">param verbose<span class="colon">:</span></dt>
<dd class="field-even"><p>If True, generates diagnostic messages and comparison plots.
Default is True.</p>
</dd>
<dt class="field-odd">type verbose<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <em>optional</em></p>
</dd>
<dt class="field-even">returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Updated bathymetry array and the correction spectrum (<cite>sxbin_p</cite>)
expressed as percent change per depth bin.</p>
</dd>
<dt class="field-odd">rtype<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Uses <code class="docutils literal notranslate"><span class="pre">self.basins</span></code> to preserve basin boundaries during redistribution.</p></li>
<li><p>The correction spectrum (<cite>sxbin_p</cite>) is stored internally when</p></li>
</ul>
<p><cite>age == 0</cite> and reused for other ages to maintain continuity.</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.Bathymetry.BathyRecon.compareLithosphereAndPaleoDEMRecon">
<span class="sig-name descname"><span class="pre">compareLithosphereAndPaleoDEMRecon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">age</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fuzzyAge</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/Bathymetry.html#BathyRecon.compareLithosphereAndPaleoDEMRecon"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.Bathymetry.BathyRecon.compareLithosphereAndPaleoDEMRecon" title="Link to this definition">¶</a></dt>
<dd><p>Quick visual check of coverage and consistency between lithosphere-age
grids and paleoDEMs at a given time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>age</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – Reconstruction age (Ma).</p></li>
<li><p><strong>resolution</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – Grid spacing (deg).</p></li>
<li><p><strong>fuzzyAge</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <em>optional</em>) – If True, allows nearest match in available products.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Side</span> <span class="pre">Effects</span></code></p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">------------</span></code></p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Produces</span> <span class="pre">a</span> <span class="pre">contour</span> <span class="pre">plot</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">lithosphere</span> <span class="pre">ages</span> <span class="pre">with</span> <span class="pre">paleoDEM</span> <span class="pre">coastlines.</span></code></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.Bathymetry.BathyRecon.getDEM">
<span class="sig-name descname"><span class="pre">getDEM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">age</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fuzzyAge</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/Bathymetry.html#BathyRecon.getDEM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.Bathymetry.BathyRecon.getDEM" title="Link to this definition">¶</a></dt>
<dd><p>Load a paleoDEM for the requested time and resample to the target grid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>age</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – Target reconstruction age (Ma).</p></li>
<li><p><strong>resolution</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – Output grid spacing (degrees).</p></li>
<li><p><strong>fuzzyAge</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <em>optional</em>) – If True, allows nearest match within small tolerance (±0.5 Myr).</p></li>
<li><p><strong>Defines</strong></p></li>
<li><p><strong>-------</strong></p></li>
<li><p><strong>self.paleoDEM</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">netCDF4.Dataset</span></code>) – Temporary NetCDF with resampled paleoDEM (<cite>z</cite> variable).</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Uses <cite>gmt grdsample</cite> to resample and convert to cell-registered grid.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.Bathymetry.BathyRecon.getESL">
<span class="sig-name descname"><span class="pre">getESL</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">topography</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seafloorAge</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">age</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/Bathymetry.html#BathyRecon.getESL"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.Bathymetry.BathyRecon.getESL" title="Link to this definition">¶</a></dt>
<dd><p>Apply eustatic sea-level offset (Haq87) to oceanic regions only.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>topography</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – 2-D topography with oceanic depths (m; positive).</p></li>
<li><p><strong>seafloorAge</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – 2-D seafloor age grid (Myr); NaN over continents/paleoDEM areas.</p></li>
<li><p><strong>age</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – Time (Ma) for which to sample the Haq87 sea-level curve.</p></li>
<li><p><strong>factor</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, <em>optional</em>) – Fraction of the Haq87 value to apply (0–1). Default 1.0.</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <em>optional</em>) – If True, prints the applied offset.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of (modified topography, applied ESL in meters).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">(numpy.ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float)</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.Bathymetry.BathyRecon.getIsostaticCorrection">
<span class="sig-name descname"><span class="pre">getIsostaticCorrection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">topography</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seafloorAge</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">longitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/Bathymetry.html#BathyRecon.getIsostaticCorrection"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.Bathymetry.BathyRecon.getIsostaticCorrection" title="Link to this definition">¶</a></dt>
<dd><p>Add sediment thickness and apply isostatic compensation to oceanic depths.</p>
<p>The load of seawater + sediments is compensated following Hoggard et al. (2017)
and Athy (1930) porosity decay, yielding a corrected bathymetric depth.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>topography</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – 2-D bathymetry/topography (m) before sediment/isostatic terms.</p></li>
<li><p><strong>seafloorAge</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – 2-D seafloor age (Myr); NaN over continents.</p></li>
<li><p><strong>latitude</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – 2-D coordinate grids (deg).</p></li>
<li><p><strong>longitude</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – 2-D coordinate grids (deg).</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <em>optional</em>) – If True, plots a quicklook of bathymetry change.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Bathymetry/topography with sediment loading + isostatic correction applied (m).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.Bathymetry.BathyRecon.getOceanLithosphereAgeGrid">
<span class="sig-name descname"><span class="pre">getOceanLithosphereAgeGrid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">age</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fuzzyAge</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/Bathymetry.html#BathyRecon.getOceanLithosphereAgeGrid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.Bathymetry.BathyRecon.getOceanLithosphereAgeGrid" title="Link to this definition">¶</a></dt>
<dd><p>Load an ocean lithosphere age grid nearest to the requested time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>age</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – Target reconstruction age (Ma).</p></li>
<li><p><strong>resolution</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – Output grid spacing (degrees).</p></li>
<li><p><strong>fuzzyAge</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <em>optional</em>) – If True, allows nearest match within small tolerance.</p></li>
<li><p><strong>Defines</strong></p></li>
<li><p><strong>-------</strong></p></li>
<li><p><strong>self.oceanLithAge</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">netCDF4.Dataset</span></code>) – Temporary NetCDF with resampled lithosphere ages (<cite>z</cite> variable),
plus <cite>lat</cite>/<cite>lon</cite> axes.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Uses <cite>gmt grdsample</cite> to resample and convert to cell-registered grid.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.Bathymetry.BathyRecon.getSed">
<span class="sig-name descname"><span class="pre">getSed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seafloorAge</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latitude</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/Bathymetry.html#BathyRecon.getSed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.Bathymetry.BathyRecon.getSed" title="Link to this definition">¶</a></dt>
<dd><p>Estimate deep-marine sediment thickness from age/latitude (Straume et al., 2019).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seafloorAge</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – 2-D seafloor age grid (Myr); NaN where not oceanic.</p></li>
<li><p><strong>latitude</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – 2-D latitude grid (deg).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Sediment thickness (m) computed from a second-order polynomial in
latitude modulated by sqrt(age); NaN where seafloorAge is invalid.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.Bathymetry.BathyRecon.getVOCi">
<span class="sig-name descname"><span class="pre">getVOCi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">age</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/Bathymetry.html#BathyRecon.getVOCi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.Bathymetry.BathyRecon.getVOCi" title="Link to this definition">¶</a></dt>
<dd><p>Return the target global ocean-container volume (VOC) at a given age.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>age</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – Time (Ma) for which to return VOC.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Target ocean basin volume at <cite>age</cite> (m³). If a constant VOC is used,
returns a scalar independent of age.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.Bathymetry.BathyRecon.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">startMa</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">80</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">endMa</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deltaMyr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxBasinCnt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">findBasins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/Bathymetry.html#BathyRecon.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.Bathymetry.BathyRecon.run" title="Link to this definition">¶</a></dt>
<dd><p>Execute the reconstruction loop and save outputs (per time slice).</p>
<section id="steps-per-time-slice">
<h4>Steps (per time slice)<a class="headerlink" href="#steps-per-time-slice" title="Link to this heading">¶</a></h4>
<ol class="arabic simple">
<li><p>Read/prepare lithosphere age grid and initialize topography.</p></li>
<li><p>Add thermal subsidence via <cite>addThermalSub</cite>.</p></li>
<li><p>Add sediment thickness and isostatic compensation.</p></li>
<li><p>Merge paleoDEMs for continental/flooded regions.</p></li>
<li><p>Apply eustatic sea-level adjustment (Haq87; optionally scaled).</p></li>
<li><p>Compute area weights, bathymetry, and global diagnostics (AOC/VOC).</p></li>
<li><p>For ‘CM2009’: optionally apply volume-of-ocean (VOC) correction
based on present-day mismatch (<cite>addVOCCorrection</cite>).</p></li>
<li><p>Identify/merge basins and compute basin parameters/connectivity.</p></li>
<li><p>Save bathymetry and basin outputs for ExoCcycle.</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">type startMa<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">param startMa<span class="colon">:</span></dt>
<dd class="field-even"><p>Oldest reconstruction age (Ma). Default 80.</p>
</dd>
<dt class="field-odd">type startMa<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <em>optional</em></p>
</dd>
<dt class="field-even">type endMa<span class="colon">:</span></dt>
<dd class="field-even"><p></p></dd>
<dt class="field-odd">param endMa<span class="colon">:</span></dt>
<dd class="field-odd"><p>Youngest reconstruction age (Ma). Default 0.</p>
</dd>
<dt class="field-even">type endMa<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <em>optional</em></p>
</dd>
<dt class="field-odd">type deltaMyr<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">param deltaMyr<span class="colon">:</span></dt>
<dd class="field-even"><p>Temporal step (Myr). Default 5.</p>
</dd>
<dt class="field-odd">type deltaMyr<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <em>optional</em></p>
</dd>
<dt class="field-even">type resolution<span class="colon">:</span></dt>
<dd class="field-even"><p></p></dd>
<dt class="field-odd">param resolution<span class="colon">:</span></dt>
<dd class="field-odd"><p>Spatial grid resolution (degrees). Default 1.</p>
</dd>
<dt class="field-even">type resolution<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, <em>optional</em></p>
</dd>
<dt class="field-odd">type maxBasinCnt<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">param maxBasinCnt<span class="colon">:</span></dt>
<dd class="field-even"><p>Maximum number of allowed basins for merging heuristics.</p>
</dd>
<dt class="field-odd">type maxBasinCnt<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <em>optional</em></p>
</dd>
<dt class="field-even">type findBasins<span class="colon">:</span></dt>
<dd class="field-even"><p></p></dd>
<dt class="field-odd">param findBasins<span class="colon">:</span></dt>
<dd class="field-odd"><p>If True, perform basin identification/merging workflow.</p>
</dd>
<dt class="field-even">type findBasins<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <em>optional</em></p>
</dd>
<dt class="field-odd">type verbose<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">param verbose<span class="colon">:</span></dt>
<dd class="field-even"><p>If True, print progress and generate quick looks.</p>
</dd>
<dt class="field-odd">type verbose<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <em>optional</em></p>
</dd>
<dt class="field-even">param Side Effects<span class="colon">:</span></dt>
<dd class="field-even"><p></p></dd>
<dt class="field-odd">param ————<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">param • Writes per-age NetCDF files via <cite>saveBathymetry</cite>.<span class="colon">:</span></dt>
<dd class="field-even"><p></p></dd>
<dt class="field-odd">param • Creates/updates <cite>self.basins</cite> with computed basin properties.<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">param • May create plots/diagnostics when <cite>verbose=True</cite>.<span class="colon">:</span></dt>
<dd class="field-even"><p></p></dd>
</dl>
<p class="rubric">Notes</p>
<p>Requires helper utilities from <cite>utils</cite> and external GMT.</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.Bathymetry.BathyRecon.saveBathymetry">
<span class="sig-name descname"><span class="pre">saveBathymetry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reconAge</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/Bathymetry.html#BathyRecon.saveBathymetry"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.Bathymetry.BathyRecon.saveBathymetry" title="Link to this definition">¶</a></dt>
<dd><p>Save the (optionally VOC-corrected) bathymetry and diagnostics to NetCDF.</p>
<section id="file-layout">
<h4>File layout<a class="headerlink" href="#file-layout" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>Dimensions:</dt><dd><p>lat (deg)   : [-90, 90]
lon (deg)   : [-180, 180]
binEdges    : upper bound edges (km) for depth bins</p>
</dd>
<dt>Variables:</dt><dd><p>bathymetry(lat,lon)                           : m (positive depth; land=NaN)
lat(lat), lon(lon)                            : deg
areaWeights(lat)                              : m² (per-lat row representative)
binEdges(binEdges)                            : km
bathymetry-distribution-G(binEdges)           : % area (kernel)
bathymetry-distribution-whighlat-G(binEdges)  : % area (kernel; incl. high-lat)
highlatlat                                    : deg
highlatA                                      : m²
AOC                                           : m²
VOC                                           : m³</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">type reconAge<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">param reconAge<span class="colon">:</span></dt>
<dd class="field-even"><p>Reconstruction age (Ma) to encode in filename.</p>
</dd>
<dt class="field-odd">type reconAge<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></p>
</dd>
<dt class="field-even">type verbose<span class="colon">:</span></dt>
<dd class="field-even"><p></p></dd>
<dt class="field-odd">param verbose<span class="colon">:</span></dt>
<dd class="field-odd"><p>If True, ensures directories exist and prints path.</p>
</dd>
<dt class="field-even">type verbose<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <em>optional</em></p>
</dd>
<dt class="field-odd">rtype<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.Bathymetry.BathyRecon.saveNetCDF4">
<span class="sig-name descname"><span class="pre">saveNetCDF4</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/Bathymetry.html#BathyRecon.saveNetCDF4"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.Bathymetry.BathyRecon.saveNetCDF4" title="Link to this definition">¶</a></dt>
<dd><p>Placeholder for writing additional consolidated outputs.</p>
<p class="rubric">Notes</p>
<p>Not yet implemented.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.Bathymetry.BathyRecon.setThermalMethod">
<span class="sig-name descname"><span class="pre">setThermalMethod</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thermalSubMethod</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'type':</span> <span class="pre">'CM2009'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/Bathymetry.html#BathyRecon.setThermalMethod"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.Bathymetry.BathyRecon.setThermalMethod" title="Link to this definition">¶</a></dt>
<dd><p>Choose the age–depth relationship used for thermal subsidence.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>thermalSubMethod</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>, <em>optional</em>) – <dl class="simple">
<dt>For ‘CM2009’:</dt><dd><p>{‘type’: ‘CM2009’}</p>
</dd>
<dt>For ‘RK2021’:</dt><dd><p>{‘type’: ‘RK2021’, ‘H’: &lt;float W/m/K&gt;, ‘MORDepthkm’: &lt;float&gt;}</p>
</dd>
</dl>
<p>Suggested H values: 2.1e-12 (PD), 3.2e-12 (1.7 Ga), 4.8e-12 (2.8 Ga), 6.4e-12 (3.5 Ga), 8e-12 (3.95 Ga).</p>
</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <em>optional</em>) – If True, prints guidance when H differs from tabulated values.</p></li>
<li><p><strong>Redefines</strong></p></li>
<li><p><strong>---------</strong></p></li>
<li><p><strong>self.thermalSubMethod</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>) – Method dictionary used by <cite>addThermalSub</cite>.</p></li>
<li><p><strong>Options</strong></p></li>
<li><p><strong>(</strong><strong>default</strong><strong>)</strong> (<em>• 'CM2009'</em>)</p></li>
<li><p><strong>'RK2021'</strong> (<em>•</em>) – variable internal heating H and MOR depth.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ExoCcycle.Bathymetry.BathySynthBogumil24">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ExoCcycle.Bathymetry.</span></span><span class="sig-name descname"><span class="pre">BathySynthBogumil24</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">optSynthModel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Model1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ModelName</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'myModel'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/Bathymetry.html#BathySynthBogumil24"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.Bathymetry.BathySynthBogumil24" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Build synthetic, basin-agnostic bathymetry distributions following
the design in Bogumil et al. (2024).</p>
<p>Unlike spatial reconstructions, this class does <strong>not</strong> operate on
latitude/longitude grids. Instead, it synthesizes global depth-bin
distributions and formats them using <code class="docutils literal notranslate"><span class="pre">BasinsSynth</span></code> so they can be
consumed by LOSCAR-style carbon cycle models.</p>
<section id="id1">
<h3>Concept<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h3>
<ol class="arabic simple">
<li><p>Basins share identical depth distributions (contrast with geologic
reconstructions where basins differ).</p></li>
<li><p>Deep bathymetry (&gt; 1 km) follows a Gaussian-like 5-bin pattern
centered on a chosen bin (σ ≈ 250–500 m depending on bin width).</p></li>
<li><p>Shallow bins (≤ 600 m) are allocated uniformly and varied in area
within plausible ranges over 0–80 Ma.</p></li>
</ol>
</section>
<section id="distinctions-vs-bogumil-et-al-2024">
<h3>Distinctions vs. Bogumil et al. (2024)<a class="headerlink" href="#distinctions-vs-bogumil-et-al-2024" title="Link to this heading">¶</a></h3>
<ol class="arabic simple">
<li><p>In Bogumil et al., LOSCAR mixing parameters were fixed at PD values;
here, <em>connectivity bathymetry</em> (not mixing coefficients) is
defined from the synthetic Gaussian distribution. Other classes may
choose whether to drive mixing by these synthetic distributions or
keep LOSCAR defaults.</p></li>
<li><p>VOC is computed directly as <code class="docutils literal notranslate"><span class="pre">(total</span> <span class="pre">area)</span> <span class="pre">×</span> <span class="pre">(depth</span> <span class="pre">distribution)</span></code>.</p></li>
<li><p>Basin VOC partitions are derived from basin area fractions.</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">type optSynthModel<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">param optSynthModel<span class="colon">:</span></dt>
<dd class="field-even"><p>Synthetic recipe to use. Currently only ‘Model1’ is implemented:
Gaussian deep bathymetry + variable shallow fraction. Default ‘Model1’.</p>
</dd>
<dt class="field-odd">type optSynthModel<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">{'Model1'}</span></code>, <em>optional</em></p>
</dd>
<dt class="field-even">type ModelName<span class="colon">:</span></dt>
<dd class="field-even"><p></p></dd>
<dt class="field-odd">param ModelName<span class="colon">:</span></dt>
<dd class="field-odd"><p>Name used for on-disk outputs (subdirectory and file prefixes).
Default ‘myModel’.</p>
</dd>
<dt class="field-even">type ModelName<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <em>optional</em></p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="ExoCcycle.Bathymetry.BathySynthBogumil24.LOSCARValues">
<span class="sig-name descname"><span class="pre">LOSCARValues</span></span><a class="headerlink" href="#ExoCcycle.Bathymetry.BathySynthBogumil24.LOSCARValues" title="Link to this definition">¶</a></dt>
<dd><p>Convenience constants matching LOSCAR conventions:
- <code class="docutils literal notranslate"><span class="pre">AOC</span></code> : float</p>
<blockquote>
<div><p>Global seafloor area [m²], default 3.49e14.</p>
</div></blockquote>
<ul class="simple">
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">hb10</span></code><span class="classifier">float</span></dt><dd><p>High-latitude <em>surface box depth</em> [m] (not seafloor depth), default 250.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">fanoc</span></code><span class="classifier">(4, 1) ndarray</span></dt><dd><p>Area fractions for Atlantic, Indian, Pacific, High-lat boxes (decimal).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">binEdges</span></code><span class="classifier">(N,) ndarray</span></dt><dd><p>Upper bounds of bathymetry bins [m]: 0, 100, 600, 1000, …, 6500.</p>
</dd>
</dl>
</li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ExoCcycle.Bathymetry.BathySynthBogumil24.optSynthModel">
<span class="sig-name descname"><span class="pre">optSynthModel</span></span><a class="headerlink" href="#ExoCcycle.Bathymetry.BathySynthBogumil24.optSynthModel" title="Link to this definition">¶</a></dt>
<dd><p>The selected synthetic model key (e.g., ‘Model1’).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ExoCcycle.Bathymetry.BathySynthBogumil24.ModelName">
<span class="sig-name descname"><span class="pre">ModelName</span></span><a class="headerlink" href="#ExoCcycle.Bathymetry.BathySynthBogumil24.ModelName" title="Link to this definition">¶</a></dt>
<dd><p>Logical name for the model family; used in output paths.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ExoCcycle.Bathymetry.BathySynthBogumil24.AOC_factor">
<span class="sig-name descname"><span class="pre">AOC_factor</span></span><a class="headerlink" href="#ExoCcycle.Bathymetry.BathySynthBogumil24.AOC_factor" title="Link to this definition">¶</a></dt>
<dd><p>For ‘Model1’: <code class="docutils literal notranslate"><span class="pre">[min_factor,</span> <span class="pre">max_factor,</span> <span class="pre">n_steps]</span></code> controlling
how total AOC is scaled relative to LOSCAR present-day.
Default <code class="docutils literal notranslate"><span class="pre">[0.96,</span> <span class="pre">1.2,</span> <span class="pre">13]</span></code> → 13 evenly spaced factors in [0.96, 1.20].</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">shape</span> <span class="pre">(3,)</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ExoCcycle.Bathymetry.BathySynthBogumil24.synth_model_para">
<span class="sig-name descname"><span class="pre">synth_model_para</span></span><a class="headerlink" href="#ExoCcycle.Bathymetry.BathySynthBogumil24.synth_model_para" title="Link to this definition">¶</a></dt>
<dd><p>Free parameters controlling the synthetic shape. Currently:
- <code class="docutils literal notranslate"><span class="pre">'shallow_bathy_percent'</span></code> : float</p>
<blockquote>
<div><p>Fraction of global seafloor area assigned to the two shallowest
non-zero bins (split evenly). Default 0.025 (2.5%).</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ExoCcycle.Bathymetry.BathySynthBogumil24.directories">
<span class="sig-name descname"><span class="pre">directories</span></span><a class="headerlink" href="#ExoCcycle.Bathymetry.BathySynthBogumil24.directories" title="Link to this definition">¶</a></dt>
<dd><p>Output directory roots. <code class="docutils literal notranslate"><span class="pre">directories['output']</span></code> points to
<code class="docutils literal notranslate"><span class="pre">./bathymetries/{optSynthModel}/{ModelName}</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ExoCcycle.Bathymetry.BathySynthBogumil24.BathymetryParms">
<span class="sig-name descname"><span class="pre">BathymetryParms</span></span><a class="headerlink" href="#ExoCcycle.Bathymetry.BathySynthBogumil24.BathymetryParms" title="Link to this definition">¶</a></dt>
<dd><p>Populated by <a class="reference internal" href="#ExoCcycle.Bathymetry.BathySynthBogumil24.makeSynthModels" title="ExoCcycle.Bathymetry.BathySynthBogumil24.makeSynthModels"><code class="xref py py-meth docutils literal notranslate"><span class="pre">makeSynthModels()</span></code></a>. A mapping:
<code class="docutils literal notranslate"><span class="pre">model_key</span> <span class="pre">-&gt;</span> <span class="pre">{'VOC',</span> <span class="pre">'AOC',</span> <span class="pre">'fanoc',</span> <span class="pre">'fdvol',</span> <span class="pre">'hb10',</span> <span class="pre">'distribution'}</span></code>,
where:
- <code class="docutils literal notranslate"><span class="pre">VOC</span></code> : float, total ocean volume [m³].
- <code class="docutils literal notranslate"><span class="pre">AOC</span></code> : float, total ocean area [m²].
- <code class="docutils literal notranslate"><span class="pre">fanoc</span></code> : (4,) ndarray, basin/HL area fractions (decimal).
- <code class="docutils literal notranslate"><span class="pre">fdvol</span></code> : (4,) ndarray, basin/HL volume fractional partition (decimal),</p>
<blockquote>
<div><p>normalized to the sum over the <strong>three</strong> ocean basins (HL excluded in norm).</p>
</div></blockquote>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">hb10</span></code> : float, high-lat surface box depth [m].</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">distribution</span></code> : (len(binEdges)-1,) ndarray,
global % area per depth bin (decimal, excludes the 0 m edge).</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a></p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The Gaussian “deep” vector in <em>Model1</em> is applied across five
adjacent 500 m-spaced bins centered on a chosen bin index and
renormalized to honor the shallow share and AOC scaling.</p></li>
<li><p>Land is not represented—distributions are purely oceanic (% over AOC).</p></li>
<li><p>Outputs are formatted with <code class="xref py py-class docutils literal notranslate"><span class="pre">utils.BasinsSynth</span></code> for downstream use.</p></li>
</ul>
<p class="rubric">References</p>
<p>Bogumil, T. R., et al. (2024), <em>PNAS</em>, doi:10.1073/pnas.2400232121
LOSCAR documentation (area partitions and bin definitions).</p>
<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.Bathymetry.BathySynthBogumil24.makeSynthModels">
<span class="sig-name descname"><span class="pre">makeSynthModels</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/Bathymetry.html#BathySynthBogumil24.makeSynthModels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.Bathymetry.BathySynthBogumil24.makeSynthModels" title="Link to this definition">¶</a></dt>
<dd><p>Build a suite of synthetic depth distributions and cache parameters.</p>
<p>For <em>Model1</em>, each realization combines:
- a 5-bin Gaussian-like deep pattern centered successively on</p>
<blockquote>
<div><p>eligible bin centers between ~1–5 km, and</p>
</div></blockquote>
<ul class="simple">
<li><p>a uniform shallow allocation split between the two shallow bins,
sized by <code class="docutils literal notranslate"><span class="pre">synth_model_para['shallow_bathy_percent']</span></code>.</p></li>
</ul>
<p>For each AOC scale factor in <code class="docutils literal notranslate"><span class="pre">np.linspace(AOC_factor[0],</span>
<span class="pre">AOC_factor[1],</span> <span class="pre">int(AOC_factor[2]))</span></code> and each valid deep-bin center:</p>
<ul class="simple">
<li><p>Compute distribution (% per bin, decimal).</p></li>
<li><p>Compute basin/HL volume split <code class="docutils literal notranslate"><span class="pre">fdvol</span></code> using LOSCAR
area fractions (<code class="docutils literal notranslate"><span class="pre">fanoc</span></code>) and the distribution.</p></li>
<li><p>Compute target VOC as the area-weighted integral of depths.</p></li>
<li><p>Store all quantities to <a class="reference internal" href="#ExoCcycle.Bathymetry.BathySynthBogumil24.BathymetryParms" title="ExoCcycle.Bathymetry.BathySynthBogumil24.BathymetryParms"><code class="xref py py-attr docutils literal notranslate"><span class="pre">BathymetryParms</span></code></a> under a model key
like <code class="docutils literal notranslate"><span class="pre">aF{factor%}_U{bin_edge}m</span></code>.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>None</strong></p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The “Gaussian” deep vector used is
<code class="docutils literal notranslate"><span class="pre">[(100</span> <span class="pre">-</span> <span class="pre">34.1*2</span> <span class="pre">-</span> <span class="pre">13.6*2)/2,</span> <span class="pre">13.6,</span> <span class="pre">34.1*2,</span> <span class="pre">13.6,</span> <span class="pre">(100</span> <span class="pre">-</span> <span class="pre">34.1*2</span> <span class="pre">-</span> <span class="pre">13.6*2)/2]</span> <span class="pre">*</span> <span class="pre">1e-2</span></code>,
which approximates (~13.6%, 68.2%, 13.6%) tails/center mass over five bins.</p></li>
<li><p>The shallow share is removed from the deep mass and split evenly
into bins at 100 m and 600 m (following LOSCAR bin edges).</p></li>
<li><p>All percentages are maintained in <strong>decimal</strong> form internally.</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.Bathymetry.BathySynthBogumil24.saveSynthModels">
<span class="sig-name descname"><span class="pre">saveSynthModels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/Bathymetry.html#BathySynthBogumil24.saveSynthModels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.Bathymetry.BathySynthBogumil24.saveSynthModels" title="Link to this definition">¶</a></dt>
<dd><p>Write synthetic distributions to standardized netCDF via BasinsSynth.</p>
<p>This method iterates the same (AOC factor × deep-center) grid used
in <a class="reference internal" href="#ExoCcycle.Bathymetry.BathySynthBogumil24.makeSynthModels" title="ExoCcycle.Bathymetry.BathySynthBogumil24.makeSynthModels"><code class="xref py py-meth docutils literal notranslate"><span class="pre">makeSynthModels()</span></code></a>, pulls the cached parameters from
<a class="reference internal" href="#ExoCcycle.Bathymetry.BathySynthBogumil24.BathymetryParms" title="ExoCcycle.Bathymetry.BathySynthBogumil24.BathymetryParms"><code class="xref py py-attr docutils literal notranslate"><span class="pre">BathymetryParms</span></code></a>, and writes one <code class="docutils literal notranslate"><span class="pre">bathymetry_*_wBasins.nc</span></code>
per realization using <code class="xref py py-class docutils literal notranslate"><span class="pre">utils.BasinsSynth</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <em>optional</em>) – If True, print progress and let downstream utilities be chatty.
Default True.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Output</span></code></p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">------</span></code></p></li>
<li><p>:class:<code class="docutils literal notranslate"><span class="pre">`bathymetries/```{ModelName}</span></code><code class="xref py py-class docutils literal notranslate"><span class="pre">/bathymetry_```{key}`</span></code><code class="xref py py-class docutils literal notranslate"><span class="pre">_wBasins.nc`</span></code> files containing`</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">-</span> <span class="pre">LOSCAR-compatible</span> <span class="pre">bin</span> <span class="pre">edges</span> <span class="pre">(km),</span></code></p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">-</span> <span class="pre">global</span> <span class="pre">depth</span> <span class="pre">distribution</span> <span class="pre">(%</span> <span class="pre">per</span> <span class="pre">bin),</span></code></p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">-</span> <span class="pre">AOC</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">VOC</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">basin/HL</span> <span class="pre">area</span> <span class="pre">fractions</span> <span class="pre">(fanoc)</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">basin</span> <span class="pre">volume</span> <span class="pre">fractions</span> <span class="pre">(fdvol),</span></code></p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">-</span></code> and <code class="xref py py-class docutils literal notranslate"><span class="pre">any</span> <span class="pre">auxiliary</span> <span class="pre">metadata</span> <span class="pre">written</span> <span class="pre">by</span> <span class="pre">``BasinsSynth`</span></code>.`</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ExoCcycle.Bathymetry.calculateBathymetryDistributionBasin">
<span class="sig-prename descclassname"><span class="pre">ExoCcycle.Bathymetry.</span></span><span class="sig-name descname"><span class="pre">calculateBathymetryDistributionBasin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bathymetry</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latitudes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">longitudes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basinIDA</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">highlatlat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">areaWeights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binEdges</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fldName</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'/home/bogumil/Documents/External_fids/ExoCcycle-workspace/ExoCcycle'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/Bathymetry.html#calculateBathymetryDistributionBasin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.Bathymetry.calculateBathymetryDistributionBasin" title="Link to this definition">¶</a></dt>
<dd><p>Compute per-basin bathymetry area and volume distributions, excluding and
including high-latitude ocean, with global reference histograms.</p>
<dl class="simple">
<dt>The function iterates over all unique basin IDs in <code class="docutils literal notranslate"><span class="pre">basinIDA</span></code> to calculate:</dt><dd><ul class="simple">
<li><p>area-weighted depth distributions (% per bin),</p></li>
<li><p>fractional basin area (with/without high-lat region),</p></li>
<li><p>fractional basin volume (relative to total non-high-lat volume),</p></li>
<li><p>and global aggregate distributions for comparison.</p></li>
</ul>
</dd>
<dt>Optionally, when <code class="docutils literal notranslate"><span class="pre">verbose=True</span></code>, it generates and saves:</dt><dd><ul class="simple">
<li><p>a global basin map (Mollweide projection) and</p></li>
<li><p>a stacked bar plot of basin bathymetry distributions.</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bathymetry</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – 2-D array (ny, nx) of seafloor depth values in meters. Positive depths
represent ocean; zeros or NaNs are treated as land or undefined.</p></li>
<li><p><strong>latitudes</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – 2-D array (ny, nx) of cell-center latitudes in degrees, ranging [-90, 90],
aligned with <code class="docutils literal notranslate"><span class="pre">bathymetry</span></code>.</p></li>
<li><p><strong>longitudes</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – 2-D array (ny, nx) of cell-center longitudes in degrees, ranging [-180, 180],
aligned with <code class="docutils literal notranslate"><span class="pre">bathymetry</span></code>.</p></li>
<li><p><strong>basinIDA</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – 2-D array (ny, nx) of integer basin identifiers. NaNs indicate unclassified
or land cells.</p></li>
<li><p><strong>highlatlat</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – Absolute-latitude cutoff (degrees) separating low-latitude ocean
(<a href="#id67"><span class="problematic" id="id68">|lat|</span></a> ≤ highlatlat) from the high-latitude region.</p></li>
<li><p><strong>areaWeights</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – 2-D array (ny, nx) of cell surface areas in m². The sum over all valid
ocean cells should approximate <code class="docutils literal notranslate"><span class="pre">4πR²</span></code> for the Earth (or the model sphere).</p></li>
<li><p><strong>binEdges</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>, <em>optional</em>) – <p>1-D array of depth bin edges in kilometers. Anything deeper than the last
edge falls into the last bin. Default:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">,</span> <span class="mf">6.5</span><span class="p">])</span>
</pre></div>
</div>
</p></li>
<li><p><strong>fldName</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <em>optional</em>) – Directory path for figure output when <code class="docutils literal notranslate"><span class="pre">verbose=True</span></code>. Default: current working directory.</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <em>optional</em>) – If True, print basin counts and generate basin map and histogram figures
saved as <code class="docutils literal notranslate"><span class="pre">Basin_Distributions.png</span></code> and <code class="docutils literal notranslate"><span class="pre">.svg</span></code> in <code class="docutils literal notranslate"><span class="pre">fldName</span></code>. Default True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>bathymetryAreaDist</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">dict[str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray]</span></code>) – Per-basin depth distributions (% area per bin) <strong>excluding</strong> high-latitude
regions. Keys are ‘Basin0’, ‘Basin1’, etc.</p></li>
<li><p><strong>bathymetryVolFrac</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">dict[str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float]</span></code>) – Fractional basin volume (decimal) normalized to the sum of all
<strong>non-high-latitude</strong> ocean volumes.</p></li>
<li><p><strong>bathymetryAreaFrac</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">dict[str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float]</span></code>) – Fractional basin area (decimal) excluding the high-lat region, normalized
to total ocean area (including high-lat).</p></li>
<li><p><strong>bathymetryAreaFracG</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">dict[str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float]</span></code>) – Fractional basin area (decimal) including all ocean area (high-lat included),
normalized to total seafloor area.</p></li>
<li><p><strong>bathymetryAreaDist_wHighlatG</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code>) – Global bathymetry distribution (% area per bin) <strong>including</strong> high-latitude
ocean (pole-to-pole).</p></li>
<li><p><strong>bathymetryAreaDistG</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code>) – Global bathymetry distribution (% area per bin) <strong>excluding</strong> high-latitude
ocean (<a href="#id69"><span class="problematic" id="id70">|lat|</span></a> ≤ highlatlat).</p></li>
<li><p><strong>binEdges</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code>) – Bin edges (km) used for all histograms.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Depths are converted from meters to kilometers prior to binning.</p></li>
<li><p>Basin-wise histograms are normalized such that each sums to 100% area within
its respective basin domain.</p></li>
<li><p>Area and volume fractions are normalized to global totals using <code class="docutils literal notranslate"><span class="pre">areaWeights</span></code>.</p></li>
<li><p>Basin IDs are taken as unique non-NaN entries in <code class="docutils literal notranslate"><span class="pre">basinIDA</span></code>; their order
corresponds to sorted unique IDs.</p></li>
<li><p>The resulting basin-level distributions can be used directly as LOSCAR
bathymetry inputs.</p></li>
</ul>
<section id="visualization">
<h3>Visualization<a class="headerlink" href="#visualization" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>When <code class="docutils literal notranslate"><span class="pre">verbose=True</span></code>, this routine:</dt><dd><ul class="simple">
<li><p>Creates a Mollweide map of basin partitions over <code class="docutils literal notranslate"><span class="pre">longitudes</span></code>/<code class="docutils literal notranslate"><span class="pre">latitudes</span></code>.</p></li>
<li><p>Plots bathymetry distributions per basin (stacked bar chart) with labeled bins.</p></li>
<li><p>Saves both figures to <code class="docutils literal notranslate"><span class="pre">fldName/Basin_Distributions.{png,svg}</span></code>.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span><span class="p">,</span> <span class="n">volFrac</span><span class="p">,</span> <span class="n">areaFrac</span><span class="p">,</span> <span class="n">areaFracG</span><span class="p">,</span> <span class="n">distGH</span><span class="p">,</span> <span class="n">distG</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">calculateBathymetryDistributionBasin</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">bathy</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">basinID</span><span class="p">,</span> <span class="n">highlatlat</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">areaWeights</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">dist</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="go">[&#39;Basin0&#39;, &#39;Basin1&#39;, &#39;Basin2&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">volFrac</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
<span class="go">1.0</span>
</pre></div>
</div>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ExoCcycle.Bathymetry.calculateBathymetryDistributionGlobal">
<span class="sig-prename descclassname"><span class="pre">ExoCcycle.Bathymetry.</span></span><span class="sig-name descname"><span class="pre">calculateBathymetryDistributionGlobal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bathymetry</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latitudes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">highlatlat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">areaWeights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binEdges</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/Bathymetry.html#calculateBathymetryDistributionGlobal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.Bathymetry.calculateBathymetryDistributionGlobal" title="Link to this definition">¶</a></dt>
<dd><p>Compute global depth-binned bathymetry area distributions (with and without
high-latitude ocean), weighted by cell area.</p>
<p>The routine forms two histograms of ocean depth (km):
1) Including all ocean cells (global, pole-to-pole).
2) Excluding high-latitude ocean, i.e., using only cells with</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">|lat|</span> <span class="pre">&lt;=</span> <span class="pre">highlatlat</span></code> (degrees).</p>
</div></blockquote>
<p>Both histograms are weighted by <code class="docutils literal notranslate"><span class="pre">areaWeights</span></code> and normalized to sum to 100%
(percent of ocean area). Land/undefined cells are ignored.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bathymetry</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – 2-D array (ny, nx) of seafloor depths in meters. Positive values denote
ocean; 0 or NaN are treated as non-ocean and excluded.</p></li>
<li><p><strong>latitudes</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – 2-D array (ny, nx) of cell-center latitudes in degrees, spanning [-90, 90],
aligned with <code class="docutils literal notranslate"><span class="pre">bathymetry</span></code>.</p></li>
<li><p><strong>highlatlat</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – Absolute-latitude cutoff in degrees. Cells with <code class="docutils literal notranslate"><span class="pre">|lat|</span> <span class="pre">&gt;</span> <span class="pre">highlatlat</span></code> are
considered “high-latitude” and are excluded from the low-latitude
distribution.</p></li>
<li><p><strong>areaWeights</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – 2-D array (ny, nx) of cell areas in m² (or latitude-only weights broadcast
to 2-D). Values are used as histogram weights.</p></li>
<li><p><strong>binEdges</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>, <em>optional</em>) – <p>1-D array of bin edges in kilometers used for depth binning. Anything deeper
than the last edge falls into the last bin. Default is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">,</span> <span class="mf">6.5</span><span class="p">])</span>
</pre></div>
</div>
</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <em>optional</em>) – If True, plots side-by-side bar charts (all ocean vs. no-high-lat).
Default True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>bathymetryAreaDist</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – Percent area per depth bin <strong>excluding</strong> high-latitude ocean
(i.e., using cells with <code class="docutils literal notranslate"><span class="pre">|lat|</span> <span class="pre">&lt;=</span> <span class="pre">highlatlat</span></code>). Sums to ~100.</p></li>
<li><p><strong>bathymetryAreaDist_wHighlat</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – Percent area per depth bin <strong>including</strong> all ocean (global). Sums to ~100.</p></li>
<li><p><strong>binEdges</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – The bin edges used (km).</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Depths are converted from meters to kilometers before binning.</p></li>
<li><p>Each histogram uses normalized weights:
<code class="docutils literal notranslate"><span class="pre">weights</span> <span class="pre">=</span> <span class="pre">areaWeights[mask]</span> <span class="pre">/</span> <span class="pre">sum(areaWeights[mask])</span></code>, then scaled
to percentages (×100).</p></li>
<li><p>Ensure that <code class="docutils literal notranslate"><span class="pre">bathymetry</span></code> has positive values over ocean; zeros/NaNs are
excluded from the statistics.</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bins_km</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mf">6.5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist_lowlat</span><span class="p">,</span> <span class="n">dist_global</span><span class="p">,</span> <span class="n">used_bins</span> <span class="o">=</span> <span class="n">calculateBathymetryDistributionGlobal</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">bathy_m</span><span class="p">,</span> <span class="n">lat_deg</span><span class="p">,</span> <span class="n">highlatlat</span><span class="o">=</span><span class="mf">60.0</span><span class="p">,</span> <span class="n">areaWeights</span><span class="o">=</span><span class="n">cell_area_m2</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">binEdges</span><span class="o">=</span><span class="n">bins_km</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist_lowlat</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="n">dist_global</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="go">(100.0, 100.0)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ExoCcycle.Bathymetry.calculateHighLatA">
<span class="sig-prename descclassname"><span class="pre">ExoCcycle.Bathymetry.</span></span><span class="sig-name descname"><span class="pre">calculateHighLatA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bathymetry</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latitudes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">areaWeights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">highlatP</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/Bathymetry.html#calculateHighLatA"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.Bathymetry.calculateHighLatA" title="Link to this definition">¶</a></dt>
<dd><p>Find the latitude cutoff that yields a target fraction of high-latitude ocean area,
and return both the cutoff and the corresponding area.</p>
<p>The routine treats the two hemispheres symmetrically. Starting from the poles
(±90°), it steps the absolute-latitude cutoff equatorward in 0.1° increments
until the cumulative ocean area poleward of that cutoff reaches or exceeds
<code class="docutils literal notranslate"><span class="pre">highlatP</span></code> of the total ocean area (AOC). Ocean is defined where
<code class="docutils literal notranslate"><span class="pre">bathymetry</span> <span class="pre">&gt;</span> <span class="pre">0</span></code> (m), land/undefined where values are 0 or NaN.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bathymetry</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – 2-D array (ny, nx) of seafloor depths in meters. Positive values denote
ocean; 0 or NaN are treated as non-ocean and excluded from area totals.</p></li>
<li><p><strong>latitudes</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – 2-D array (ny, nx) of cell-center latitudes in degrees, spanning [-90, 90],
aligned with <code class="docutils literal notranslate"><span class="pre">bathymetry</span></code>.</p></li>
<li><p><strong>areaWeights</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – 2-D array (ny, nx) of cell areas in m² (or latitude-only weights broadcast
to 2-D). Sum over all cells should approximate <code class="docutils literal notranslate"><span class="pre">4πR²</span></code> for the planet at
the grid resolution used.</p></li>
<li><p><strong>highlatP</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – Target fraction of <em>ocean</em> surface to include in the high-latitude box
(decimal in [0, 1]). For example, <code class="docutils literal notranslate"><span class="pre">0.10</span></code> requests ~10% of total ocean area.</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <em>optional</em>) – If True, print the requested fraction, the resulting cutoff latitude,
and the computed high-latitude area. Default True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>highlatlat</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – The absolute latitude (degrees, 0–90) that defines the high-latitude box:
cells with <code class="docutils literal notranslate"><span class="pre">|lat|</span> <span class="pre">&gt;</span> <span class="pre">highlatlat</span></code> are counted as high-latitude ocean.</p></li>
<li><p><strong>highlatA</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – Total high-latitude ocean area in m² using that cutoff.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Total ocean area (AOC) is computed as the sum of <code class="docutils literal notranslate"><span class="pre">areaWeights</span></code> over
cells where <code class="docutils literal notranslate"><span class="pre">bathymetry</span> <span class="pre">&gt;</span> <span class="pre">0</span></code> (and not NaN).</p></li>
<li><p>The search decreases the cutoff from 90° toward 0° in steps of 0.1° until
the poleward ocean-area fraction reaches <code class="docutils literal notranslate"><span class="pre">highlatP</span></code>; the first cutoff
meeting/exceeding the target is returned.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">highlatP</span> <span class="pre">&gt;</span> <span class="pre">1</span></code>, a message is printed and the function returns <code class="docutils literal notranslate"><span class="pre">None</span></code>.
Consider validating inputs upstream if you need stricter error handling.</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">highlatlat</span><span class="p">,</span> <span class="n">highlatA</span> <span class="o">=</span> <span class="n">calculateHighLatA</span><span class="p">(</span><span class="n">bathy</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">highlatP</span><span class="o">=</span><span class="mf">0.10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">highlatlat</span>
<span class="go">63.4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">highlatA</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">nansum</span><span class="p">(</span><span class="n">weights</span><span class="p">[</span><span class="n">bathy</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">])</span>
<span class="go">0.1003  # ~10% of ocean area</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#ExoCcycle.Bathymetry.calculateBathymetryDistributionGlobal" title="ExoCcycle.Bathymetry.calculateBathymetryDistributionGlobal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calculateBathymetryDistributionGlobal</span></code></a></dt><dd><p>Compute depth-binned global bathymetry distributions.</p>
</dd>
</dl>
</div>
</dd></dl>

</section>
<section id="module-ExoCcycle.plotHelper">
<span id="exoccycle-plothelper-module"></span><h2>ExoCcycle.plotHelper module<a class="headerlink" href="#module-ExoCcycle.plotHelper" title="Link to this heading">¶</a></h2>
<p>Created on Tue Nov 7 2025</p>
<p>&#64;author: Matthew Bogumil</p>
<dl class="py function">
<dt class="sig sig-object py" id="ExoCcycle.plotHelper.plotGlobal">
<span class="sig-prename descclassname"><span class="pre">ExoCcycle.plotHelper.</span></span><span class="sig-name descname"><span class="pre">plotGlobal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">lat,</span> <span class="pre">lon,</span> <span class="pre">values,</span> <span class="pre">outputDir='',</span> <span class="pre">fidName='plotGlobal.png',</span> <span class="pre">cmapOpts={'cbar-levels':</span> <span class="pre">[0,</span> <span class="pre">0.5,</span> <span class="pre">1],</span> <span class="pre">'cbar-range':</span> <span class="pre">[0,</span> <span class="pre">1],</span> <span class="pre">'cbar-title':</span> <span class="pre">'cbar-title',</span> <span class="pre">'cmap':</span> <span class="pre">'viridis'},</span> <span class="pre">pltOpts={'plotIntegerContours':</span> <span class="pre">False,</span> <span class="pre">'plotTitle':</span> <span class="pre">'',</span> <span class="pre">'plotZeroContour':</span> <span class="pre">False,</span> <span class="pre">'projection':</span> <span class="pre">&lt;Projected</span> <span class="pre">CRS:</span> <span class="pre">+proj=moll</span> <span class="pre">+a=6378137.0</span> <span class="pre">+lon_0=0</span> <span class="pre">+no_defs</span> <span class="pre">+type=cr</span> <span class="pre">...&gt;</span> <span class="pre">Name:</span> <span class="pre">unknown</span> <span class="pre">Axis</span> <span class="pre">Info</span> <span class="pre">[cartesian]:</span> <span class="pre">-</span> <span class="pre">E[east]:</span> <span class="pre">Easting</span> <span class="pre">(metre)</span> <span class="pre">-</span> <span class="pre">N[north]:</span> <span class="pre">Northing</span> <span class="pre">(metre)</span> <span class="pre">Area</span> <span class="pre">of</span> <span class="pre">Use:</span> <span class="pre">-</span> <span class="pre">undefined</span> <span class="pre">Coordinate</span> <span class="pre">Operation:</span> <span class="pre">-</span> <span class="pre">name:</span> <span class="pre">unknown</span> <span class="pre">-</span> <span class="pre">method:</span> <span class="pre">Mollweide</span> <span class="pre">Datum:</span> <span class="pre">unknown</span> <span class="pre">-</span> <span class="pre">Ellipsoid:</span> <span class="pre">unknown</span> <span class="pre">-</span> <span class="pre">Prime</span> <span class="pre">Meridian:</span> <span class="pre">Greenwich</span> <span class="pre">,</span> <span class="pre">'region':</span> <span class="pre">[-180,</span> <span class="pre">180,</span> <span class="pre">-90,</span> <span class="pre">90],</span> <span class="pre">'regionalZBoundaries':</span> <span class="pre">False,</span> <span class="pre">'transparent':</span> <span class="pre">False,</span> <span class="pre">'valueType':</span> <span class="pre">'Bathymetry',</span> <span class="pre">'valueUnits':</span> <span class="pre">'m'},</span> <span class="pre">saveSVG=False,</span> <span class="pre">savePNG=False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/plotHelper.html#plotGlobal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.plotHelper.plotGlobal" title="Link to this definition">¶</a></dt>
<dd><p>Plot a global (or regional) gridded field on a map projection using Cartopy.</p>
<p>The function renders a latitude/longitude gridded dataset with optional mesh
shading, coastlines, contours (zero or integer/label-like boundaries),
regional masking and recoloring, and a horizontally oriented colorbar.
Saving to PNG and/or SVG is supported.</p>
<dl>
<dt>Args:</dt><dd><dl>
<dt>lat (numpy.ndarray):</dt><dd><p>2-D array of <strong>cell-centered</strong> latitudes in degrees (same shape as <code class="docutils literal notranslate"><span class="pre">values</span></code>),
typically spanning <code class="docutils literal notranslate"><span class="pre">[-90,</span> <span class="pre">90]</span></code> row-wise.</p>
</dd>
<dt>lon (numpy.ndarray):</dt><dd><p>2-D array of <strong>cell-centered</strong> longitudes in degrees (same shape as <code class="docutils literal notranslate"><span class="pre">values</span></code>),
typically spanning <code class="docutils literal notranslate"><span class="pre">[-180,</span> <span class="pre">180]</span></code> column-wise.</p>
</dd>
<dt>values (numpy.ndarray):</dt><dd><p>2-D array of gridded data (same shape as <code class="docutils literal notranslate"><span class="pre">lat</span></code>/<code class="docutils literal notranslate"><span class="pre">lon</span></code>). May include <code class="docutils literal notranslate"><span class="pre">NaN</span></code>.</p>
</dd>
<dt>outputDir (str, optional):</dt><dd><p>Directory to which the figure is saved. Defaults to <code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code> (current behavior
depends on Matplotlib’s savefig path).</p>
</dd>
<dt>fidName (str, optional):</dt><dd><p>Base filename for outputs (PNG and/or SVG). Defaults to <code class="docutils literal notranslate"><span class="pre">&quot;plotGlobal.png&quot;</span></code>.</p>
</dd>
<dt>cmapOpts (dict, optional):</dt><dd><p>Colormap and colorbar configuration. Recognized keys:
- <code class="docutils literal notranslate"><span class="pre">&quot;cmap&quot;</span></code> (str or Colormap): Matplotlib colormap name or object.
- <code class="docutils literal notranslate"><span class="pre">&quot;cbar-title&quot;</span></code> (str): Title text for the colorbar (not always used).
- <code class="docutils literal notranslate"><span class="pre">&quot;cbar-range&quot;</span></code> (list[float, float]): <code class="docutils literal notranslate"><span class="pre">[vmin,</span> <span class="pre">vmax]</span></code> for color scaling.
- <code class="docutils literal notranslate"><span class="pre">&quot;cbar-levels&quot;</span></code> (list[float]): Optional levels.</p>
<blockquote>
<div><p>(Note: passed to <code class="docutils literal notranslate"><span class="pre">pcolormesh</span></code> in a guarded try/except.)</p>
</div></blockquote>
</dd>
<dt>pltOpts (dict, optional):</dt><dd><p>Plot behavior and aesthetics. Recognized keys:
- <code class="docutils literal notranslate"><span class="pre">&quot;valueType&quot;</span></code> (str): Label for data type, used in colorbar label.
- <code class="docutils literal notranslate"><span class="pre">&quot;valueUnits&quot;</span></code> (str): Units string for colorbar label.
- <code class="docutils literal notranslate"><span class="pre">&quot;plotTitle&quot;</span></code> (str): Figure title.
- <code class="docutils literal notranslate"><span class="pre">&quot;plotZeroContour&quot;</span></code> (bool): If True, overlay a contour at value 0.
- <code class="docutils literal notranslate"><span class="pre">&quot;plotIntegerContours&quot;</span></code> (bool): If True, draw boundaries around integer-valued regions.
- <code class="docutils literal notranslate"><span class="pre">&quot;transparent&quot;</span></code> (bool): If True, save figures with transparent background.
- <code class="docutils literal notranslate"><span class="pre">&quot;region&quot;</span></code> (list[float, float, float, float]): <code class="docutils literal notranslate"><span class="pre">[lon_min,</span> <span class="pre">lon_max,</span> <span class="pre">lat_min,</span> <span class="pre">lat_max]</span></code></p>
<blockquote>
<div><p>extent in degrees. Full-globe default is <code class="docutils literal notranslate"><span class="pre">[-180,</span> <span class="pre">180,</span> <span class="pre">-90,</span> <span class="pre">90]</span></code>.</p>
</div></blockquote>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;projection&quot;</span></code> (cartopy.crs.Projection): Target map projection (default Mollweide).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;regionalZBoundaries&quot;</span></code> (bool): If True, mask outside <code class="docutils literal notranslate"><span class="pre">region</span></code> and remap
in-range values to consecutive integers starting at 0, updating the colorbar range.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;mesh&quot;</span></code> (bool): If True, draw shaded mesh with <code class="docutils literal notranslate"><span class="pre">pcolormesh</span></code> (default True).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;nanSolidPoly&quot;</span></code> (bool): If True, render NaN cells as solid polygons.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;nanSolidPolyOutline&quot;</span></code> (bool): If True, outline contiguous NaN regions.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;coastlines&quot;</span></code> (bool): If True, draw coastlines (blue, 1 px).</p></li>
</ul>
</dd>
<dt>saveSVG (bool, optional):</dt><dd><p>If True, saves an SVG copy (filename derived from <code class="docutils literal notranslate"><span class="pre">fidName</span></code>). Defaults to False.</p>
</dd>
<dt>savePNG (bool, optional):</dt><dd><p>If True, saves a PNG copy (uses <code class="docutils literal notranslate"><span class="pre">fidName</span></code>). Defaults to False.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>None:</dt><dd><p>Writes a figure to disk if <code class="docutils literal notranslate"><span class="pre">savePNG</span></code> and/or <code class="docutils literal notranslate"><span class="pre">saveSVG</span></code> is True. Does not return a value.</p>
</dd>
</dl>
</dd>
<dt>Raises:</dt><dd><dl class="simple">
<dt>ValueError:</dt><dd><p>If array shapes of <code class="docutils literal notranslate"><span class="pre">lat</span></code>, <code class="docutils literal notranslate"><span class="pre">lon</span></code>, and <code class="docutils literal notranslate"><span class="pre">values</span></code> are inconsistent. <em>(Not enforced here; caller responsibility.)</em></p>
</dd>
<dt>FileNotFoundError:</dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">outputDir</span></code> does not exist or is not writable. <em>(Depends on Matplotlib/OS behavior.)</em></p>
</dd>
<dt>Exception:</dt><dd><p>Any Matplotlib/Cartopy errors encountered during plotting or saving.</p>
</dd>
</dl>
</dd>
<dt>Notes:</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">pltOpts[&quot;regionalZBoundaries&quot;]</span></code> masks values outside the <code class="docutils literal notranslate"><span class="pre">region</span></code> and then
renumbers unique in-region values to contiguous integers starting at 0, updating
<code class="docutils literal notranslate"><span class="pre">cmapOpts[&quot;cbar-range&quot;]</span></code> accordingly.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">pltOpts[&quot;plotZeroContour&quot;]</span></code> is True, NaNs in <code class="docutils literal notranslate"><span class="pre">values</span></code> are set to 0 for contouring.</p></li>
<li><p>The colorbar tick spacing is heuristically derived from <code class="docutils literal notranslate"><span class="pre">&quot;cbar-range&quot;</span></code> to produce
~4 ticks.</p></li>
<li><p>Gridlines are labeled for regional plots and unlabeled for full-globe plots.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pcolormesh</span></code> is called with <code class="docutils literal notranslate"><span class="pre">transform=ccrs.PlateCarree()</span></code> to map lon/lat to the projection.</p></li>
</ul>
</dd>
<dt>Example:</dt><dd><p>Render a global field in a Mollweide projection and save a PNG:</p>
<p><a href="#id2"><span class="problematic" id="id3">``</span></a><a href="#id4"><span class="problematic" id="id5">`</span></a>python
cmapOpts = {“cmap”: “viridis”, “cbar-range”: [-6000, 6000], “cbar-levels”: [-6000, 0, 6000]}
pltOpts = {“valueType”: “Topography”, “valueUnits”: “m”, “plotTitle”: “ETOPO1”,</p>
<blockquote>
<div><p>“projection”: ccrs.Mollweide(), “region”: [-180, 180, -90, 90],
“plotZeroContour”: True, “coastlines”: True}</p>
</div></blockquote>
<dl class="simple">
<dt>plotGlobal(lat, lon, z, outputDir=”figs”, fidName=”etopo1.png”,</dt><dd><p>cmapOpts=cmapOpts, pltOpts=pltOpts, savePNG=True)</p>
</dd>
</dl>
<p><a href="#id6"><span class="problematic" id="id7">``</span></a><a href="#id8"><span class="problematic" id="id9">`</span></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ExoCcycle.plotHelper.plotGlobalSilhouette">
<span class="sig-prename descclassname"><span class="pre">ExoCcycle.plotHelper.</span></span><span class="sig-name descname"><span class="pre">plotGlobalSilhouette</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">lat,</span> <span class="pre">lon,</span> <span class="pre">values,</span> <span class="pre">BasinIDA,</span> <span class="pre">outputDir='',</span> <span class="pre">fidName='plotGlobal_silhouette.png',</span> <span class="pre">cmapOpts={'cbar-intervals':</span> <span class="pre">array([0.</span>&#160; <span class="pre">,</span> <span class="pre">0.25,</span> <span class="pre">0.5</span> <span class="pre">,</span> <span class="pre">0.7</span> <span class="pre">,</span> <span class="pre">1.</span>&#160; <span class="pre">]),</span> <span class="pre">'cbar-level-names':</span> <span class="pre">['No',</span> <span class="pre">'Weak',</span> <span class="pre">'Medium',</span> <span class="pre">'Strong'],</span> <span class="pre">'cbar-levels':</span> <span class="pre">array([0.</span>&#160; <span class="pre">,</span> <span class="pre">0.25,</span> <span class="pre">0.5</span> <span class="pre">,</span> <span class="pre">0.7</span> <span class="pre">,</span> <span class="pre">1.</span>&#160; <span class="pre">]),</span> <span class="pre">'cbar-range':</span> <span class="pre">[0,</span> <span class="pre">1],</span> <span class="pre">'cbar-title':</span> <span class="pre">'cbar-title',</span> <span class="pre">'cmap':</span> <span class="pre">'jet'},</span> <span class="pre">pltOpts={'nanSolidPoly':</span> <span class="pre">True,</span> <span class="pre">'nanSolidPolyOutline':</span> <span class="pre">True,</span> <span class="pre">'plotIntegerContours':</span> <span class="pre">True,</span> <span class="pre">'plotTitle':</span> <span class="pre">'',</span> <span class="pre">'plotZeroContour':</span> <span class="pre">False,</span> <span class="pre">'projection':</span> <span class="pre">&lt;Projected</span> <span class="pre">CRS:</span> <span class="pre">+proj=moll</span> <span class="pre">+a=6378137.0</span> <span class="pre">+lon_0=0</span> <span class="pre">+no_defs</span> <span class="pre">+type=cr</span> <span class="pre">...&gt;</span> <span class="pre">Name:</span> <span class="pre">unknown</span> <span class="pre">Axis</span> <span class="pre">Info</span> <span class="pre">[cartesian]:</span> <span class="pre">-</span> <span class="pre">E[east]:</span> <span class="pre">Easting</span> <span class="pre">(metre)</span> <span class="pre">-</span> <span class="pre">N[north]:</span> <span class="pre">Northing</span> <span class="pre">(metre)</span> <span class="pre">Area</span> <span class="pre">of</span> <span class="pre">Use:</span> <span class="pre">-</span> <span class="pre">undefined</span> <span class="pre">Coordinate</span> <span class="pre">Operation:</span> <span class="pre">-</span> <span class="pre">name:</span> <span class="pre">unknown</span> <span class="pre">-</span> <span class="pre">method:</span> <span class="pre">Mollweide</span> <span class="pre">Datum:</span> <span class="pre">unknown</span> <span class="pre">-</span> <span class="pre">Ellipsoid:</span> <span class="pre">unknown</span> <span class="pre">-</span> <span class="pre">Prime</span> <span class="pre">Meridian:</span> <span class="pre">Greenwich</span> <span class="pre">,</span> <span class="pre">'region':</span> <span class="pre">[-180,</span> <span class="pre">180,</span> <span class="pre">-90,</span> <span class="pre">90],</span> <span class="pre">'regionalZBoundaries':</span> <span class="pre">False,</span> <span class="pre">'transparent':</span> <span class="pre">True,</span> <span class="pre">'valueType':</span> <span class="pre">'Silhouette</span> <span class="pre">Structure',</span> <span class="pre">'valueUnits':</span> <span class="pre">'-'},</span> <span class="pre">saveSVG=False,</span> <span class="pre">savePNG=False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/plotHelper.html#plotGlobalSilhouette"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.plotHelper.plotGlobalSilhouette" title="Link to this definition">¶</a></dt>
<dd><p>Plot a global (or regional) <strong>silhouette</strong> field with discrete color levels and basin boundaries.</p>
<p>Renders a gridded silhouette metric (<code class="docutils literal notranslate"><span class="pre">values</span></code>) on a Cartopy map using a <strong>discrete</strong>
colormap defined by <code class="docutils literal notranslate"><span class="pre">cmapOpts[&quot;cbar-levels&quot;]</span></code> and <code class="docutils literal notranslate"><span class="pre">BoundaryNorm</span></code>. Optionally
overlays basin boundaries derived from <code class="docutils literal notranslate"><span class="pre">BasinIDA</span></code>, draws NaN masks, and labels a
horizontal colorbar with category names supplied via <code class="docutils literal notranslate"><span class="pre">&quot;cbar-level-names&quot;</span></code>.</p>
<dl>
<dt>Args:</dt><dd><dl>
<dt>lat (numpy.ndarray):</dt><dd><p>2-D array of cell-centered latitudes in degrees (same shape as <code class="docutils literal notranslate"><span class="pre">values</span></code>).</p>
</dd>
<dt>lon (numpy.ndarray):</dt><dd><p>2-D array of cell-centered longitudes in degrees (same shape as <code class="docutils literal notranslate"><span class="pre">values</span></code>).</p>
</dd>
<dt>values (numpy.ndarray):</dt><dd><p>2-D array of silhouette values to shade; may include <code class="docutils literal notranslate"><span class="pre">NaN</span></code>.</p>
</dd>
<dt>BasinIDA (numpy.ndarray):</dt><dd><p>2-D array of integer/categorical basin IDs aligned with <code class="docutils literal notranslate"><span class="pre">values</span></code> for
boundary overlays and NaN masks.</p>
</dd>
<dt>outputDir (str, optional):</dt><dd><p>Directory to which the figure is saved. Defaults to <code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code> (current behavior
depends on Matplotlib’s savefig path).</p>
</dd>
<dt>fidName (str, optional):</dt><dd><p>Filename for PNG output. The SVG name is derived by replacing <code class="docutils literal notranslate"><span class="pre">.png</span></code> with <code class="docutils literal notranslate"><span class="pre">.svg</span></code>.</p>
</dd>
<dt>cmapOpts (dict, optional):</dt><dd><p>Discrete colormap and colorbar settings:
- <code class="docutils literal notranslate"><span class="pre">&quot;cmap&quot;</span></code> (str): Matplotlib colormap name (resolved via <code class="docutils literal notranslate"><span class="pre">plt.cm.get_cmap</span></code>).
- <code class="docutils literal notranslate"><span class="pre">&quot;cbar-title&quot;</span></code> (str): Title for the colorbar (not always used).
- <code class="docutils literal notranslate"><span class="pre">&quot;cbar-range&quot;</span></code> (list[float, float]): Overall numeric range (may be unused with discrete norm).
- <code class="docutils literal notranslate"><span class="pre">&quot;cbar-levels&quot;</span></code> (array-like): Monotonic sequence of bin edges for discrete coloring.
- <code class="docutils literal notranslate"><span class="pre">&quot;cbar-intervals&quot;</span></code> (array-like): Provided but unused here (kept for API symmetry).
- <code class="docutils literal notranslate"><span class="pre">&quot;cbar-level-names&quot;</span></code> (list[str]): Labels for colorbar ticks; one fewer or equal to the number</p>
<blockquote>
<div><p>of edges depending on labeling strategy (this function labels mid-bin positions).</p>
</div></blockquote>
</dd>
<dt>pltOpts (dict, optional):</dt><dd><p>Plot behavior and aesthetics:
- <code class="docutils literal notranslate"><span class="pre">&quot;valueType&quot;</span></code> (str): Label for data type (used in colorbar label).
- <code class="docutils literal notranslate"><span class="pre">&quot;valueUnits&quot;</span></code> (str): Units for colorbar label.
- <code class="docutils literal notranslate"><span class="pre">&quot;plotTitle&quot;</span></code> (str): Figure title.
- <code class="docutils literal notranslate"><span class="pre">&quot;plotZeroContour&quot;</span></code> (bool): If True, overlays a zero contour of <code class="docutils literal notranslate"><span class="pre">values</span></code>.
- <code class="docutils literal notranslate"><span class="pre">&quot;nanSolidPoly&quot;</span></code> (bool): If True, fills NaN regions derived from <code class="docutils literal notranslate"><span class="pre">BasinIDA</span></code>.
- <code class="docutils literal notranslate"><span class="pre">&quot;nanSolidPolyOutline&quot;</span></code> (bool): If True, outlines contiguous NaN regions.
- <code class="docutils literal notranslate"><span class="pre">&quot;plotIntegerContours&quot;</span></code> (bool): If True, draws per-basin boundary contours from <code class="docutils literal notranslate"><span class="pre">BasinIDA</span></code>.
- <code class="docutils literal notranslate"><span class="pre">&quot;regionalZBoundaries&quot;</span></code> (bool): If True, masks <code class="docutils literal notranslate"><span class="pre">values</span></code> outside <code class="docutils literal notranslate"><span class="pre">&quot;region&quot;</span></code> and remaps</p>
<blockquote>
<div><p>unique in-range values to consecutive integers starting at 0; updates colorbar range.</p>
</div></blockquote>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;region&quot;</span></code> (list[float, float, float, float]): Extent <code class="docutils literal notranslate"><span class="pre">[lon_min,</span> <span class="pre">lon_max,</span> <span class="pre">lat_min,</span> <span class="pre">lat_max]</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;projection&quot;</span></code> (cartopy.crs.Projection): Target projection (default Mollweide).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;transparent&quot;</span></code> (bool): If True, saves with transparent background.</p></li>
</ul>
</dd>
<dt>saveSVG (bool, optional):</dt><dd><p>Save an SVG alongside PNG. Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
</dd>
<dt>savePNG (bool, optional):</dt><dd><p>Save a PNG using <code class="docutils literal notranslate"><span class="pre">fidName</span></code>. Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>None:</dt><dd><p>Writes figure(s) to disk if requested; no value is returned.</p>
</dd>
</dl>
</dd>
<dt>Raises:</dt><dd><dl class="simple">
<dt>ValueError:</dt><dd><p>If input array shapes are inconsistent. <em>(Not explicitly validated here.)</em></p>
</dd>
<dt>FileNotFoundError:</dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">outputDir</span></code> is invalid/unwritable. <em>(Depends on Matplotlib/OS behavior.)</em></p>
</dd>
<dt>Exception:</dt><dd><p>Any Matplotlib/Cartopy runtime errors encountered during plotting or saving.</p>
</dd>
</dl>
</dd>
<dt>Notes:</dt><dd><ul class="simple">
<li><p><strong>Discrete colormap:</strong> Coloring uses <code class="docutils literal notranslate"><span class="pre">mpl.colors.BoundaryNorm(cbar-levels,</span> <span class="pre">cmap.N)</span></code> so bins are
closed-open intervals aligned to your silhouette thresholds.</p></li>
<li><p><strong>Colorbar ticks:</strong> Tick positions are set at bin midpoints and labeled with <code class="docutils literal notranslate"><span class="pre">&quot;cbar-level-names&quot;</span></code>.</p></li>
<li><p><strong>Boundaries:</strong> Basin boundaries are drawn by thresholding each integer ID in <code class="docutils literal notranslate"><span class="pre">BasinIDA</span></code> and
contouring at 0.5. NaN masks (fill/outline) are derived from <code class="docutils literal notranslate"><span class="pre">BasinIDA</span></code> NaNs.</p></li>
<li><p><strong>Regional masking:</strong> With <code class="docutils literal notranslate"><span class="pre">regionalZBoundaries=True</span></code>, values outside <code class="docutils literal notranslate"><span class="pre">region</span></code> are set to NaN
and remaining unique values are renumbered 0..N-1, updating the colorbar range accordingly.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pcolormesh</span></code> uses <code class="docutils literal notranslate"><span class="pre">transform=ccrs.PlateCarree()</span></code> to map lon/lat into the selected projection.</p></li>
</ul>
</dd>
<dt>Example:</dt><dd><p>Plot silhouette strength categories with custom labels:</p>
<p><a href="#id10"><span class="problematic" id="id11">``</span></a><a href="#id12"><span class="problematic" id="id13">`</span></a>python
cmapOpts = {</p>
<blockquote>
<div><p>“cmap”: “viridis”,
“cbar-levels”: np.array([0.0, 0.25, 0.5, 0.7, 1.0]),
“cbar-level-names”: [“No”, “Weak”, “Medium”, “Strong”]</p>
</div></blockquote>
<p>}
pltOpts = {</p>
<blockquote>
<div><p>“valueType”: “Silhouette”,
“valueUnits”: “-“,
“plotTitle”: “Silhouette categories”,
“projection”: ccrs.Mollweide(),
“plotIntegerContours”: True,
“transparent”: True</p>
</div></blockquote>
<p>}
plotGlobalSilhouette(lat, lon, sil_values, basin_ids,</p>
<blockquote>
<div><p>outputDir=”figs”, fidName=”silhouette.png”,
cmapOpts=cmapOpts, pltOpts=pltOpts, savePNG=True)</p>
</div></blockquote>
<p><a href="#id14"><span class="problematic" id="id15">``</span></a><a href="#id16"><span class="problematic" id="id17">`</span></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ExoCcycle.plotHelper.plotGlobalwBoundaries">
<span class="sig-prename descclassname"><span class="pre">ExoCcycle.plotHelper.</span></span><span class="sig-name descname"><span class="pre">plotGlobalwBoundaries</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">lat,</span> <span class="pre">lon,</span> <span class="pre">values,</span> <span class="pre">BasinIDA,</span> <span class="pre">outputDir='',</span> <span class="pre">fidName='plotGlobal_wBoundaries.png',</span> <span class="pre">cmapOpts={'cbar-range':</span> <span class="pre">[0,</span> <span class="pre">1],</span> <span class="pre">'cbar-title':</span> <span class="pre">'cbar-title',</span> <span class="pre">'cmap':</span> <span class="pre">'jet'},</span> <span class="pre">pltOpts={'nanSolidPoly':</span> <span class="pre">True,</span> <span class="pre">'nanSolidPolyOutline':</span> <span class="pre">True,</span> <span class="pre">'plotIntegerContours':</span> <span class="pre">True,</span> <span class="pre">'plotTitle':</span> <span class="pre">'',</span> <span class="pre">'plotZeroContour':</span> <span class="pre">False,</span> <span class="pre">'projection':</span> <span class="pre">&lt;Projected</span> <span class="pre">CRS:</span> <span class="pre">+proj=moll</span> <span class="pre">+a=6378137.0</span> <span class="pre">+lon_0=0</span> <span class="pre">+no_defs</span> <span class="pre">+type=cr</span> <span class="pre">...&gt;</span> <span class="pre">Name:</span> <span class="pre">unknown</span> <span class="pre">Axis</span> <span class="pre">Info</span> <span class="pre">[cartesian]:</span> <span class="pre">-</span> <span class="pre">E[east]:</span> <span class="pre">Easting</span> <span class="pre">(metre)</span> <span class="pre">-</span> <span class="pre">N[north]:</span> <span class="pre">Northing</span> <span class="pre">(metre)</span> <span class="pre">Area</span> <span class="pre">of</span> <span class="pre">Use:</span> <span class="pre">-</span> <span class="pre">undefined</span> <span class="pre">Coordinate</span> <span class="pre">Operation:</span> <span class="pre">-</span> <span class="pre">name:</span> <span class="pre">unknown</span> <span class="pre">-</span> <span class="pre">method:</span> <span class="pre">Mollweide</span> <span class="pre">Datum:</span> <span class="pre">unknown</span> <span class="pre">-</span> <span class="pre">Ellipsoid:</span> <span class="pre">unknown</span> <span class="pre">-</span> <span class="pre">Prime</span> <span class="pre">Meridian:</span> <span class="pre">Greenwich</span> <span class="pre">,</span> <span class="pre">'region':</span> <span class="pre">[-180,</span> <span class="pre">180,</span> <span class="pre">-90,</span> <span class="pre">90],</span> <span class="pre">'regionalZBoundaries':</span> <span class="pre">False,</span> <span class="pre">'transparent':</span> <span class="pre">True,</span> <span class="pre">'valueType':</span> <span class="pre">'Silhouette</span> <span class="pre">Structure',</span> <span class="pre">'valueUnits':</span> <span class="pre">'-'},</span> <span class="pre">saveSVG=False,</span> <span class="pre">savePNG=False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/plotHelper.html#plotGlobalwBoundaries"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.plotHelper.plotGlobalwBoundaries" title="Link to this definition">¶</a></dt>
<dd><p>Plot a global (or regional) scalar field with overlaid basin boundaries.</p>
<p>Renders a gridded field (<code class="docutils literal notranslate"><span class="pre">values</span></code>) on a Cartopy map projection with optional
masking to a region, solid polygons/contours to visualize NaN areas, and
integer-boundary contours derived from a basin-ID array (<code class="docutils literal notranslate"><span class="pre">BasinIDA</span></code>). A
horizontal colorbar is added when mesh shading is enabled. PNG and SVG export
are supported.</p>
<dl>
<dt>Args:</dt><dd><dl>
<dt>lat (numpy.ndarray):</dt><dd><p>2-D array of <strong>cell-centered</strong> latitudes (degrees), same shape as <code class="docutils literal notranslate"><span class="pre">values</span></code>.</p>
</dd>
<dt>lon (numpy.ndarray):</dt><dd><p>2-D array of <strong>cell-centered</strong> longitudes (degrees), same shape as <code class="docutils literal notranslate"><span class="pre">values</span></code>.</p>
</dd>
<dt>values (numpy.ndarray):</dt><dd><p>2-D array of scalar data to shade (same shape as <code class="docutils literal notranslate"><span class="pre">lat</span></code>/<code class="docutils literal notranslate"><span class="pre">lon</span></code>). May include <code class="docutils literal notranslate"><span class="pre">NaN</span></code>.</p>
</dd>
<dt>BasinIDA (numpy.ndarray):</dt><dd><p>2-D array of integer (or categorical) basin IDs aligned with <code class="docutils literal notranslate"><span class="pre">values</span></code> for
boundary visualization (integer-step contouring and NaN overlays).</p>
</dd>
<dt>outputDir (str, optional):</dt><dd><p>Directory to which the figure is saved. Defaults to <code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code> (current behavior
depends on Matplotlib’s savefig path).</p>
</dd>
<dt>fidName (str, optional):</dt><dd><p>Output filename for PNG; used as base to derive SVG name. Defaults to
<code class="docutils literal notranslate"><span class="pre">&quot;plotGlobal_wBoundaries.png&quot;</span></code>.</p>
</dd>
<dt>cmapOpts (dict, optional):</dt><dd><p>Colormap and colorbar configuration. Recognized keys:
- <code class="docutils literal notranslate"><span class="pre">&quot;cmap&quot;</span></code> (str): Colormap name (resolved via <code class="docutils literal notranslate"><span class="pre">plt.cm.get_cmap</span></code>).
- <code class="docutils literal notranslate"><span class="pre">&quot;cbar-title&quot;</span></code> (str): Title for the colorbar (not always used).
- <code class="docutils literal notranslate"><span class="pre">&quot;cbar-range&quot;</span></code> (list[float, float]): <code class="docutils literal notranslate"><span class="pre">[vmin,</span> <span class="pre">vmax]</span></code>.</p>
</dd>
<dt>pltOpts (dict, optional):</dt><dd><p>Plot behavior and aesthetics. Recognized keys:
- <code class="docutils literal notranslate"><span class="pre">&quot;valueType&quot;</span></code> (str): Label for data type (used in colorbar label).
- <code class="docutils literal notranslate"><span class="pre">&quot;valueUnits&quot;</span></code> (str): Units string for colorbar label.
- <code class="docutils literal notranslate"><span class="pre">&quot;plotTitle&quot;</span></code> (str): Figure title text.
- <code class="docutils literal notranslate"><span class="pre">&quot;plotZeroContour&quot;</span></code> (bool): If True, contour a zero isoline of <code class="docutils literal notranslate"><span class="pre">values</span></code>.
- <code class="docutils literal notranslate"><span class="pre">&quot;nanSolidPoly&quot;</span></code> (bool): If True, shade NaN regions (from <code class="docutils literal notranslate"><span class="pre">BasinIDA</span></code>) as solid polygons.
- <code class="docutils literal notranslate"><span class="pre">&quot;nanSolidPolyOutline&quot;</span></code> (bool): If True, outline contiguous NaN regions (from <code class="docutils literal notranslate"><span class="pre">BasinIDA</span></code>).
- <code class="docutils literal notranslate"><span class="pre">&quot;plotIntegerContours&quot;</span></code> (bool): If True, draw boundaries for each integer basin ID.
- <code class="docutils literal notranslate"><span class="pre">&quot;regionalZBoundaries&quot;</span></code> (bool): If True, mask <code class="docutils literal notranslate"><span class="pre">values</span></code> outside <code class="docutils literal notranslate"><span class="pre">region</span></code> and remap</p>
<blockquote>
<div><p>surviving unique values to 0..N-1; updates <code class="docutils literal notranslate"><span class="pre">cmapOpts[&quot;cbar-range&quot;]</span></code>.</p>
</div></blockquote>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;region&quot;</span></code> (list[float, float, float, float]): <code class="docutils literal notranslate"><span class="pre">[lon_min,</span> <span class="pre">lon_max,</span> <span class="pre">lat_min,</span> <span class="pre">lat_max]</span></code> extent.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;projection&quot;</span></code> (cartopy.crs.Projection): Target map projection (default Mollweide).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;transparent&quot;</span></code> (bool): If True, save with transparent background.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;boundaryColor&quot;</span></code> (str, optional): Color for integer boundary contours (default <code class="docutils literal notranslate"><span class="pre">'k'</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;boundaryLinewidth&quot;</span></code> (float, optional): Line width for boundary contours (default <code class="docutils literal notranslate"><span class="pre">1</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;mesh&quot;</span></code> (bool, optional): If True, render the shaded mesh (default True).</p></li>
</ul>
</dd>
<dt>saveSVG (bool, optional):</dt><dd><p>If True, also save an SVG (name derived from <code class="docutils literal notranslate"><span class="pre">fidName</span></code>). Defaults to False.</p>
</dd>
<dt>savePNG (bool, optional):</dt><dd><p>If True, save a PNG using <code class="docutils literal notranslate"><span class="pre">fidName</span></code>. Defaults to False.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>None:</dt><dd><p>Writes a figure to disk when <code class="docutils literal notranslate"><span class="pre">savePNG</span></code> and/or <code class="docutils literal notranslate"><span class="pre">saveSVG</span></code> is True.</p>
</dd>
</dl>
</dd>
<dt>Raises:</dt><dd><dl class="simple">
<dt>ValueError:</dt><dd><p>If input array shapes are inconsistent. <em>(Not validated here; caller responsibility.)</em></p>
</dd>
<dt>FileNotFoundError:</dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">outputDir</span></code> is invalid/unwritable. <em>(Depends on Matplotlib/OS behavior.)</em></p>
</dd>
<dt>Exception:</dt><dd><p>Any Matplotlib/Cartopy errors encountered during plotting or saving.</p>
</dd>
</dl>
</dd>
<dt>Notes:</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">regionalZBoundaries</span></code>: values outside the extent are set to <code class="docutils literal notranslate"><span class="pre">NaN</span></code>; remaining unique
values are renumbered sequentially starting at 0 to create a compact categorical range.</p></li>
<li><p>Integer boundary contours are derived from <code class="docutils literal notranslate"><span class="pre">BasinIDA</span></code> by thresholding each ID and
contouring at 0.5.</p></li>
<li><p>NaN overlays/contours are also computed from <code class="docutils literal notranslate"><span class="pre">BasinIDA</span></code>’s NaN mask (not <code class="docutils literal notranslate"><span class="pre">values</span></code>)
to highlight missing/invalid basins.</p></li>
<li><p>Colormap is resolved via <code class="docutils literal notranslate"><span class="pre">plt.cm.get_cmap(cmapOpts[&quot;cmap&quot;])</span></code>.</p></li>
<li><p>Gridlines are labeled for regional plots and hidden for full-globe plots.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pcolormesh</span></code> uses <code class="docutils literal notranslate"><span class="pre">transform=ccrs.PlateCarree()</span></code> to project lon/lat to the target projection.</p></li>
</ul>
</dd>
<dt>Example:</dt><dd><p>Plot silhouette values with basin boundaries and save a transparent PNG:</p>
<p><a href="#id18"><span class="problematic" id="id19">``</span></a><a href="#id20"><span class="problematic" id="id21">`</span></a>python
pltOpts = {</p>
<blockquote>
<div><p>“valueType”: “Silhouette”,
“valueUnits”: “-“,
“plotTitle”: “Basins &amp; Silhouette”,
“projection”: ccrs.Mollweide(),
“region”: [-180, 180, -90, 90],
“plotIntegerContours”: True,
“transparent”: True</p>
</div></blockquote>
<p>}
cmapOpts = {“cmap”: “viridis”, “cbar-range”: [0, 1]}
plotGlobalwBoundaries(lat, lon, silhouette, basin_ids,</p>
<blockquote>
<div><p>outputDir=”figs”,
fidName=”silhouette_basins.png”,
cmapOpts=cmapOpts, pltOpts=pltOpts,
savePNG=True)</p>
</div></blockquote>
<p><a href="#id22"><span class="problematic" id="id23">``</span></a><a href="#id24"><span class="problematic" id="id25">`</span></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ExoCcycle.plotHelper.plotGlobalwHist">
<span class="sig-prename descclassname"><span class="pre">ExoCcycle.plotHelper.</span></span><span class="sig-name descname"><span class="pre">plotGlobalwHist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binEdges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bathymetryAreaDist_wHighlat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bathymetryAreaDist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">highlatlat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputDir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fidName</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'plotGlobal.png'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmapOpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'cbar-range':</span> <span class="pre">[0,</span> <span class="pre">1],</span> <span class="pre">'cbar-title':</span> <span class="pre">'cbar-title',</span> <span class="pre">'cmap':</span> <span class="pre">'viridis'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pltOpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'plotTitle':</span> <span class="pre">'',</span> <span class="pre">'plotZeroContour':</span> <span class="pre">False,</span> <span class="pre">'valueType':</span> <span class="pre">'Bathymetry',</span> <span class="pre">'valueUnits':</span> <span class="pre">'m'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveSVG</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savePNG</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/plotHelper.html#plotGlobalwHist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.plotHelper.plotGlobalwHist" title="Link to this definition">¶</a></dt>
<dd><p>Plot a global (Mollweide) gridded map with a stacked histogram underneath.</p>
<p>The top panel renders a latitude/longitude gridded field (<code class="docutils literal notranslate"><span class="pre">values</span></code>) on a
Cartopy Mollweide projection with an accompanying horizontal colorbar.
The bottom panel draws a side-by-side bar chart comparing two bathymetry
area distributions across common bins (<code class="docutils literal notranslate"><span class="pre">binEdges</span></code>).</p>
<dl>
<dt>Args:</dt><dd><dl class="simple">
<dt>lat (numpy.ndarray):</dt><dd><p>2-D array of <strong>cell-centered</strong> latitudes in degrees, same shape as <code class="docutils literal notranslate"><span class="pre">values</span></code>.</p>
</dd>
<dt>lon (numpy.ndarray):</dt><dd><p>2-D array of <strong>cell-centered</strong> longitudes in degrees, same shape as <code class="docutils literal notranslate"><span class="pre">values</span></code>.</p>
</dd>
<dt>values (numpy.ndarray):</dt><dd><p>2-D array of gridded data to shade (same shape as <code class="docutils literal notranslate"><span class="pre">lat</span></code>/<code class="docutils literal notranslate"><span class="pre">lon</span></code>). May contain <code class="docutils literal notranslate"><span class="pre">NaN</span></code>.</p>
</dd>
<dt>binEdges (array-like):</dt><dd><p>Monotonically increasing 1-D array of bin edges (length <code class="docutils literal notranslate"><span class="pre">N+1</span></code>) for the histogram x-axis.</p>
</dd>
<dt>bathymetryAreaDist_wHighlat (array-like):</dt><dd><p>Length-<code class="docutils literal notranslate"><span class="pre">N</span></code> array of area percentages (or other weights) for <strong>all</strong> bathymetry.</p>
</dd>
<dt>bathymetryAreaDist (array-like):</dt><dd><p>Length-<code class="docutils literal notranslate"><span class="pre">N</span></code> array of area percentages for the bathymetry <strong>excluding</strong> high-latitude data.</p>
</dd>
<dt>highlatlat (float):</dt><dd><p>Latitude threshold (in degrees) used to define the “high-latitude” removal, for legend text.</p>
</dd>
<dt>outputDir (str, optional):</dt><dd><p>Directory to which the figure is saved. Defaults to <code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code> (current behavior
depends on Matplotlib’s savefig path).</p>
</dd>
<dt>fidName (str, optional):</dt><dd><p>PNG output filename (also used to derive SVG name). Defaults to <code class="docutils literal notranslate"><span class="pre">&quot;plotGlobal.png&quot;</span></code>.</p>
</dd>
<dt>cmapOpts (dict, optional):</dt><dd><p>Colormap configuration:
- <code class="docutils literal notranslate"><span class="pre">&quot;cmap&quot;</span></code> (str or Colormap): Name/object passed to <code class="docutils literal notranslate"><span class="pre">pcolormesh</span></code>.
- <code class="docutils literal notranslate"><span class="pre">&quot;cbar-title&quot;</span></code> (str): (Not directly used here; label is derived from <code class="docutils literal notranslate"><span class="pre">pltOpts</span></code>).
- <code class="docutils literal notranslate"><span class="pre">&quot;cbar-range&quot;</span></code> (list[float, float]): <code class="docutils literal notranslate"><span class="pre">[vmin,</span> <span class="pre">vmax]</span></code> for shading.</p>
</dd>
<dt>pltOpts (dict, optional):</dt><dd><p>Plot appearance and behavior:
- <code class="docutils literal notranslate"><span class="pre">&quot;valueType&quot;</span></code> (str): Label for colorbar (e.g., <em>Bathymetry</em>).
- <code class="docutils literal notranslate"><span class="pre">&quot;valueUnits&quot;</span></code> (str): Units label (e.g., <em>m</em>).
- <code class="docutils literal notranslate"><span class="pre">&quot;plotTitle&quot;</span></code> (str): Overall figure title.
- <code class="docutils literal notranslate"><span class="pre">&quot;plotZeroContour&quot;</span></code> (bool): If True, overlay a 0-contour on the map panel.</p>
</dd>
<dt>saveSVG (bool, optional):</dt><dd><p>If True, save an SVG copy (<code class="docutils literal notranslate"><span class="pre">fidName</span></code> with <code class="docutils literal notranslate"><span class="pre">.svg</span></code>). Defaults to False.</p>
</dd>
<dt>savePNG (bool, optional):</dt><dd><p>If True, save a PNG using <code class="docutils literal notranslate"><span class="pre">fidName</span></code>. Defaults to False.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>None:</dt><dd><p>Writes the composed figure to disk when requested; no value is returned.</p>
</dd>
</dl>
</dd>
<dt>Raises:</dt><dd><dl class="simple">
<dt>ValueError:</dt><dd><p>If the histogram inputs have incompatible lengths (caller responsibility; not checked here).</p>
</dd>
<dt>FileNotFoundError:</dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">outputDir</span></code> is invalid/unwritable. <em>(Depends on Matplotlib/OS behavior.)</em></p>
</dd>
<dt>Exception:</dt><dd><p>Any Cartopy/Matplotlib errors encountered during plotting or saving.</p>
</dd>
</dl>
</dd>
<dt>Notes:</dt><dd><ul class="simple">
<li><p>The upper map uses <code class="docutils literal notranslate"><span class="pre">pcolormesh</span></code> with <code class="docutils literal notranslate"><span class="pre">transform=ccrs.PlateCarree()</span></code> onto a Mollweide axes.</p></li>
<li><p>The colorbar label is formed from <code class="docutils literal notranslate"><span class="pre">pltOpts[&quot;valueType&quot;]</span></code> and <code class="docutils literal notranslate"><span class="pre">pltOpts[&quot;valueUnits&quot;]</span></code>.</p></li>
<li><p>The histogram shows two bar series at each bin center, offset slightly to avoid overlap.</p></li>
<li><p>Gridlines are drawn on the map via <code class="docutils literal notranslate"><span class="pre">ax1.gridlines()</span></code> with library defaults.</p></li>
</ul>
</dd>
<dt>Example:</dt><dd><p>Render a bathymetry map and a bin-wise area comparison:</p>
<p><a href="#id26"><span class="problematic" id="id27">``</span></a><a href="#id28"><span class="problematic" id="id29">`</span></a>python
cmapOpts = {“cmap”: “viridis”, “cbar-range”: [-6000, 6000]}
pltOpts  = {“valueType”: “Bathymetry”, “valueUnits”: “m”, “plotTitle”: “Global bathymetry”,</p>
<blockquote>
<div><p>“plotZeroContour”: True}</p>
</div></blockquote>
<dl class="simple">
<dt>plotGlobalwHist(lat, lon, z, binEdges,</dt><dd><p>area_all, area_no_highlat, 60.0,
outputDir=”figs”, fidName=”bathymetry_map_hist.png”,
cmapOpts=cmapOpts, pltOpts=pltOpts, savePNG=True)</p>
</dd>
</dl>
<p><a href="#id30"><span class="problematic" id="id31">``</span></a><a href="#id32"><span class="problematic" id="id33">`</span></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ExoCcycle.plotHelper.plotLargeBasins">
<span class="sig-prename descclassname"><span class="pre">ExoCcycle.plotHelper.</span></span><span class="sig-name descname"><span class="pre">plotLargeBasins</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">basins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fieldNum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Field1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">percentage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fldName</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savePNG</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/plotHelper.html#plotLargeBasins"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.plotHelper.plotLargeBasins" title="Link to this definition">¶</a></dt>
<dd><p>Plot only the basins whose area exceeds a given fraction of the domain.</p>
<p>This function computes area-weighted sizes of each basin (using
<code class="docutils literal notranslate"><span class="pre">basins.areaWeights</span></code> masked by <code class="docutils literal notranslate"><span class="pre">basins.BasinIDA</span></code>), removes basins whose
area is below <code class="docutils literal notranslate"><span class="pre">percentage</span> <span class="pre">*</span> <span class="pre">total_area</span></code>, reindexes the remaining basins to
consecutive integers starting at 0, and renders a categorical global map via
<a class="reference internal" href="#ExoCcycle.plotHelper.plotGlobal" title="ExoCcycle.plotHelper.plotGlobal"><code class="xref py py-func docutils literal notranslate"><span class="pre">plotGlobal()</span></code></a>.</p>
<dl>
<dt>Args:</dt><dd><dl class="simple">
<dt>basins:</dt><dd><p>ExoCcycle-style object that provides at least the attributes:
- <code class="docutils literal notranslate"><span class="pre">lat</span></code> (2-D array): cell-centered latitudes (deg)
- <code class="docutils literal notranslate"><span class="pre">lon</span></code> (2-D array): cell-centered longitudes (deg)
- <code class="docutils literal notranslate"><span class="pre">BasinIDA</span></code> (2-D array): integer/categorical basin IDs (<code class="docutils literal notranslate"><span class="pre">NaN</span></code> for no data)
- <code class="docutils literal notranslate"><span class="pre">areaWeights</span></code> (2-D array): area per cell (same shape as <code class="docutils literal notranslate"><span class="pre">BasinIDA</span></code>)
- <code class="docutils literal notranslate"><span class="pre">Fields</span></code> (dict-like): metadata; accessed as <code class="docutils literal notranslate"><span class="pre">basins.Fields[fieldNum]</span></code></p>
</dd>
<dt>fieldNum (str, optional):</dt><dd><p>Key into <code class="docutils literal notranslate"><span class="pre">basins.Fields</span></code> used <strong>only</strong> to label the colorbar title as
<code class="docutils literal notranslate"><span class="pre">&quot;BasinID</span> <span class="pre">divided</span> <span class="pre">by</span> <span class="pre">{parameterName}&quot;</span></code>. Defaults to <code class="docutils literal notranslate"><span class="pre">&quot;Field1&quot;</span></code>.</p>
</dd>
<dt>percentage (float, optional):</dt><dd><p>Minimum fraction of the total represented area a basin must cover to be
retained (e.g., <code class="docutils literal notranslate"><span class="pre">0.05</span></code> for 5%). Defaults to <code class="docutils literal notranslate"><span class="pre">0.05</span></code>.</p>
</dd>
<dt>fldName (str, optional):</dt><dd><p>Directory to save the resulting figure. Defaults to <code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code> (current behavior
depends on <a class="reference internal" href="#ExoCcycle.plotHelper.plotGlobal" title="ExoCcycle.plotHelper.plotGlobal"><code class="xref py py-func docutils literal notranslate"><span class="pre">plotGlobal()</span></code></a>).</p>
</dd>
<dt>savePNG (bool, optional):</dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, writes a PNG to disk using <a class="reference internal" href="#ExoCcycle.plotHelper.plotGlobal" title="ExoCcycle.plotHelper.plotGlobal"><code class="xref py py-func docutils literal notranslate"><span class="pre">plotGlobal()</span></code></a>. Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
</dd>
<dt>verbose (bool, optional):</dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, prints summary information about kept/removed basins. Defaults to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>None:</dt><dd><p>Writes a figure to disk when <code class="docutils literal notranslate"><span class="pre">savePNG</span></code> is True; no value is returned.</p>
</dd>
</dl>
</dd>
<dt>Raises:</dt><dd><dl class="simple">
<dt>KeyError:</dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">fieldNum</span></code> is not present in <code class="docutils literal notranslate"><span class="pre">basins.Fields</span></code>. <em>(Not validated here.)</em></p>
</dd>
<dt>ValueError:</dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">percentage</span></code> is outside <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">1]</span></code>. <em>(Not validated here.)</em></p>
</dd>
<dt>Exception:</dt><dd><p>Any errors raised downstream by <a class="reference internal" href="#ExoCcycle.plotHelper.plotGlobal" title="ExoCcycle.plotHelper.plotGlobal"><code class="xref py py-func docutils literal notranslate"><span class="pre">plotGlobal()</span></code></a> or file I/O.</p>
</dd>
</dl>
</dd>
<dt>Notes:</dt><dd><ul class="simple">
<li><p>Basins whose area (sum of <code class="docutils literal notranslate"><span class="pre">areaWeights</span></code> within each basin ID) is
below <code class="docutils literal notranslate"><span class="pre">percentage</span> <span class="pre">*</span> <span class="pre">total_area</span></code> are set to <code class="docutils literal notranslate"><span class="pre">NaN</span></code> and excluded.</p></li>
<li><p>Remaining basin IDs are <strong>reindexed</strong> to 0..N-1 prior to plotting so that
colormap limits reflect the new categorical range.</p></li>
<li><p>The plotted colorbar label uses
<code class="docutils literal notranslate"><span class="pre">basins.Fields[fieldNum]['parameterName']</span></code> for context.</p></li>
</ul>
</dd>
<dt>Example:</dt><dd><p><a href="#id34"><span class="problematic" id="id35">``</span></a><a href="#id36"><span class="problematic" id="id37">`</span></a>python
plotLargeBasins(basins, fieldNum=”Field1”, percentage=0.1,</p>
<blockquote>
<div><p>fldName=”figs”, savePNG=True, verbose=True)</p>
</div></blockquote>
<p><a href="#id38"><span class="problematic" id="id39">``</span></a><a href="#id40"><span class="problematic" id="id41">`</span></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ExoCcycle.plotHelper.plot_pdf_vs_sigmoid">
<span class="sig-prename descclassname"><span class="pre">ExoCcycle.plotHelper.</span></span><span class="sig-name descname"><span class="pre">plot_pdf_vs_sigmoid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_edge_diff_iqr_filtered</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">popt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigmoid_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/plotHelper.html#plot_pdf_vs_sigmoid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.plotHelper.plot_pdf_vs_sigmoid" title="Link to this definition">¶</a></dt>
<dd><p>Plot a fitted sigmoid against an empirical PDF, plus a histogram of the data.</p>
<dl class="simple">
<dt>This function mirrors your snippet by:</dt><dd><ol class="arabic simple">
<li><p>Mirroring the input data as <code class="docutils literal notranslate"><span class="pre">x_values</span> <span class="pre">=</span> <span class="pre">[+x,</span> <span class="pre">-x]</span></code> to enforce symmetry,</p></li>
<li><p>Plotting the <strong>normalized</strong> PDF and <strong>normalized</strong> sigmoid in the top subplot,</p></li>
<li><p>Plotting the <strong>raw</strong> PDF, a histogram of the mirrored data, and the <strong>raw</strong> sigmoid
in the bottom subplot.</p></li>
</ol>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_edge_diff_iqr_filtered</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">array-like</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">shape</span> <span class="pre">(N,)</span></code>) – One-sided data array (e.g., positive differences). The function mirrors this
array to construct <code class="docutils literal notranslate"><span class="pre">x_values</span> <span class="pre">=</span> <span class="pre">np.append(x,</span> <span class="pre">-x)</span></code> for plotting.</p></li>
<li><p><strong>pdf</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">array-like</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">shape</span> <span class="pre">(2N,)</span></code>) – Empirical probability density values corresponding <strong>one-to-one</strong> with the
mirrored <code class="docutils literal notranslate"><span class="pre">x_values</span></code> ordering used here (<code class="docutils literal notranslate"><span class="pre">[x,</span> <span class="pre">-x]</span></code> in that sequence).</p></li>
<li><p><strong>popt</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">sequence</span></code>) – Optimized parameters for the passed <code class="docutils literal notranslate"><span class="pre">sigmoid_fn</span></code> (e.g., from <code class="docutils literal notranslate"><span class="pre">scipy.optimize.curve_fit</span></code>).</p></li>
<li><p><strong>sigmoid_fn</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">callable</span></code>) – A callable with signature <code class="docutils literal notranslate"><span class="pre">sigmoid_fn(x,</span> <span class="pre">*popt)</span></code> that evaluates the sigmoid
at vector <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p></li>
<li><p><strong>bins</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <em>optional</em>) – Number of histogram bins for the data panel. Default is 30.</p></li>
<li><p><strong>title</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <em>optional</em>) – Figure-level title. Default None (no suptitle).</p></li>
<li><p><strong>show</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <em>optional</em>) – If True, call <code class="docutils literal notranslate"><span class="pre">plt.show()</span></code> at the end. Default True.</p></li>
<li><p><strong>save_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <em>optional</em>) – If provided, save the figure to this path (e.g., <code class="docutils literal notranslate"><span class="pre">&quot;figs/pdf_sigmoid.png&quot;</span></code>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>(fig, axes)</strong> – The created Matplotlib figure and array of axes (length 2).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The top panel normalizes both curves for a shape-only comparison:
<code class="docutils literal notranslate"><span class="pre">pdf</span> <span class="pre">/</span> <span class="pre">max(pdf)</span></code> and <code class="docutils literal notranslate"><span class="pre">sigmoid(x)/sigmoid(0)</span></code>.</p></li>
<li><p>The bottom panel compares raw magnitudes: empirical PDF, histogram,
and raw sigmoid evaluated on the mirrored grid.</p></li>
<li><p>Ensure <code class="docutils literal notranslate"><span class="pre">pdf</span></code> is aligned with the constructed mirrored <code class="docutils literal notranslate"><span class="pre">x_values</span></code>. If your
original PDF is defined on a different grid or order, resample/reorder before use.</p></li>
</ul>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Define a standard logistic sigmoid:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span><span class="w"> </span><span class="nf">sigmoid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">a</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">b</span><span class="o">*</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">c</span><span class="p">)))</span> <span class="o">+</span> <span class="n">d</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x_all</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_pos</span><span class="p">,</span> <span class="o">-</span><span class="n">x_pos</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">x_all</span><span class="o">/</span><span class="mf">0.8</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># toy Gaussian-shaped PDF on mirrored grid</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">popt</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>        <span class="c1"># toy params</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plot_pdf_vs_sigmoid</span><span class="p">(</span><span class="n">x_pos</span><span class="p">,</span> <span class="n">pdf</span><span class="p">,</span> <span class="n">popt</span><span class="p">,</span> <span class="n">sigmoid</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ExoCcycle.plotHelper.plot_quantile_transform_distribution">
<span class="sig-prename descclassname"><span class="pre">ExoCcycle.plotHelper.</span></span><span class="sig-name descname"><span class="pre">plot_quantile_transform_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qt_transformer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qt_diss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/plotHelper.html#plot_quantile_transform_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.plotHelper.plot_quantile_transform_distribution" title="Link to this definition">¶</a></dt>
<dd><p>Plot quantile transformation distributions for data vs. Gaussian (QT) domain.</p>
<p>This function visualizes how an input dataset maps between its native domain
and the quantile-transformed (Gaussianized) domain used in statistical weighting.
It generates two subplots:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Histogram of transformed values (QT domain)</p></li>
<li><p>Comparison between original and back-transformed (inverse QT) data</p></li>
</ol>
</div></blockquote>
<dl>
<dt>Args:</dt><dd><dl class="simple">
<dt>x_values (array-like):</dt><dd><p>Original data values to transform.</p>
</dd>
<dt>qt_transformer (object):</dt><dd><p>A fitted scikit-learn quantile transformer (e.g.,
<code class="docutils literal notranslate"><span class="pre">sklearn.preprocessing.QuantileTransformer</span></code>) or similar object with
<code class="docutils literal notranslate"><span class="pre">.transform</span></code> and <code class="docutils literal notranslate"><span class="pre">.inverse_transform</span></code> methods.</p>
</dd>
<dt>qt_diss (array-like, optional):</dt><dd><p>Already-transformed data (QT domain). If None, it is computed from <code class="docutils literal notranslate"><span class="pre">x_values</span></code>.</p>
</dd>
<dt>field_name (str, optional):</dt><dd><p>Optional field label for plot legends/titles.</p>
</dd>
<dt>bins (int, optional):</dt><dd><p>Number of bins for histograms. Defaults to 20.</p>
</dd>
<dt>show (bool, optional):</dt><dd><p>Whether to immediately show the plots using <code class="docutils literal notranslate"><span class="pre">plt.show()</span></code>. Defaults to True.</p>
</dd>
<dt>save_path (str, optional):</dt><dd><p>Path to save the figure (e.g., <code class="docutils literal notranslate"><span class="pre">&quot;figures/qt_transform_plot.png&quot;</span></code>). If None, the figure
is not saved.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>matplotlib.figure.Figure:</dt><dd><p>The created matplotlib figure instance.</p>
</dd>
</dl>
</dd>
<dt>Example:</dt><dd><p><a href="#id42"><span class="problematic" id="id43">``</span></a><a href="#id44"><span class="problematic" id="id45">`</span></a>python
from sklearn.preprocessing import QuantileTransformer
import numpy as np</p>
<p>qt = QuantileTransformer(output_distribution=’normal’)
x = np.random.lognormal(mean=0, sigma=1, size=5000)
qt.fit(x.reshape(-1, 1))
plot_quantile_transform_distribution(x, qt)
<a href="#id46"><span class="problematic" id="id47">``</span></a><a href="#id48"><span class="problematic" id="id49">`</span></a></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-ExoCcycle.utils">
<span id="exoccycle-utils-module"></span><h2>ExoCcycle.utils module<a class="headerlink" href="#module-ExoCcycle.utils" title="Link to this heading">¶</a></h2>
<p>Created on Tue Sep  6 15:20:00 2024</p>
<p>&#64;author: Matthew Bogumil</p>
<dl class="py class">
<dt class="sig sig-object py" id="ExoCcycle.utils.BasinsEA">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ExoCcycle.utils.</span></span><span class="sig-name descname"><span class="pre">BasinsEA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataDir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">body</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">region</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([[-180,</span> <span class="pre">-90],</span> <span class="pre">[180,</span> <span class="pre">90]])</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#BasinsEA"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.BasinsEA" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Basins is a class meant to construct basins and bathymetry properties
given a bathymetry model netCDF4.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.utils.BasinsEA.addField">
<span class="sig-name descname"><span class="pre">addField</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resolution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataGrid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameterUnit</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameterName</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#BasinsEA.addField"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.BasinsEA.addField" title="Link to this definition">¶</a></dt>
<dd><p>addField method is used to set a field to calculate edge weights with.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>resolution</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">FLOAT</span></code>) – Resolution of input data set. This value needs to be the same for all set fields.</p></li>
<li><p><strong>dataGrid</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">STRING</span></code>) – Directory to netCDF4 to be used in calculations.</p></li>
<li><p><strong>parameter</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">STRING</span></code>) – Name of parameter in netCDF4 to be used for edge weight calculations.</p></li>
<li><p><strong>parameterUnit</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">STRING</span></code>) – Unit of parameter.</p></li>
<li><p><strong>parameterName</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">STRING</span></code>) – Common name for parameter (e.g., bathymetry, PSU, Temperature, organism1)</p></li>
<li><p><strong>Re</strong><strong>(</strong><strong>defines</strong><strong>)</strong></p></li>
<li><p><strong>------------</strong></p></li>
<li><p><strong>self.Fields</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">DICTIONARY</span></code>) – Holds entries corresponding to fields</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.utils.BasinsEA.applyMergeBasinMethods">
<span class="sig-name descname"><span class="pre">applyMergeBasinMethods</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mergerID</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mergerPackage</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxBasinCnt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#BasinsEA.applyMergeBasinMethods"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.BasinsEA.applyMergeBasinMethods" title="Link to this definition">¶</a></dt>
<dd><p>applyMergeBasinMethods function takes a ExoCcycle basins object a
mergerID and mergerPackage to merge basins defined by a predetermined
merger strategy. Some of these have been define by the creators of
ExoCcycle, but every other strategy must be defined as shown below</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mergerID</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">INT</span></code>) – An ID that describes the basins merges to take place as described
in mergerPackage</p></li>
<li><p><strong>mergerPackage</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">DICTIONARY</span></code>) – <p>A dictionary that describes the general merger strategy and strategy
for a given mergerID. It can be constructed as follows. The following
package first merges basins that represent 0.1% then 0.5% of total
basin surface area into the closest basin bigger than 0.1% and 0.5%.
Next, if mergerID=0 then mergers0 will merger basin 0 with 0,8,9,10,
basin 1 with …, and basin 2 with …</p>
<blockquote>
<div><dl>
<dt>mergerPackage = {‘mergeSmallBasins’: {‘on’:True,</dt><dd><blockquote>
<div><p>’threshold’:np.array([.1,.5]),
‘thresholdMethod’:’%’,
‘mergeMethod’:’nearBasinEdge’},</p>
</div></blockquote>
<p>’mergerID’: np.array([0, 5, 10, 15, 20, 25]),
‘mergers0’:  {‘0’:[0,8,9,10], ‘1’:[…], ‘2’:[…] },
‘mergers5’:  {‘0’:[…], ‘1’:[…], ‘2’:[…] },
‘mergers…’:{‘0’:[…], ‘1’:[…], ‘2’:[…] }
}</p>
</dd>
</dl>
</div></blockquote>
</p></li>
<li><p><strong>maxBasinCnt</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">INT</span></code>) – Maximum number of basins to allow in a bathymetry
model. The default is 1e5.</p></li>
<li><p><strong>Redefine</strong></p></li>
<li><p><strong>-------</strong></p></li>
<li><p><strong>self</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">EXOCCYCLE</span> <span class="pre">OBJECT</span></code>) – Object that describes the connection of nodes into basins by
way of a community detection algorithm. Now with merged basins
as described by mergerID and mergerPackage.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.utils.BasinsEA.calculateBasinConnectivityParameters">
<span class="sig-name descname"><span class="pre">calculateBasinConnectivityParameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">binEdges</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disThres</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">444</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fieldNum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Field1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fldName</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'/home/bogumil/Documents/External_fids/ExoCcycle-workspace/ExoCcycle'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#BasinsEA.calculateBasinConnectivityParameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.BasinsEA.calculateBasinConnectivityParameters" title="Link to this definition">¶</a></dt>
<dd><p>calculateBasinConnectivityParameters method is used to calculate
basin connectivity parameters. The parameters are described in
the returned parameters section.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>binEdges</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">NUMPY</span> <span class="pre">LIST</span></code>, <em>optional</em>) – A numpy list of bin edges, in km, to calculate the bathymetry distribution
over. Note that anything deeper than the last bin edge will be defined within
the last bin. The default is None, but this is modified to
np.array([0, 0.1, 0.6, 1, 1.5, 2, 2.5, 3, 3.5, 4, 4.5, 5, 5.5, 6.5]) within
the code.</p></li>
<li><p><strong>disThres</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">FLOAT</span></code>, <em>optional</em>) – Value, in km, represents the distance threshold, away from
a basin boundary, which will be consider part of that basin
connection. The default value is 444.</p></li>
<li><p><strong>fieldNum</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">STRING</span></code>, <em>optional</em>) – Name of the field to be used. The default is “Field1”.</p></li>
<li><p><strong>fldName</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">STRING</span></code>) – Directory to save figures to. The default is os.getcwd().</p></li>
<li><p><strong>verbose</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">BOOLEAN</span></code>, <em>optional</em>) – Reports more information about process. The default is True.</p></li>
<li><p><strong>Redefined</strong></p></li>
<li><p><strong>--------</strong></p></li>
<li><p><strong>self.basinCnt</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">INT</span></code>) – Number of basins in model.</p></li>
<li><p><strong>self.basinConCnt</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">INT</span></code>) – (self.basinCnt^2-self.basinCnt)/2. This value corresponds to the number
of basin connections.</p></li>
<li><p><strong>self.validConCnt</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">INT</span></code>) – Number of valid connections between basins (i.e., where self.bathymetryConDist)
is not a vector of NaNs.</p></li>
<li><p><strong>self.connectingNodes</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">NUMPY</span> <span class="pre">ARRAY</span></code>) – self.basinConCnt length list of lists. Each list holds the set of node
IDs that correspond to a basin connection.</p></li>
<li><p><strong>self.connectiveBathy</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">NUMPY</span> <span class="pre">ARRAY</span></code>) – self.basinConCnt length list of lists. Each list holds the set of
bathymetry, in m, that correspond to a basin connection’s nodes.</p></li>
<li><p><strong>self.connectiveAreaW</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">NUMPY</span> <span class="pre">ARRAY</span></code>) – self.basinConCnt length list of lists. Each list holds the set of area
weights that correspond to a basin connection’s nodes.</p></li>
<li><p><strong>self.basinAreaConnection</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">NUMPY</span> <span class="pre">ARRAY</span></code>) – A self.basinCnt x self.basinCnt matrix that enumerate the connections
between basins. This is a useful book keeping attribute.</p></li>
<li><p><strong>self.basinConnectionWeight</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">NUMPY</span> <span class="pre">ARRAY</span></code>) – A self.basinCnt x self.basinCnt matrix holds weights describing how
well connected two basins are. The connection strength is calculated
based on connective bathymetry on a set of rules described within
the body of code.</p></li>
<li><p><strong>self.bathymetryConDist</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">NUMPY</span> <span class="pre">ARRAY</span></code>) – A self.basinCnt x self.basinCnt x (binEdges-1) matrix that holds area
weighted bathymetry distributions of connective bathymetry between
basins. Distributions sum to 100%.</p></li>
<li><p><strong>self.basinConnectionDefined</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">BOOLEAN</span></code>) – Set to positive to indicate basin connectivity parameters are calculated.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.utils.BasinsEA.calculateBasinParameters">
<span class="sig-name descname"><span class="pre">calculateBasinParameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">binEdges</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fieldNum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Field1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fldName</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'/home/bogumil/Documents/External_fids/ExoCcycle-workspace/ExoCcycle'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#BasinsEA.calculateBasinParameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.BasinsEA.calculateBasinParameters" title="Link to this definition">¶</a></dt>
<dd><p>calculateBasinParameters method will calculate basin bathymetry
distributions, area and ocean volume fractions for basin.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>binEdges</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">NUMPY</span> <span class="pre">LIST</span></code>, <em>optional</em>) – A numpy list of bin edges, in km, to calculate the bathymetry distribution
over. Note that anything deeper than the last bin edge will be defined within
the last bin. The default is None, but this is modified to
np.array([0, 0.1, 0.6, 1, 1.5, 2, 2.5, 3, 3.5, 4, 4.5, 5, 5.5, 6.5]) within
the code.</p></li>
<li><p><strong>fieldNum</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">STRING</span></code>, <em>optional</em>) – Name of the field to be used. The default is “Field1”.</p></li>
<li><p><strong>fldName</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">STRING</span></code>) – Directory to save figures to. The default is os.getcwd().</p></li>
<li><p><strong>verbose</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">BOOLEAN</span></code>, <em>optional</em>) – Reports more information about process. The default is True.</p></li>
<li><p><strong>Redefines</strong></p></li>
<li><p><strong>----------</strong></p></li>
<li><p><strong>self.BasinIDA</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">NUMPY</span> <span class="pre">ARRAY</span></code>) – An nx2n array of values corresponding to basin IDs. Location of no
basins are given a fill value of np.nan. The size of this arry depends
on input bathymetry models as well as user input self.reducedRes class
attribute.</p></li>
<li><p><strong>self.bathymetryAreaDistBasin</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">DICTIONARY</span></code>) – A dictionary with entries [“Basin0”, “Basin1”,…]. Each entry contains
a histogram of seafloor bathymetry with using the following bin edges:
0, 0.1, 0.6, 1, 1.5, 2, 2.5, 3, 3.5, 4, 4.5, 5, 5.5, 6.5, in km. Note
that this distribution is calculated with the exclusion of high latitude
distribution of seafloor depths. This is what is normally inputted into
the LOSCAR carbon cycle model.</p></li>
<li><p><strong>self.bathymetryVolFraction</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">DICTIONARY</span></code>) – A dictionary with entries [“Basin0”, “Basin1”,…]. Each entry contains
the precent basin volume, normalized to the volume of all ocean basins
(excluding the high latitude ocean volume).</p></li>
<li><p><strong>self.bathymetryAreaFraction</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">DICTIONARY</span></code>) – A dictionary with entries [“Basin0”, “Basin1”,…]. Each entry contains
the precent basin area, normalized to the total seafloor area (including
the high latitude area).</p></li>
<li><p><strong>self.bathymetryAreaDist_wHighlatG</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">NUMPY</span> <span class="pre">ARRAY</span></code>) – A dictionary with entries [“Basin0”, “Basin1”,…]. Each entry contains
a histogram of seafloor bathymetry with using the following bin edges:
0, 0.1, 0.6, 1, 1.5, 2, 2.5, 3, 3.5, 4, 4.5, 5, 5.5, 6.5, in km. Note
that this distribution is calculated with the inclusion of high latitude
distribution of seafloor depths. This is what is normally inputted into
the LOSCAR carbon cycle model.</p></li>
<li><p><strong>self.bathymetryAreaDistG</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">NUMPY</span> <span class="pre">ARRAY</span></code>) – A dictionary with entries [“Basin0”, “Basin1”,…]. Each entry contains
a histogram of seafloor bathymetry with using the following bin edges:
0, 0.1, 0.6, 1, 1.5, 2, 2.5, 3, 3.5, 4, 4.5, 5, 5.5, 6.5, in km. Note
that this distribution is calculated with the exclusion of high latitude
distribution of seafloor depths. This is what is normally inputted into
the LOSCAR carbon cycle model.</p></li>
<li><p><strong>self.binEdges</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">NUMPY</span> <span class="pre">LIST</span></code>) – A numpy list of bin edges, in km, to calculate the bathymetry distribution
over. Note that anything deeper than the last bin edge will be defined within
the last bin.</p></li>
<li><p><strong>self.BasinParametersDefined</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">BOOLEAN</span></code>) – Set to True to indicate that basin bathymetry parameters have been defined.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">None.</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.utils.BasinsEA.createCommunityNodeColors">
<span class="sig-name descname"><span class="pre">createCommunityNodeColors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#BasinsEA.createCommunityNodeColors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.BasinsEA.createCommunityNodeColors" title="Link to this definition">¶</a></dt>
<dd><p>createCommunityNodeColors method sets colors associated
with different community nodes (e.g., basins in this case).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>node_colors</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">PYTHON</span> <span class="pre">LIST</span></code>) – A list of hex code colors that correspond to a node’s
community.</p></li>
<li><p><strong>verbose</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">BOOLEAN</span></code>, <em>optional</em>) – Reports more information about process. The default is True.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.utils.BasinsEA.defineBasins">
<span class="sig-name descname"><span class="pre">defineBasins</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">detectionMethod</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'method':</span> <span class="pre">'Louvain',</span> <span class="pre">'minBasinCnt':</span> <span class="pre">40,</span> <span class="pre">'minBasinLargerThanSmallMergers':</span> <span class="pre">True,</span> <span class="pre">'resolution':</span> <span class="pre">1}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edgeWeightMethod</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'method':</span> <span class="pre">'useLogistic'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fieldMaskParameter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'usedField':</span> <span class="pre">None}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reducedRes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'factor':</span> <span class="pre">15,</span> <span class="pre">'on':</span> <span class="pre">False}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">read</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initiation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#BasinsEA.defineBasins"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.BasinsEA.defineBasins" title="Link to this definition">¶</a></dt>
<dd><p>defineBasins method will define basins with network analysis
using either the Girvan-Newman or Louvain algorithm to define
communities.</p>
<section id="parameter">
<h3>Parameter<a class="headerlink" href="#parameter" title="Link to this heading">¶</a></h3>
<dl>
<dt>detectionMethod<span class="classifier">DICTIONARY</span></dt><dd><p>Determines the implemented community detection algorithm and
other properties to use for community detection. This dictionary
has the following keys:</p>
<blockquote>
<div><dl class="simple">
<dt>method<span class="classifier">STRING</span></dt><dd><p>The options are “Girvan-Newman”, “Louvain”, or
“Louvain-Girvan-Newman”. The former is more
robust with low scalability and the latter are
practical but produces non-deterministic communities.
The default is “Louvain”.</p>
</dd>
<dt>resolution<span class="classifier">FLOAT</span></dt><dd><p>The resolution value to be used with the Louvain
community detection algorithm. Values greater than 1,
makes the algorithm favor smaller communities (more
communities). Values less than 1, makes the algorithm
favor larger communities (less communities). The default
is 1.</p>
</dd>
<dt>minBasinCnt<span class="classifier">INT</span></dt><dd><p>The minimum amount of basins the user chooses to define
for the given bathymetry model input.</p>
</dd>
<dt>ensembleSize<span class="classifier">INT</span></dt><dd><p>Number of community detection runs to use in the community
reduction step of a composite community detection.</p>
</dd>
<dt>minBasinLargerThanSmallMergers<span class="classifier">BOOLEAN</span></dt><dd><p>An option that requires the minBasinCnt variable to equal
to the number of merged basins that are larger than the
small basins merger options defined in a mergerPackage.</p>
</dd>
</dl>
</div></blockquote>
</dd>
<dt>edgeWeightMethod<span class="classifier">DICTIONARY</span></dt><dd><dl class="simple">
<dt>Determines the implemented edge weight scheme. Options are:</dt><dd><dl class="simple">
<dt>“useGravity”</dt><dd><p>No user input needed.</p>
</dd>
<dt>“useLogistic”</dt><dd><p>Choose lower and upper bound weights ‘S_at_lower’,
‘S_at_upper’ (between 0-1) and their correpsonding
data field values ‘factor_at_lower’, ‘factor_at_upper’
(in units of standard deviation) that will be used
to construct the logistic-like weighting curve.</p>
</dd>
<dt>“useQTGaussianSigmoid”</dt><dd><p>Working progress - useLogistic should produce similar
expected results.</p>
</dd>
<dt>“useQTGaussianShiftedGaussianWeightDistribution”</dt><dd><p>Choose ‘shortenFactor’ and ‘shiftFactor’ factor (in units
of standard deviation) that will be used to construct
the cumulative density function for this weighting scheme.</p>
</dd>
</dl>
</dd>
</dl>
</dd>
<dt>reducedRes<span class="classifier">DICTIONARY</span></dt><dd><p>Option to reduce the resolution of the basin definition
network calculation. Note that this should be turned
off when doing analysis, and only kept on for testing
purposes. The default is {“on”:False,”factor”:15}.</p>
</dd>
<dt>read<span class="classifier">BOOLEAN</span></dt><dd><p>An option to read basin definitions for a given
bathymetry model. The default is False.</p>
</dd>
<dt>write<span class="classifier">BOOLEAN</span></dt><dd><p>An option to write basin definitions for a given
bathymetry model. The default is False.</p>
</dd>
<dt>verbose<span class="classifier">BOOLEAN, optional</span></dt><dd><p>Reports more information about process. The default is True.</p>
</dd>
</dl>
</section>
<section id="define">
<h3>Define<a class="headerlink" href="#define" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>self.basinCnt<span class="classifier">INT</span></dt><dd><p>Number of basins in global bathymetry model.</p>
</dd>
<dt>self.basinDis<span class="classifier">NUMPY ARRAY</span></dt><dd><p>binCnt x basinCnt array of bathymetry distributions.</p>
</dd>
</dl>
<p>Structure:
i. Determine to create or read graph
Read graph</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>read graph</p></li>
</ol>
</div></blockquote>
<dl>
<dt>Create graph</dt><dd><ol class="arabic">
<li><p>Reduce resolution and flatten: bathymetry, latitude, longitude</p></li>
<li><dl class="simple">
<dt>Create EA grid of points (for interpolation): eaNodes(…)</dt><dd><ul class="simple">
<li><p>Creates Class object</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Reduce resolution of EAinput data: simplifyNetCDF(…)</dt><dd><ul class="simple">
<li><p>Creates temp tempSimp.nc</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Iterpolate temp file to EA grid points: eaPoint.interp2IrregularGrid(…)</dt><dd><ul class="simple">
<li><p>Replaces temp tempSimp.nc</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Remove missing data from EA grid class object</dt><dd><ul class="simple">
<li><p>Updates self.eaPoint</p></li>
<li><p>Changes: Need to make sure either 1) all data is represented each point or 2) have some locations represented with only some data</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Create dictionary holding: lat, lon, parameter, area weight</dt><dd><ul class="simple">
<li><p>Changes: can be made to hold additional parameters</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Create graph and add node attributes</dt><dd><ul class="simple">
<li><p>Changes: add inner-loop for more attributes for additional fields</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Create array of node differences (at node edges)</dt><dd><ul class="simple">
<li><p>Changes: add inner-loop for additional fields</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Calculate statistics difference array</dt><dd><ul class="simple">
<li><p>Changes: add created attributes to self.Fields[“Fieldi”]</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>Iterate over nodes
i. Iterate over node edges (defined with eaNodes object)</p>
<blockquote>
<div><ol class="upperroman simple">
<li><dl class="simple">
<dt>Calculate and assign weight</dt><dd><ul class="simple">
<li><p>Changes: calculate multiple weights combined them (add, subtract, product)</p></li>
</ul>
</dd>
</dl>
</li>
</ol>
</div></blockquote>
</li>
</ol>
</dd>
<dt>Create a class for each of the methods</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>Initialize for variable</dt><dd><ul>
<li><p>calculate statistics, QT, logistic function, parameters, ect</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Method of function</dt><dd><ul>
<li><p>weight = getwWight(value1, value2)</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
<p>self.Fields[“MultipleFields”] = False;
self.Fields[“FieldCnt”] = 1;
self.Fields[“Field1”]
self.Fields[“usedFields”]</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.utils.BasinsEA.findCommunities">
<span class="sig-name descname"><span class="pre">findCommunities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">detectionMethod</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Louvain'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minBasinCnt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minBasinLargerThanSmallMergers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#BasinsEA.findCommunities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.BasinsEA.findCommunities" title="Link to this definition">¶</a></dt>
<dd><p>findCommunities uses the Girvan-Newman or Louvain community
detection algorithm to determine communities of nodes (basins).
Then nodes of similar basins are given a basinID.</p>
<section id="id50">
<h3>Parameter<a class="headerlink" href="#id50" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>detectionMethod<span class="classifier">DICTIONARY</span></dt><dd><p>A dictionary of defined detection methods.</p>
</dd>
<dt>method<span class="classifier">STRING</span></dt><dd><p>Determines the implemented community detection algorithm.
The options are either Girvan-Newman or Louvain. The former
is more robust with low scalability and the latter is practical
but produces non-deterministic communities. The default is
Louvain.</p>
</dd>
<dt>minBasinCnt<span class="classifier">INT</span></dt><dd><p>The minimum amount of basins the user chooses to define
for the given bathymetry model input.</p>
</dd>
<dt>minBasinLargerThanSmallMergers<span class="classifier">BOOLEAN</span></dt><dd><p>An option that requires the minBasinCnt variable to equal
to the number of merged basins that are larger than the
small basins merger options defined in a mergerPackage.</p>
</dd>
<dt>resolution<span class="classifier">FLOAT</span></dt><dd><p>The resolution value to be used with the Louvain community
detection algorithm. Values greater than 1, makes the algorithm
favor smaller communities (more communities). Values less than
1, makes the algorithm favor larger communities (less communities).
The default is 1.</p>
</dd>
</dl>
</section>
<section id="re-defines">
<h3>(Re)defines<a class="headerlink" href="#re-defines" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>self.communitiesFinal<span class="classifier">LIST</span></dt><dd><p>Python list of dictionaries, where each entry corresponds to community
i, and the dictionary at entry i contains node indices within that
community i.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">rtype<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">None.</span></code></p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.utils.BasinsEA.getBasinSize">
<span class="sig-name descname"><span class="pre">getBasinSize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fraction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#BasinsEA.getBasinSize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.BasinsEA.getBasinSize" title="Link to this definition">¶</a></dt>
<dd><p>getBasinSize returns the surface area of each basin
in either absolute m2 units or percentage of total
surface area of graph network.</p>
<section id="id51">
<h3>Parameter<a class="headerlink" href="#id51" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>fraction<span class="classifier">BOOLEAN</span></dt><dd><p>Option to return percentage of total surface
area covered by each basin.</p>
</dd>
<dt>Threshold<span class="classifier">FLOAT</span></dt><dd><p>Threshold value to define small vs large basins.
If fraction is true, then this must be a fraction
value as well. Otherwise set to absolute m2 value.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.utils.BasinsEA.getFields">
<span class="sig-name descname"><span class="pre">getFields</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">usedFields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#BasinsEA.getFields"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.BasinsEA.getFields" title="Link to this definition">¶</a></dt>
<dd><p>getFields method is used to output the information of all fields stored
within the BasinsEA object.</p>
<section id="id52">
<h3>Parameter<a class="headerlink" href="#id52" title="Link to this heading">¶</a></h3>
<p>Option to only plot the fields being used in the calculation of weights
and communities.</p>
<dl class="field-list simple">
<dt class="field-odd">rtype<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">None.</span></code></p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.utils.BasinsEA.interp2regularGrid">
<span class="sig-name descname"><span class="pre">interp2regularGrid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataIrregular</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">propertyName</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'basinID'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#BasinsEA.interp2regularGrid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.BasinsEA.interp2regularGrid" title="Link to this definition">¶</a></dt>
<dd><p>interp2regularGrid is a method used to interpolate
equal area spaced nodes properties to a equal degree spaced
grid.</p>
<p>GMT version using nearest neighbor interpolation via nearneighbor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataIrregular</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">NUMPY</span> <span class="pre">ARRAY</span></code>) – Equal area grid in a 3xn array with columns of lat, lon,
and node property.</p></li>
<li><p><strong>mask</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">NUMPY</span> <span class="pre">ARRAY</span></code>) – Mask to apply to interpolated grid.</p></li>
<li><p><strong>propertyName</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">STRING</span></code>) – Name of property stored in graph.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.utils.BasinsEA.interp2regularGrid_python">
<span class="sig-name descname"><span class="pre">interp2regularGrid_python</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataIrregular</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#BasinsEA.interp2regularGrid_python"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.BasinsEA.interp2regularGrid_python" title="Link to this definition">¶</a></dt>
<dd><p>interp2regularGrid method is used to interpolate data to
a regular grid given an input of irregular spaced data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataIrregular</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">NUMPY</span> <span class="pre">ARRAY</span></code>) – 3XN numpy array with columns of longitude, latitude, magnitude.
The default is None. This will make the function define the
dataIrregular variable with basinIDs.</p></li>
<li><p><strong>mask</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">STRING</span></code>) – The path to a netCDF4 file that can be used to mask the result
of interpolation. The default is None.</p></li>
<li><p><strong>(</strong><strong>Re</strong><strong>)</strong><strong>define</strong></p></li>
<li><p><strong>-----------</strong></p></li>
<li><p><strong>self.BasinIDA</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">NUMPY</span> <span class="pre">ARRAY</span></code>) – A 2nxn array that hold basinID for each corresponding entry in
self.lat and self.lon.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.utils.BasinsEA.mergeBasins">
<span class="sig-name descname"><span class="pre">mergeBasins</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">basinID1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basinID2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#BasinsEA.mergeBasins"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.BasinsEA.mergeBasins" title="Link to this definition">¶</a></dt>
<dd><p>mergeBasins method will merge basins with basin ID of basinID2
to basins with ID basinID1. The resulting basin network is then
rewitten to the original, overriding the original basinID network.
Note that there is no need to reread the basin network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>basinID1</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">INT</span></code>) – Basin ID to absorb basinID2.</p></li>
<li><p><strong>basinID2</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">INT</span></code>, or <code class="xref py py-class docutils literal notranslate"><span class="pre">LIST</span> <span class="pre">OF</span> <span class="pre">INT</span></code>) – Basin ID(s) to be absorbed by basinID1.</p></li>
<li><p><strong>write</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">BOOLEAN</span></code>) – An option to write over the original network. The default is False.</p></li>
<li><p><strong>Re</strong><strong>(</strong><strong>defines</strong><strong>)</strong></p></li>
<li><p><strong>------------</strong></p></li>
<li><p><strong>attribute.</strong> (<em>self.G's basinID node</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.utils.BasinsEA.mergeSmallBasins">
<span class="sig-name descname"><span class="pre">mergeSmallBasins</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">threshold</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresholdMethod</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mergeMethod</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#BasinsEA.mergeSmallBasins"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.BasinsEA.mergeSmallBasins" title="Link to this definition">¶</a></dt>
<dd><p>mergeSmallBasins method will merge basins below some threshold
surface area with the closest basins of above that same threshold.
The resulting basin network is then rewitten to the original,
overriding the original basinID network. Note that there is no
need to reread the basin network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>threshold</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">FLOAT</span></code>) – Basins smaller than this threshold, in [m2] or [%] of total
seafloor area will be merged with the closest basin above
this threshold in size.</p></li>
<li><p><strong>thresholdMethod</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">STRING</span></code>) – A string that defines the input type for threshold. This should
either be set to ‘m2’ or ‘%’.</p></li>
<li><p><strong>mergeMethod</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">STRING</span></code>) – A string that defines the method to merge small basins with larger
basins. This can either be set to ‘centroid’ or ‘nearBasinEdge’.
‘centroid’ will merge the small basin with nearest centroid of a
large basin. ‘nearBasinEdge’ will compare the small basin centroid
with the distance to all nodes. The small basin will then be assigned
the same basin ID as the closest node part of a large basin.</p></li>
<li><p><strong>write</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">BOOLEAN</span></code>) – An option to write over the original network. The default is False.</p></li>
<li><p><strong>Re</strong><strong>(</strong><strong>defines</strong><strong>)</strong></p></li>
<li><p><strong>------------</strong></p></li>
<li><p><strong>attribute.</strong> (<em>self.G's basinID node</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.utils.BasinsEA.mergeSmallestConnection">
<span class="sig-name descname"><span class="pre">mergeSmallestConnection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">maxBasinCnt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#BasinsEA.mergeSmallestConnection"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.BasinsEA.mergeSmallestConnection" title="Link to this definition">¶</a></dt>
<dd><p>mergeSmallestConnection merges smallest basins and strongest
connected basins with one another until maxBasinCnt number
of basins exist.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>verbose</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">BOOLEAN</span></code>, <em>optional</em>) – Reports more information about process. The default is True.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.utils.BasinsEA.orderBasins">
<span class="sig-name descname"><span class="pre">orderBasins</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#BasinsEA.orderBasins"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.BasinsEA.orderBasins" title="Link to this definition">¶</a></dt>
<dd><p>orderBasins method will reorder the basin IDs in accordance with
some input list.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">LIST</span></code>) – List of basin IDs, where the entry’s index corresponds to new
basinID. The value of the entry corresponds to the current basinID.
For example, this might look like [2,0,1], meaning basin2-&gt;basin0,
basin0-&gt;basin1, and basin1-&gt;basin2.</p></li>
<li><p><strong>write</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">BOOLEAN</span></code>) – An option to write over the original network. The default is False.</p></li>
<li><p><strong>Re</strong><strong>(</strong><strong>defines</strong><strong>)</strong></p></li>
<li><p><strong>------------</strong></p></li>
<li><p><strong>attribute.</strong> (<em>self.G's basinID node</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.utils.BasinsEA.plotBasinConnections">
<span class="sig-name descname"><span class="pre">plotBasinConnections</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binEdges</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fieldNum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Field1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fldName</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'/home/bogumil/Documents/External_fids/ExoCcycle-workspace/ExoCcycle'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savePNG</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveSVG</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fidName</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'BasinConnections.png'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#BasinsEA.plotBasinConnections"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.BasinsEA.plotBasinConnections" title="Link to this definition">¶</a></dt>
<dd><p>plotBasinConnections is used to plot results calculating from
running the method calculateBasinConnectivityParameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pos</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">NUMPY</span> <span class="pre">ARRAY</span></code>) – An nx2 array with columns of latitude and longitude, in degrees. This
array should represent the locations of basin nodes.</p></li>
<li><p><strong>binEdges</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">NUMPY</span> <span class="pre">LIST</span></code>, <em>optional</em>) – A numpy list of bin edges, in km, to calculate the bathymetry distribution
over. Note that anything deeper than the last bin edge will be defined within
the last bin. The default is None, but this is modified to
np.array([0, 0.1, 0.6, 1, 1.5, 2, 2.5, 3, 3.5, 4, 4.5, 5, 5.5, 6.5]) within
the code.</p></li>
<li><p><strong>fieldNum</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">STRING</span></code>, <em>optional</em>) – Name of the field to be used. The default is “Field1”.</p></li>
<li><p><strong>fldName</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">STRING</span></code>) – Directory to save figures to. The default is os.getcwd().</p></li>
<li><p><strong>savePNG</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">BOOLEAN</span></code>) – An option to save an PNG output. The default is False.</p></li>
<li><p><strong>saveSVG</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">BOOLEAN</span></code>) – An option to save an SVG output. The default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">None.</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.utils.BasinsEA.reportEvaluationMetrics">
<span class="sig-name descname"><span class="pre">reportEvaluationMetrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">returnText</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Not</span> <span class="pre">Recorded'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ensembleSize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Not</span> <span class="pre">Recorded'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Not</span> <span class="pre">Recorded'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#BasinsEA.reportEvaluationMetrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.BasinsEA.reportEvaluationMetrics" title="Link to this definition">¶</a></dt>
<dd><p>reportEvaluationMetrics reports evaluation metrics
for the quality of communities detected.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>returnText</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">BOOLEAN</span></code>) – Option to return a string of evaluation metrics
that is useful for outputing to commandline or
reporting to log text file.</p></li>
<li><p><strong>resolution</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">FLOAT</span></code>) – Resolution of the field. The default is “Not Recorded”.</p></li>
<li><p><strong>ensembleSize</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">INT</span></code>) – The size of the ensemble used for the reduction step.
The default is “Not Recorded”.</p></li>
<li><p><strong>distance_threshold</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">FLOAT</span></code>) – Distance threshold used for ensemble merge.
The default is “Not Recorded”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">DICTIONARY</span></code> – A set of evaluation metrics</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">STRING</span></code> – A set of evaluation metrics</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.utils.BasinsEA.saveBasinNetwork">
<span class="sig-name descname"><span class="pre">saveBasinNetwork</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#BasinsEA.saveBasinNetwork"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.BasinsEA.saveBasinNetwork" title="Link to this definition">¶</a></dt>
<dd><p>saveBasinNetwork method will overwrite the original basinID network
file.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">None.</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.utils.BasinsEA.saveCcycleParameter">
<span class="sig-name descname"><span class="pre">saveCcycleParameter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fieldNum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Field1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#BasinsEA.saveCcycleParameter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.BasinsEA.saveCcycleParameter" title="Link to this definition">¶</a></dt>
<dd><p>saveCcycleParameter method create a new netCDF4 containing
the original bathymetry model, areaweights, and other global
bathymetry parameters. Additionally, the new netCDF4 will
contain a basinID array as well as bathymetry distributions,
area and ocean water volume fractions for those basins.</p>
<p>This method produces a netCDF4 that contains two groups
(CycleParms and Arrays). These groups might look like the
following for a global ocean system that has 3 basins:</p>
<dl class="simple">
<dt>group /basinConnections:</dt><dd><p>dimensions(sizes): binEdges(13), BasinID(3)
variables(dimensions):
basinConnectionBathymetry(BasinID, BasinID, binEdges)</p>
</dd>
<dt>group /CycleParms:</dt><dd><p>dimensions(sizes): binEdges(13), BasinID(3)
variables(dimensions):
float32 binEdges(binEdges),
float64 Global-whighlat(binEdges),
float64 Global(binEdges),
float64 basin-0(binEdges),
float64 basin-1(binEdges),
float64 basin-2(binEdges),
float32 BasinID(BasinID),
float64 fdvol(BasinID),
float64 fanoc(BasinID),
float64 highlatlat(),
float64 highlatA(),
float64 AOC()
float64 VOC(),
groups:</p>
</dd>
<dt>group /Arrays:</dt><dd><p>dimensions(sizes): lat(180), lon(360)
variables(dimensions):
float32 lat(lat),
float32 lon(lon),
float64 bathymetry(lat, lon),
float64 basinIDArray(lat, lon),
float64 areaWeights(lat)
groups:</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>verbose</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">BOOLEAN</span></code>, <em>optional</em>) – Reports more information about process. The default is True.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">None.</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.utils.BasinsEA.setEdgeParameter">
<span class="sig-name descname"><span class="pre">setEdgeParameter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">netCDF4Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">readParm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edgeParaOpt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#BasinsEA.setEdgeParameter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.BasinsEA.setEdgeParameter" title="Link to this definition">¶</a></dt>
<dd><p>setEdgeParameter method is used to define the edge parameter
that will be used with the community detection algorithm.</p>
<section id="id53">
<h3>Parameter<a class="headerlink" href="#id53" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>netCDF4Path<span class="classifier">STRING</span></dt><dd><p>A string path to a netCDF4 that contains the data to be
used for and edge connections.</p>
</dd>
<dt>readParm<span class="classifier">STRING</span></dt><dd><p>The name of the parameter to use in the read netCDF4.</p>
</dd>
<dt>edgeParaOpt<span class="classifier">DICTIONARY</span></dt><dd><p>A dictionary that might contain entries defining additional
operations to take place after loading a netCDF4 to use for
the edge parameter. Options currently include ‘flipud’ and
‘fliplr’.</p>
</dd>
<dt>resample<span class="classifier">BOOLEAN</span></dt><dd><p>An option to resample the edge parameter grid. The default
is False.</p>
</dd>
<dt>self.resolution<span class="classifier">FLOAT</span></dt><dd><p>Resolution, in degree, for the in Basins pbject analysis.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.utils.BasinsEA.setFieldMask">
<span class="sig-name descname"><span class="pre">setFieldMask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fieldMaskParameter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'usedField':</span> <span class="pre">None}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bathymetry'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#BasinsEA.setFieldMask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.BasinsEA.setFieldMask" title="Link to this definition">¶</a></dt>
<dd><p>setFieldMask is a method used to set a mask for the
communities once they are interpolated back to an
equal-spaced latitude-longitude array.</p>
<section id="id54">
<h3>Parameter<a class="headerlink" href="#id54" title="Link to this heading">¶</a></h3>
<dl>
<dt>fieldMaskParameter<span class="classifier">DICTIONARY</span></dt><dd><p>A set of parameters used to determine the field
mask used.</p>
<blockquote>
<div><dl class="simple">
<dt>“usedField”<span class="classifier">INT, None</span></dt><dd><p>Set to None to use bathymetry map load
when initiating BasinsEA class. Set to
an integer 0-n to assign the values with
usedFields.</p>
</dd>
<dt>“fliprl”<span class="classifier">False</span></dt><dd><p>An option to flip the input mask along
longitude 0 values (prime meridian).</p>
</dd>
<dt>“flipud”<span class="classifier">True</span></dt><dd><p>An option to flip the input mask along
latitude 0 values (equator).</p>
</dd>
</dl>
</div></blockquote>
</dd>
<dt>usedField<span class="classifier">INT</span></dt><dd><p>An integer value associated with the field to be
used for masking. Note that this argument should
be assigned the index of the used field vector
self.Fields[‘usedFields’]</p>
</dd>
<dt>Field<span class="classifier">NUMPY ARRAY</span></dt><dd><p>An array of values with np.nan corresponding to
values to be masked out. The default is ‘bathymetry’,
and forces the mask to be initial set to class’
initialized array (e.g., etopo).</p>
</dd>
</dl>
<p>fliprl : BOOLEAN</p>
<p>flipud : BOOLEAN</p>
</section>
<section id="re-define">
<h3>Re(define)<a class="headerlink" href="#re-define" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>self.maskValue<span class="classifier">NUMPY ARRAY</span></dt><dd><p>Masked values represented with non-np.nan values.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.utils.BasinsEA.simplifyNetCDF">
<span class="sig-name descname"><span class="pre">simplifyNetCDF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputPath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'path/file1.nc'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputPath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'~/file2.nc'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameterIn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bathymetry'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameterOut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'z'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#BasinsEA.simplifyNetCDF"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.BasinsEA.simplifyNetCDF" title="Link to this definition">¶</a></dt>
<dd><p>simplifyNetCDF method reads a NetCDF4 file and writes a new NetCDF4 file
with only lat, lon, and bathymetry variables.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_path</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">STRING</span></code>) – Path to the input NetCDF4 file. The default
is “path/file1.nc”.</p></li>
<li><p><strong>output_path</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">STRING</span></code>) – Path to save the new NetCDF4 file. The default
is “path/file2.nc”</p></li>
<li><p><strong>parameterIn</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">STRING</span></code>) – Name of parameter in the netCDF4 that
will be copied. The default is “bathymetry”.</p></li>
<li><p><strong>parameterOut</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">STRING</span></code>) – Name of new parameter in the copied netCDF4.
This should be a standard name, so gmt netcdf
operations are simple. The default is “z”.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.utils.BasinsEA.useFields">
<span class="sig-name descname"><span class="pre">useFields</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fieldList</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array(['Field1'],</span> <span class="pre">dtype='&lt;U6')</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#BasinsEA.useFields"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.BasinsEA.useFields" title="Link to this definition">¶</a></dt>
<dd><p>useFields method is used to define which fields will be used to
calculate edge weights with.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fieldList</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">NUMPY</span> <span class="pre">LIST</span></code>) – A list of strings. The default is [“Field1”].</p></li>
<li><p><strong>Re</strong><strong>(</strong><strong>defines</strong><strong>)</strong></p></li>
<li><p><strong>------------</strong></p></li>
<li><p><strong>self.Fields</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">DICTIONARY</span></code>) – Holds entries corresponding to fields</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.utils.BasinsEA.visualizeCommunities">
<span class="sig-name descname"><span class="pre">visualizeCommunities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cmapOpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'cbar-range':</span> <span class="pre">[0,</span> <span class="pre">1],</span> <span class="pre">'cbar-title':</span> <span class="pre">'cbar-title',</span> <span class="pre">'cmap':</span> <span class="pre">'viridis'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pltOpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'connectorlinewidth':</span> <span class="pre">1,</span> <span class="pre">'nodesize':</span> <span class="pre">5,</span> <span class="pre">'plotTitle':</span> <span class="pre">'',</span> <span class="pre">'plotZeroContour':</span> <span class="pre">False,</span> <span class="pre">'projection':</span> <span class="pre">'Mollweide',</span> <span class="pre">'valueType':</span> <span class="pre">'Bathymetry',</span> <span class="pre">'valueUnits':</span> <span class="pre">'m'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">draw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'bathymetry':</span> <span class="pre">True,</span> <span class="pre">'coastlines':</span> <span class="pre">True,</span> <span class="pre">'connectors':</span> <span class="pre">True,</span> <span class="pre">'gridlines':</span> <span class="pre">True,</span> <span class="pre">'nodes':</span> <span class="pre">True}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveSVG</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savePNG</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#BasinsEA.visualizeCommunities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.BasinsEA.visualizeCommunities" title="Link to this definition">¶</a></dt>
<dd><p>visualizeCommunities method creates a global map of nodes
and connectings. The nodes communities are defined with
different colors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cmapOpts</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">DICTIONARY</span></code>) – A set of options to format the color map and bar for the plot</p></li>
<li><p><strong>pltOpts</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">DICTIONARY</span></code>) – A set of options to format the plot</p></li>
<li><p><strong>pltOpts</strong> – A set of options to display different aspects of a basin.</p></li>
<li><p><strong>saveSVG</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">BOOLEAN</span></code>) – An option to save an SVG output. The default is False.</p></li>
<li><p><strong>savePNG</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">BOOLEAN</span></code>) – An option to save an PNG output. The default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">None.</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ExoCcycle.utils.BasinsSynth">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ExoCcycle.utils.</span></span><span class="sig-name descname"><span class="pre">BasinsSynth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataDir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#BasinsSynth"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.BasinsSynth" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Build synthetic ocean basins and bathymetry parameters for carbon-cycle models.</p>
<p>This class organizes inputs and derived properties for a <strong>synthetic</strong>
bathymetry, including:
- Global/basin bathymetry distributions over depth bins,
- Area/volume fractions by basin and a high-latitude box,
- Optional basin-to-basin connectivity distributions,
- A writer to persist parameters to a netCDF4 file structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataDir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – Directory where outputs will be written (e.g., the netCDF file).</p></li>
<li><p><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – Output file name to create inside <code class="docutils literal notranslate"><span class="pre">dataDir</span></code>.</p></li>
<li><p><strong>radius</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – Planetary radius in meters used by the synthetic model.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="ExoCcycle.utils.BasinsSynth.dataDir">
<span class="sig-name descname"><span class="pre">dataDir</span></span><a class="headerlink" href="#ExoCcycle.utils.BasinsSynth.dataDir" title="Link to this definition">¶</a></dt>
<dd><p>Output directory (as passed to <code class="docutils literal notranslate"><span class="pre">__init__</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ExoCcycle.utils.BasinsSynth.filename">
<span class="sig-name descname"><span class="pre">filename</span></span><a class="headerlink" href="#ExoCcycle.utils.BasinsSynth.filename" title="Link to this definition">¶</a></dt>
<dd><p>Output file name (as passed to <code class="docutils literal notranslate"><span class="pre">__init__</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ExoCcycle.utils.BasinsSynth.radius">
<span class="sig-name descname"><span class="pre">radius</span></span><a class="headerlink" href="#ExoCcycle.utils.BasinsSynth.radius" title="Link to this definition">¶</a></dt>
<dd><p>Planet radius in meters.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ExoCcycle.utils.BasinsSynth.basinConnectionDefined">
<span class="sig-name descname"><span class="pre">basinConnectionDefined</span></span><a class="headerlink" href="#ExoCcycle.utils.BasinsSynth.basinConnectionDefined" title="Link to this definition">¶</a></dt>
<dd><p>Flag indicating whether basin connectivity parameters have been defined.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ExoCcycle.utils.BasinsSynth.BasinParametersDefined">
<span class="sig-name descname"><span class="pre">BasinParametersDefined</span></span><a class="headerlink" href="#ExoCcycle.utils.BasinsSynth.BasinParametersDefined" title="Link to this definition">¶</a></dt>
<dd><p>Flag indicating whether basin/bathymetry parameters have been defined.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">#</span> <span class="pre">Set</span> <span class="pre">by</span> <span class="pre">:meth:`defineBasinParameters`</span></span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ExoCcycle.utils.BasinsSynth.bathymetryVolFraction">
<span class="sig-name descname"><span class="pre">bathymetryVolFraction</span></span><a class="headerlink" href="#ExoCcycle.utils.BasinsSynth.bathymetryVolFraction" title="Link to this definition">¶</a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">{'Basin0':</span> <span class="pre">float,</span> <span class="pre">'Basin1':</span> <span class="pre">float,</span> <span class="pre">...}</span></code> volume fractions (decimal)
that sum to 1 across basins (excluding the high-latitude box).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ExoCcycle.utils.BasinsSynth.bathymetryAreaFraction">
<span class="sig-name descname"><span class="pre">bathymetryAreaFraction</span></span><a class="headerlink" href="#ExoCcycle.utils.BasinsSynth.bathymetryAreaFraction" title="Link to this definition">¶</a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">{'Basin0':</span> <span class="pre">float,</span> <span class="pre">'Basin1':</span> <span class="pre">float,</span> <span class="pre">...}</span></code> area fractions (decimal)
that sum to <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">-</span> <span class="pre">highlatA/AOC</span></code> across basins.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ExoCcycle.utils.BasinsSynth.bathymetryAreaDistBasin">
<span class="sig-name descname"><span class="pre">bathymetryAreaDistBasin</span></span><a class="headerlink" href="#ExoCcycle.utils.BasinsSynth.bathymetryAreaDistBasin" title="Link to this definition">¶</a></dt>
<dd><p>Per-basin bathymetry histograms over <code class="docutils literal notranslate"><span class="pre">binEdges</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ExoCcycle.utils.BasinsSynth.bathymetryAreaDist_wHighlatG">
<span class="sig-name descname"><span class="pre">bathymetryAreaDist_wHighlatG</span></span><a class="headerlink" href="#ExoCcycle.utils.BasinsSynth.bathymetryAreaDist_wHighlatG" title="Link to this definition">¶</a></dt>
<dd><p>Global bathymetry histogram including the high-latitude region.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">array_like</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ExoCcycle.utils.BasinsSynth.bathymetryAreaDistG">
<span class="sig-name descname"><span class="pre">bathymetryAreaDistG</span></span><a class="headerlink" href="#ExoCcycle.utils.BasinsSynth.bathymetryAreaDistG" title="Link to this definition">¶</a></dt>
<dd><p>Global bathymetry histogram excluding the high-latitude region.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">array_like</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ExoCcycle.utils.BasinsSynth.binEdges">
<span class="sig-name descname"><span class="pre">binEdges</span></span><a class="headerlink" href="#ExoCcycle.utils.BasinsSynth.binEdges" title="Link to this definition">¶</a></dt>
<dd><p>Depth bin edges in kilometers (length <code class="docutils literal notranslate"><span class="pre">n+1</span></code> for <code class="docutils literal notranslate"><span class="pre">n</span></code> bins).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">array_like</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ExoCcycle.utils.BasinsSynth.AOC">
<span class="sig-name descname"><span class="pre">AOC</span></span><a class="headerlink" href="#ExoCcycle.utils.BasinsSynth.AOC" title="Link to this definition">¶</a></dt>
<dd><p>Total seafloor area (m²).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ExoCcycle.utils.BasinsSynth.VOC">
<span class="sig-name descname"><span class="pre">VOC</span></span><a class="headerlink" href="#ExoCcycle.utils.BasinsSynth.VOC" title="Link to this definition">¶</a></dt>
<dd><p>Total ocean volume (m³).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ExoCcycle.utils.BasinsSynth.highlatA">
<span class="sig-name descname"><span class="pre">highlatA</span></span><a class="headerlink" href="#ExoCcycle.utils.BasinsSynth.highlatA" title="Link to this definition">¶</a></dt>
<dd><p>Area of the high-latitude box (m²).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ExoCcycle.utils.BasinsSynth.highlatlat">
<span class="sig-name descname"><span class="pre">highlatlat</span></span><a class="headerlink" href="#ExoCcycle.utils.BasinsSynth.highlatlat" title="Link to this definition">¶</a></dt>
<dd><p>Latitude threshold used to define the high-latitude region; <code class="docutils literal notranslate"><span class="pre">None</span></code> for
synthetic models.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a> or <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">#</span> <span class="pre">Set</span> <span class="pre">by</span> <span class="pre">:meth:`defineBasinConnectivityParameters`</span></span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ExoCcycle.utils.BasinsSynth.bathymetryConDist">
<span class="sig-name descname"><span class="pre">bathymetryConDist</span></span><a class="headerlink" href="#ExoCcycle.utils.BasinsSynth.bathymetryConDist" title="Link to this definition">¶</a></dt>
<dd><p>3-D array (<code class="docutils literal notranslate"><span class="pre">BasinCnt</span> <span class="pre">×</span> <span class="pre">BasinCnt</span> <span class="pre">×</span> <span class="pre">(len(binEdges)-1)</span></code>) of
connectivity bathymetry histograms (%).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Notes</p>
<p>The class focuses on parameter bookkeeping for idealized/synthetic
bathymetry rather than generating gridded fields.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.utils.BasinsSynth.defineBasinConnectivityParameters">
<span class="sig-name descname"><span class="pre">defineBasinConnectivityParameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">BasinCnt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Distribution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#BasinsSynth.defineBasinConnectivityParameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.BasinsSynth.defineBasinConnectivityParameters" title="Link to this definition">¶</a></dt>
<dd><p>Define basin-to-basin connectivity bathymetry distributions.</p>
<p>For synthetic models, the connectivity distributions are initialized from
a common global shape (<code class="docutils literal notranslate"><span class="pre">Distribution</span></code>) and stored in a 3-D array with
basin-pair slices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>BasinCnt</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <em>optional</em>) – Number of basins (sets the first two dimensions). Default <code class="docutils literal notranslate"><span class="pre">3</span></code>.</p></li>
<li><p><strong>Distribution</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">array_like</span></code>, <em>optional</em>) – Length-<code class="docutils literal notranslate"><span class="pre">n</span></code> bathymetry histogram (%) over the <code class="docutils literal notranslate"><span class="pre">n</span></code> intervals defined by
the previously established <code class="docutils literal notranslate"><span class="pre">binEdges</span></code>. Sums to 100.</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, print status messages. Default <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Sets</span></code></p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">----</span></code></p></li>
<li><p><strong>bathymetryConDist</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – Shape <code class="docutils literal notranslate"><span class="pre">(BasinCnt,</span> <span class="pre">BasinCnt,</span> <span class="pre">len(binEdges)-1)</span></code>.</p></li>
<li><p><strong>basinConnectionDefined</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – Flag set to <code class="docutils literal notranslate"><span class="pre">True</span></code> on success.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Requires that <code class="docutils literal notranslate"><span class="pre">self.binEdges</span></code> and <code class="docutils literal notranslate"><span class="pre">self.basinCnt</span></code> (or equivalents) be</p></li>
</ul>
<p>consistent with the provided arguments.
- Each basin-pair distribution should sum to 100 (%).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.utils.BasinsSynth.defineBasinParameters">
<span class="sig-name descname"><span class="pre">defineBasinParameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">BasinCnt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Distribution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binEdges</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">AOC</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">VOC</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fanoc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([0.3,</span> <span class="pre">0.3,</span> <span class="pre">0.3,</span> <span class="pre">0.1])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fdvol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([0.333,</span> <span class="pre">0.333,</span> <span class="pre">0.334])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#BasinsSynth.defineBasinParameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.BasinsSynth.defineBasinParameters" title="Link to this definition">¶</a></dt>
<dd><p>Define per-basin bathymetry distributions and area/volume partitions.</p>
<p>Populates global and per-basin bathymetry histograms over <code class="docutils literal notranslate"><span class="pre">binEdges</span></code>,
sets basin area/volume fractions, and records high-latitude box area.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>BasinCnt</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <em>optional</em>) – Number of basins to define. Default is <code class="docutils literal notranslate"><span class="pre">3</span></code>.</p></li>
<li><p><strong>Distribution</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">array_like</span></code>, <em>optional</em>) – Length-<code class="docutils literal notranslate"><span class="pre">n</span></code> global bathymetry histogram (%) over the <code class="docutils literal notranslate"><span class="pre">n</span></code> intervals
defined by <code class="docutils literal notranslate"><span class="pre">binEdges</span></code> (sums to 100). Used to seed global and per-basin
distributions for synthetic cases.</p></li>
<li><p><strong>binEdges</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">array_like</span></code>, <em>optional</em>) – Length-<code class="docutils literal notranslate"><span class="pre">n+1</span></code> depth bin edges (km). Values deeper than the last edge
are assigned to the last bin.</p></li>
<li><p><strong>AOC</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, <em>optional</em>) – Total seafloor area (m²).</p></li>
<li><p><strong>VOC</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, <em>optional</em>) – Total ocean volume (m³).</p></li>
<li><p><strong>fanoc</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">array_like</span></code>, <em>optional</em>) – Length <code class="docutils literal notranslate"><span class="pre">BasinCnt+1</span></code> decimal fractions for <strong>area</strong>: one per basin
plus one high-latitude box fraction. Must sum to 1. Default
<code class="docutils literal notranslate"><span class="pre">[0.30,</span> <span class="pre">0.30,</span> <span class="pre">0.30,</span> <span class="pre">0.10]</span></code>.</p></li>
<li><p><strong>fdvol</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">array_like</span></code>, <em>optional</em>) – Length <code class="docutils literal notranslate"><span class="pre">BasinCnt</span></code> decimal fractions for <strong>volume</strong> per basin
(excluding the high-latitude box). Must sum to 1. Default
<code class="docutils literal notranslate"><span class="pre">[1/3,</span> <span class="pre">1/3,</span> <span class="pre">1/3]</span></code>.</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, print status messages. Default <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Sets</span></code></p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">----</span></code></p></li>
<li><p><strong>bathymetryVolFraction</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>)</p></li>
<li><p><strong>bathymetryAreaFraction</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>)</p></li>
<li><p><strong>bathymetryAreaDistBasin</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>)</p></li>
<li><p><strong>bathymetryAreaDist_wHighlatG</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">array_like</span></code>)</p></li>
<li><p><strong>bathymetryAreaDistG</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">array_like</span></code>)</p></li>
<li><p><strong>binEdges</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">array_like</span></code>)</p></li>
<li><p><strong>AOC</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>)</p></li>
<li><p><strong>VOC</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>)</p></li>
<li><p><strong>highlatA</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>)</p></li>
<li><p><strong>highlatlat</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>)</p></li>
<li><p><strong>BasinParametersDefined</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>)</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>For synthetic cases, per-basin distributions are initially copied from the
provided global <code class="docutils literal notranslate"><span class="pre">Distribution</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.utils.BasinsSynth.saveCcycleParameter">
<span class="sig-name descname"><span class="pre">saveCcycleParameter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#BasinsSynth.saveCcycleParameter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.BasinsSynth.saveCcycleParameter" title="Link to this definition">¶</a></dt>
<dd><p>Write synthetic bathymetry parameters to a netCDF4 file.</p>
<p>Creates groups and variables suitable for downstream carbon-cycle models.
Content depends on which parameter sets have been defined.</p>
<section id="output-structure">
<h3>Output Structure<a class="headerlink" href="#output-structure" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>Group <code class="docutils literal notranslate"><span class="pre">/CycleParms</span></code> (written if <a class="reference internal" href="#ExoCcycle.utils.BasinsSynth.BasinParametersDefined" title="ExoCcycle.utils.BasinsSynth.BasinParametersDefined"><code class="xref py py-attr docutils literal notranslate"><span class="pre">BasinParametersDefined</span></code></a> is True):</dt><dd><dl class="simple">
<dt>dimensions</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">binEdges</span></code>: <code class="docutils literal notranslate"><span class="pre">len(self.binEdges[1:])</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">BasinID</span></code>: number of basins</p></li>
</ul>
</dd>
<dt>variables</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">binEdges</span></code> (km)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Global-whighlat</span></code> (% over bins)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Global</span></code> (% over bins)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">basin-0</span></code>, <code class="docutils literal notranslate"><span class="pre">basin-1</span></code>, … (% over bins)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">BasinID</span></code> (IDs)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fdvol</span></code> (volume fractions per basin, %)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fanoc</span></code> (area fractions per basin, %)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">highlatlat</span></code> (degrees)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">highlatA</span></code> (m²)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">AOC</span></code> (m²)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">VOC</span></code> (m³)</p></li>
</ul>
</dd>
</dl>
</dd>
<dt>Group <code class="docutils literal notranslate"><span class="pre">/basinConnections</span></code> (written if <a class="reference internal" href="#ExoCcycle.utils.BasinsSynth.basinConnectionDefined" title="ExoCcycle.utils.BasinsSynth.basinConnectionDefined"><code class="xref py py-attr docutils literal notranslate"><span class="pre">basinConnectionDefined</span></code></a> is True):</dt><dd><dl class="simple">
<dt>dimensions</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">binEdges</span></code>: <code class="docutils literal notranslate"><span class="pre">len(self.binEdges[1:])</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">BasinID</span></code>: number of basins</p></li>
</ul>
</dd>
<dt>variables</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">basinConnectionBathymetry</span></code>: (BasinID, BasinID, binEdges)</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">type verbose<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">param verbose<span class="colon">:</span></dt>
<dd class="field-even"><p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, prints a summary of what was written and a table of groups,
variables, dimensions, and shapes. Default <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
</dd>
<dt class="field-odd">type verbose<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <em>optional</em></p>
</dd>
<dt class="field-even">rtype<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></p>
</dd>
<dt class="field-odd">raises OSError<span class="colon">:</span></dt>
<dd class="field-odd"><p>If the output path cannot be created or the file cannot be written.</p>
</dd>
<dt class="field-even">raises ValueError<span class="colon">:</span></dt>
<dd class="field-even"><p>If required parameters (e.g., <code class="docutils literal notranslate"><span class="pre">binEdges</span></code>) are missing when attempting
    to write their dependent variables.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>File is written to <code class="docutils literal notranslate"><span class="pre">{dataDir}/{filename}</span></code>.</p></li>
<li><p>Only the groups for which parameters have been defined are written.</p></li>
<li><p>The method reopens the file in read mode at the end (when <code class="docutils literal notranslate"><span class="pre">verbose</span></code>)</p></li>
</ul>
<p>to print a concise content report.</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.utils.BasinsSynth.setBathymetryBins">
<span class="sig-name descname"><span class="pre">setBathymetryBins</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bathymetryBins</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#BasinsSynth.setBathymetryBins"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.BasinsSynth.setBathymetryBins" title="Link to this definition">¶</a></dt>
<dd><p>Define the depth bin edges for bathymetry histograms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>bathymetryBins</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">array_like</span></code>) – Monotonically increasing vector of bin edges (km) with length <code class="docutils literal notranslate"><span class="pre">n+1</span></code>.
Histograms produced later will have length <code class="docutils literal notranslate"><span class="pre">n</span></code>.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This is a convenience setter; subsequent methods (e.g.,
<a class="reference internal" href="#ExoCcycle.utils.BasinsSynth.defineBasinParameters" title="ExoCcycle.utils.BasinsSynth.defineBasinParameters"><code class="xref py py-meth docutils literal notranslate"><span class="pre">defineBasinParameters()</span></code></a>) expect compatible <code class="docutils literal notranslate"><span class="pre">binEdges</span></code>.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ExoCcycle.utils.GLORYS12V1">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ExoCcycle.utils.</span></span><span class="sig-name descname"><span class="pre">GLORYS12V1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'data':</span> <span class="pre">'bottomT',</span> <span class="pre">'dataDir':</span> <span class="pre">'/home/bogumil/Documents/External_fids/ExoCcycle-workspace/ExoCcycle/GLORYS12V1',</span> <span class="pre">'depthAve':</span> <span class="pre">[0,</span> <span class="pre">100],</span> <span class="pre">'download':</span> <span class="pre">False,</span> <span class="pre">'year':</span> <span class="pre">[1994]}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#GLORYS12V1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.GLORYS12V1" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>GLORYS12V1 downloader/formatter for ExoCcycle workflows.</p>
<p>This helper prepares GLORYS12V1 ocean reanalysis fields for use in
ExoCcycle-style pipelines. It can (optionally) download monthly NetCDF
tiles, simplify them to <code class="docutils literal notranslate"><span class="pre">lon</span></code>/<code class="docutils literal notranslate"><span class="pre">lat</span></code>/<code class="docutils literal notranslate"><span class="pre">z</span></code> variables, perform a
thickness-weighted vertical average over a user-defined depth interval
when applicable, and compute multi-month means via GMT.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>options</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>, <em>optional</em>) – <p>Configuration dictionary. Recognized keys:</p>
<ul class="simple">
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">download</span></code><span class="classifier">bool</span></dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">download()</span></code> should be used to retrieve the data.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">dataDir</span></code><span class="classifier">str</span></dt><dd><p>Directory containing/receiving GLORYS files. Default:
<code class="docutils literal notranslate"><span class="pre">os.getcwd()</span> <span class="pre">+</span> <span class="pre">&quot;/GLORYS12V1&quot;</span></code>.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">year</span></code><span class="classifier">list[int]</span></dt><dd><p>Years to process (e.g., <code class="docutils literal notranslate"><span class="pre">[1994]</span></code>).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">data</span></code><span class="classifier">str</span></dt><dd><p>Variable to extract:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;bottomT&quot;</span></code> → <code class="docutils literal notranslate"><span class="pre">sea_water_potential_temperature_at_sea_floor</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;thetao&quot;</span></code> → <code class="docutils literal notranslate"><span class="pre">sea_water_potential_temperature</span></code> (has depth)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;so&quot;</span></code> → <code class="docutils literal notranslate"><span class="pre">sea_water_salinity</span></code> (has depth)</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">depthAve</span></code><span class="classifier">list[float, float]</span></dt><dd><p>Two-element list <code class="docutils literal notranslate"><span class="pre">[zmin,</span> <span class="pre">zmax]</span></code> (meters) for the vertical
averaging interval; used only for variables with a depth dimension.</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="ExoCcycle.utils.GLORYS12V1.options">
<span class="sig-name descname"><span class="pre">options</span></span><a class="headerlink" href="#ExoCcycle.utils.GLORYS12V1.options" title="Link to this definition">¶</a></dt>
<dd><p>Stored configuration, augmented with <code class="docutils literal notranslate"><span class="pre">netCDFGeneral</span></code> template.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ExoCcycle.utils.GLORYS12V1.netCDFGeneral">
<span class="sig-name descname"><span class="pre">netCDFGeneral</span></span><a class="headerlink" href="#ExoCcycle.utils.GLORYS12V1.netCDFGeneral" title="Link to this definition">¶</a></dt>
<dd><p>Filename template for monthly tiles:
<code class="docutils literal notranslate"><span class="pre">&quot;mercatorglorys12v1_gl12_mean_YEARMONTH.nc&quot;</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ExoCcycle.utils.GLORYS12V1.ListOfNetCDFs">
<span class="sig-name descname"><span class="pre">ListOfNetCDFs</span></span><a class="headerlink" href="#ExoCcycle.utils.GLORYS12V1.ListOfNetCDFs" title="Link to this definition">¶</a></dt>
<dd><p>Monthly file names constructed from the template (set by
<a class="reference internal" href="#ExoCcycle.utils.GLORYS12V1.averageModels" title="ExoCcycle.utils.GLORYS12V1.averageModels"><code class="xref py py-meth docutils literal notranslate"><span class="pre">averageModels()</span></code></a>).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">list[str]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ExoCcycle.utils.GLORYS12V1.ListOfSimpNetCDFs">
<span class="sig-name descname"><span class="pre">ListOfSimpNetCDFs</span></span><a class="headerlink" href="#ExoCcycle.utils.GLORYS12V1.ListOfSimpNetCDFs" title="Link to this definition">¶</a></dt>
<dd><p>Paths to simplified monthly files written by <a class="reference internal" href="#ExoCcycle.utils.GLORYS12V1.simplifyNetCDF" title="ExoCcycle.utils.GLORYS12V1.simplifyNetCDF"><code class="xref py py-meth docutils literal notranslate"><span class="pre">simplifyNetCDF()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">list[str]</span></code></p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Vertical averaging expects a <code class="docutils literal notranslate"><span class="pre">depth</span></code> coordinate (meters) and uses
simple layer-thickness weighting.</p></li>
<li><p><a class="reference internal" href="#ExoCcycle.utils.GLORYS12V1.averageModels" title="ExoCcycle.utils.GLORYS12V1.averageModels"><code class="xref py py-meth docutils literal notranslate"><span class="pre">averageModels()</span></code></a> shells out to <strong>GMT</strong> (<code class="docutils literal notranslate"><span class="pre">grdmath</span></code>); GMT must be
available on <code class="docutils literal notranslate"><span class="pre">PATH</span></code>.</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.utils.GLORYS12V1.averageModels">
<span class="sig-name descname"><span class="pre">averageModels</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#GLORYS12V1.averageModels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.GLORYS12V1.averageModels" title="Link to this definition">¶</a></dt>
<dd><p>Create simplified monthly grids and compute their GMT average.</p>
<section id="workflow">
<h3>Workflow<a class="headerlink" href="#workflow" title="Link to this heading">¶</a></h3>
<ol class="arabic">
<li><p>For each month of each year in <code class="docutils literal notranslate"><span class="pre">options['year']</span></code>, build the
filename from the template and record it in <a class="reference internal" href="#ExoCcycle.utils.GLORYS12V1.ListOfNetCDFs" title="ExoCcycle.utils.GLORYS12V1.ListOfNetCDFs"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ListOfNetCDFs</span></code></a>.</p></li>
<li><p>For each monthly file, call <a class="reference internal" href="#ExoCcycle.utils.GLORYS12V1.simplifyNetCDF" title="ExoCcycle.utils.GLORYS12V1.simplifyNetCDF"><code class="xref py py-meth docutils literal notranslate"><span class="pre">simplifyNetCDF()</span></code></a> to write a compact
NetCDF with only longitude, latitude, and a single 2-D field <code class="docutils literal notranslate"><span class="pre">z</span></code>.</p></li>
<li><p>Use GMT <code class="docutils literal notranslate"><span class="pre">grdmath</span></code> to compute the arithmetic mean across all
simplified files and write the result to:</p>
<p><code class="docutils literal notranslate"><span class="pre">{dataDir}/{data}_average_{z0}_{z1}m.nc</span></code></p>
<p>where <code class="docutils literal notranslate"><span class="pre">z0</span></code> and <code class="docutils literal notranslate"><span class="pre">z1</span></code> come from <code class="docutils literal notranslate"><span class="pre">options['depthAve']</span></code>.</p>
</li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">returns<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Side</span> <span class="pre">Effects</span></code></p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">------------</span></code></p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">-</span> <span class="pre">Populates</span> <span class="pre">:attr:`ListOfNetCDFs`</span></code> and <a class="reference internal" href="#ExoCcycle.utils.GLORYS12V1.ListOfSimpNetCDFs" title="ExoCcycle.utils.GLORYS12V1.ListOfSimpNetCDFs"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ListOfSimpNetCDFs</span></code></a>.</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">-</span> <span class="pre">Writes</span> <span class="pre">simplified</span> <span class="pre">monthly</span> <span class="pre">NetCDFs</span> <span class="pre">into</span> <span class="pre">``dataDir`</span></code>.`</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">-</span> <span class="pre">Writes</span> <span class="pre">a</span> <span class="pre">single</span> <span class="pre">averaged</span> <span class="pre">NetCDF</span></code> to <code class="docutils literal notranslate"><span class="pre">dataDir</span></code> via GMT.</p></li>
</ul>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.utils.GLORYS12V1.readnetCDF">
<span class="sig-name descname"><span class="pre">readnetCDF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">year</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">month</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#GLORYS12V1.readnetCDF"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.GLORYS12V1.readnetCDF" title="Link to this definition">¶</a></dt>
<dd><p>Open a single monthly GLORYS12V1 NetCDF for reading.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>year</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – Four-digit year (e.g., <code class="docutils literal notranslate"><span class="pre">1994</span></code>).</p></li>
<li><p><strong>month</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – Month number <code class="docutils literal notranslate"><span class="pre">1..12</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Opened dataset in read mode.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">netCDF4.Dataset</span></code></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The filename is constructed from <a class="reference internal" href="#ExoCcycle.utils.GLORYS12V1.netCDFGeneral" title="ExoCcycle.utils.GLORYS12V1.netCDFGeneral"><code class="xref py py-attr docutils literal notranslate"><span class="pre">netCDFGeneral</span></code></a> and
<code class="docutils literal notranslate"><span class="pre">options['dataDir']</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.utils.GLORYS12V1.simplifyNetCDF">
<span class="sig-name descname"><span class="pre">simplifyNetCDF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputPath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'path/file.nc'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputPath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'~/file2.nc'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variableList</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['longitude',</span> <span class="pre">'latitude',</span> <span class="pre">'variable']</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#GLORYS12V1.simplifyNetCDF"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.GLORYS12V1.simplifyNetCDF" title="Link to this definition">¶</a></dt>
<dd><p>Write a compact NetCDF with lon/lat and a single 2-D field <code class="docutils literal notranslate"><span class="pre">z</span></code>.</p>
<p>If the source variable has a depth dimension, compute a thickness-
weighted vertical average over the interval defined by
<code class="docutils literal notranslate"><span class="pre">options['depthAve']</span></code>. If it does <strong>not</strong> have a depth dimension,
copy the 2-D field as-is into <code class="docutils literal notranslate"><span class="pre">z</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputPath</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <em>optional</em>) – Path to the input NetCDF file.</p></li>
<li><p><strong>outputPath</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <em>optional</em>) – Destination path for the simplified NetCDF. <code class="docutils literal notranslate"><span class="pre">~</span></code> is expanded.</p></li>
<li><p><strong>variableList</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list[str]</span></code>, <em>optional</em>) – Names of the longitude (x), latitude (y), and data (z) variables
in the source file (e.g., <code class="docutils literal notranslate"><span class="pre">['longitude',</span> <span class="pre">'latitude',</span> <span class="pre">'thetao']</span></code>).</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The depth-average path expects a <code class="docutils literal notranslate"><span class="pre">depth</span></code> coordinate in meters and
uses simple layer-thickness weighting within the requested interval.</p></li>
<li><p>Output format is <code class="docutils literal notranslate"><span class="pre">NETCDF4_CLASSIC</span></code>; the data variable is named
<code class="docutils literal notranslate"><span class="pre">&quot;z&quot;</span></code> and has shape <code class="docutils literal notranslate"><span class="pre">(y,</span> <span class="pre">x)</span></code>.</p></li>
</ul>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ExoCcycle.utils.GLORYS12V1_QT">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ExoCcycle.utils.</span></span><span class="sig-name descname"><span class="pre">GLORYS12V1_QT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'data':</span> <span class="pre">'bottomT',</span> <span class="pre">'dataDir':</span> <span class="pre">'/home/bogumil/Documents/External_fids/ExoCcycle-workspace/ExoCcycle/GLORYS12V1',</span> <span class="pre">'depthAve':</span> <span class="pre">[0,</span> <span class="pre">100],</span> <span class="pre">'download':</span> <span class="pre">False,</span> <span class="pre">'year':</span> <span class="pre">[1994]}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#GLORYS12V1_QT"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.GLORYS12V1_QT" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>GLORYS12V1 downloader/formatter with quantile-transformed depth averaging.</p>
<p>This helper class prepares GLORYS12V1 ocean reanalysis fields for use in
ExoCcycle-style workflows. It can (optionally) download monthly NetCDF
tiles, simplify them to lon/lat/<code class="docutils literal notranslate"><span class="pre">z</span></code> variables, and produce a <strong>quantile-
transformed</strong>, layer-thickness–weighted vertical average over a user-given
depth interval. It can also average multiple monthly files with GMT.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>options</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>, <em>optional</em>) – <p>Configuration dictionary. Recognized keys:
- <code class="docutils literal notranslate"><span class="pre">&quot;download&quot;</span></code> (bool): If <code class="docutils literal notranslate"><span class="pre">True</span></code>, <a class="reference internal" href="#ExoCcycle.utils.GLORYS12V1_QT.download" title="ExoCcycle.utils.GLORYS12V1_QT.download"><code class="xref py py-meth docutils literal notranslate"><span class="pre">download()</span></code></a> should be called</p>
<blockquote>
<div><p>to retrieve the monthly NetCDFs. Default <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
</div></blockquote>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;dataDir&quot;</span></code> (str): Directory containing/receiving GLORYS files.
Default <code class="docutils literal notranslate"><span class="pre">os.getcwd()</span> <span class="pre">+</span> <span class="pre">&quot;/GLORYS12V1&quot;</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;year&quot;</span></code> (list[int]): Years to process (e.g., <code class="docutils literal notranslate"><span class="pre">[1994]</span></code>).</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">&quot;data&quot;</span></code> (str): Variable to extract:</dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;bottomT&quot;</span></code> → <code class="docutils literal notranslate"><span class="pre">sea_water_potential_temperature_at_sea_floor</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;thetao&quot;</span></code> → <code class="docutils literal notranslate"><span class="pre">sea_water_potential_temperature</span></code> (has depth)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;so&quot;</span></code> → <code class="docutils literal notranslate"><span class="pre">sea_water_salinity</span></code> (has depth)</p></li>
</ul>
</dd>
</dl>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;depthAve&quot;</span></code> (list[float, float]): Lower/upper bounds (meters) of
the depth interval for vertical averaging when the variable has a
depth dimension.</p></li>
</ul>
</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="ExoCcycle.utils.GLORYS12V1_QT.options">
<span class="sig-name descname"><span class="pre">options</span></span><a class="headerlink" href="#ExoCcycle.utils.GLORYS12V1_QT.options" title="Link to this definition">¶</a></dt>
<dd><p>Stored configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ExoCcycle.utils.GLORYS12V1_QT.areaWeightsA">
<span class="sig-name descname"><span class="pre">areaWeightsA</span></span><a class="headerlink" href="#ExoCcycle.utils.GLORYS12V1_QT.areaWeightsA" title="Link to this definition">¶</a></dt>
<dd><p>Placeholder for lazy initialization flag; the area-weight grid is
created on first call to <a class="reference internal" href="#ExoCcycle.utils.GLORYS12V1_QT.simplifyNetCDF" title="ExoCcycle.utils.GLORYS12V1_QT.simplifyNetCDF"><code class="xref py py-meth docutils literal notranslate"><span class="pre">simplifyNetCDF()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">any</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">areaWeights,</span> <span class="pre">longitudes,</span> <span class="pre">latitudes</span></span></dt>
<dd><p>Area-weight grid and its coordinates (set by <a class="reference internal" href="#ExoCcycle.utils.GLORYS12V1_QT.makeAreaWeightGrid" title="ExoCcycle.utils.GLORYS12V1_QT.makeAreaWeightGrid"><code class="xref py py-meth docutils literal notranslate"><span class="pre">makeAreaWeightGrid()</span></code></a>).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">totalArea,</span> <span class="pre">totalAreaCalculated</span></span></dt>
<dd><p>Sphere area (analytic and from the weights) returned by
<a class="reference internal" href="#ExoCcycle.utils.areaWeights" title="ExoCcycle.utils.areaWeights"><code class="xref py py-func docutils literal notranslate"><span class="pre">areaWeights()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ExoCcycle.utils.GLORYS12V1_QT.netCDFGeneral">
<span class="sig-name descname"><span class="pre">netCDFGeneral</span></span><a class="headerlink" href="#ExoCcycle.utils.GLORYS12V1_QT.netCDFGeneral" title="Link to this definition">¶</a></dt>
<dd><p>Filename template for monthly tiles:
<code class="docutils literal notranslate"><span class="pre">&quot;mercatorglorys12v1_gl12_mean_YEARMONTH.nc&quot;</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">ListOfNetCDFs,</span> <span class="pre">ListOfSimpNetCDFs</span></span></dt>
<dd><p>Populated by <a class="reference internal" href="#ExoCcycle.utils.GLORYS12V1_QT.averageModels" title="ExoCcycle.utils.GLORYS12V1_QT.averageModels"><code class="xref py py-meth docutils literal notranslate"><span class="pre">averageModels()</span></code></a> with monthly file paths.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">list[str]</span></code></p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The depth-average in <a class="reference internal" href="#ExoCcycle.utils.GLORYS12V1_QT.simplifyNetCDF" title="ExoCcycle.utils.GLORYS12V1_QT.simplifyNetCDF"><code class="xref py py-meth docutils literal notranslate"><span class="pre">simplifyNetCDF()</span></code></a> applies a <strong>quantile
transformation</strong> (to a normal distribution) <em>per depth layer</em> before
thickness-weighting and averaging over the requested interval.</p></li>
<li><p><a class="reference internal" href="#ExoCcycle.utils.GLORYS12V1_QT.averageModels" title="ExoCcycle.utils.GLORYS12V1_QT.averageModels"><code class="xref py py-meth docutils literal notranslate"><span class="pre">averageModels()</span></code></a> shells out to <strong>GMT</strong> via <code class="docutils literal notranslate"><span class="pre">grdmath</span></code> to average
monthly simplified grids. GMT must be available on <code class="docutils literal notranslate"><span class="pre">PATH</span></code>.</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.utils.GLORYS12V1_QT.averageModels">
<span class="sig-name descname"><span class="pre">averageModels</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#GLORYS12V1_QT.averageModels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.GLORYS12V1_QT.averageModels" title="Link to this definition">¶</a></dt>
<dd><p>averageModels is used to make an averaged netCDF model
given all netCDFs stored in the data directory.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.utils.GLORYS12V1_QT.download">
<span class="sig-name descname"><span class="pre">download</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#GLORYS12V1_QT.download"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.GLORYS12V1_QT.download" title="Link to this definition">¶</a></dt>
<dd><p>download method is used to download the GLORYS12V1
data (netCDFs) and store them in a data directory
accessed by the ExoCcycle library.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.utils.GLORYS12V1_QT.makeAreaWeightGrid">
<span class="sig-name descname"><span class="pre">makeAreaWeightGrid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latRange</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lonRange</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#GLORYS12V1_QT.makeAreaWeightGrid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.GLORYS12V1_QT.makeAreaWeightGrid" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.utils.GLORYS12V1_QT.readnetCDF">
<span class="sig-name descname"><span class="pre">readnetCDF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">year</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">month</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#GLORYS12V1_QT.readnetCDF"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.GLORYS12V1_QT.readnetCDF" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.utils.GLORYS12V1_QT.simplifyNetCDF">
<span class="sig-name descname"><span class="pre">simplifyNetCDF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputPath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'path/file.nc'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputPath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'~/file2.nc'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variableList</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['longitude',</span> <span class="pre">'latitude',</span> <span class="pre">'variable']</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#GLORYS12V1_QT.simplifyNetCDF"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.GLORYS12V1_QT.simplifyNetCDF" title="Link to this definition">¶</a></dt>
<dd><p>simplifyNetCDF method reads a NetCDF4 file and writes a new NetCDF4 file
with only lat, lon, and ‘variable’ variables.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_path</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">STRING</span></code>) – Path to the input NetCDF4 file.</p></li>
<li><p><strong>output_path</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">STRING</span></code>) – Path to save the new NetCDF4 file.</p></li>
<li><p><strong>variableList</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">LIST</span> <span class="pre">OF</span> <span class="pre">STRINGS</span></code>) – 3 length list of strings that correspond to an
x (longitude), y (latitude), and z (e.g., bathymetry)
variable. The default is [‘latitude’, ‘logitude’,
‘variable’].</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ExoCcycle.utils.areaWeights">
<span class="sig-prename descclassname"><span class="pre">ExoCcycle.utils.</span></span><span class="sig-name descname"><span class="pre">areaWeights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6371000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">LonStEd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[-180,</span> <span class="pre">180]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">LatStEd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[-90,</span> <span class="pre">90]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#areaWeights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.areaWeights" title="Link to this definition">¶</a></dt>
<dd><p>Compute a 2D array of spherical surface area weights based on latitude and longitude resolution.</p>
<p>This function calculates grid-cell surface areas for a spherical body, returning
area weights and coordinate arrays corresponding to the centers of each cell.
The sum of the weights approaches the analytic surface area <code class="docutils literal notranslate"><span class="pre">4πR²</span></code> at sufficiently
high spatial resolution.</p>
<dl>
<dt>Args:</dt><dd><dl class="simple">
<dt>resolution (float, optional):</dt><dd><p>Angular resolution of the grid in degrees.
Defines both the longitudinal and latitudinal spacing.
Defaults to <code class="docutils literal notranslate"><span class="pre">1.0</span></code>.</p>
</dd>
<dt>radius (float, optional):</dt><dd><p>Radius of the spherical body in meters.
Common planetary values include:
- Earth: <code class="docutils literal notranslate"><span class="pre">6371e3</span></code>
- Venus: <code class="docutils literal notranslate"><span class="pre">6051e3</span></code>
- Mars: <code class="docutils literal notranslate"><span class="pre">3389.5e3</span></code>
- Moon: <code class="docutils literal notranslate"><span class="pre">1737.4e3</span></code>
Defaults to Earth’s mean radius (<code class="docutils literal notranslate"><span class="pre">6371e3</span></code> m).</p>
</dd>
<dt>LonStEd (list[float], optional):</dt><dd><p>Two-element list specifying the starting and ending longitude bounds in degrees.
Defaults to <code class="docutils literal notranslate"><span class="pre">[-180,</span> <span class="pre">180]</span></code>.</p>
</dd>
<dt>LatStEd (list[float], optional):</dt><dd><p>Two-element list specifying the starting and ending latitude bounds in degrees.
Defaults to <code class="docutils literal notranslate"><span class="pre">[-90,</span> <span class="pre">90]</span></code>.</p>
</dd>
<dt>verbose (bool):</dt><dd><p>Option to report additional information.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>tuple:</dt><dd><ul class="simple">
<li><p><strong>areaWeights</strong> (<cite>numpy.ndarray</cite>): 2D array of grid-cell surface areas in square meters.</p></li>
<li><p><strong>longitudes</strong> (<cite>numpy.ndarray</cite>): 2D array of longitudes (cell centers).</p></li>
<li><p><strong>latitudes</strong> (<cite>numpy.ndarray</cite>): 2D array of latitudes (cell centers).</p></li>
<li><p><strong>totalArea</strong> (<cite>float</cite>): Analytic surface area <code class="docutils literal notranslate"><span class="pre">4πR²</span></code> in m².</p></li>
<li><p><strong>totalAreaCalculated</strong> (<cite>float</cite>): Numerically summed area from <code class="docutils literal notranslate"><span class="pre">areaWeights</span></code> in m².</p></li>
</ul>
</dd>
</dl>
</dd>
<dt>Raises:</dt><dd><dl class="simple">
<dt>ValueError:</dt><dd><p>If resolution is non-positive or exceeds valid angular bounds.</p>
</dd>
<dt>TypeError:</dt><dd><p>If inputs are of incorrect type (e.g., non-numeric resolution).</p>
</dd>
</dl>
</dd>
<dt>Notes:</dt><dd><ul class="simple">
<li><p>The grid is constructed cell-centered (e.g., <code class="docutils literal notranslate"><span class="pre">0.5°</span></code>, <code class="docutils literal notranslate"><span class="pre">1.5°</span></code>, …).</p></li>
<li><p>For symmetric domains (e.g., <code class="docutils literal notranslate"><span class="pre">[-180,</span> <span class="pre">180]</span></code>, <code class="docutils literal notranslate"><span class="pre">[-90,</span> <span class="pre">90]</span></code>), longitude and
latitude arrays are adjusted to ensure full coverage.</p></li>
<li><p>The function assumes a perfectly spherical body—ellipsoidal corrections are not applied.</p></li>
<li><p>For each latitude band, surface area per cell is computed using
<a class="reference internal" href="#ExoCcycle.utils.cellAreaOnSphere" title="ExoCcycle.utils.cellAreaOnSphere"><code class="xref py py-func docutils literal notranslate"><span class="pre">cellAreaOnSphere()</span></code></a>.</p></li>
</ul>
</dd>
<dt>Example:</dt><dd><p>Compute 5° × 5° global area weights for Earth:</p>
<p><code class="docutils literal notranslate"><span class="pre">`python</span>
<span class="pre">area,</span> <span class="pre">lon,</span> <span class="pre">lat,</span> <span class="pre">A_theoretical,</span> <span class="pre">A_calc</span> <span class="pre">=</span> <span class="pre">areaWeights(resolution=5)</span>
<span class="pre">print(f&quot;Theoretical</span> <span class="pre">surface</span> <span class="pre">area:</span> <span class="pre">{A_theoretical:.3e}</span> <span class="pre">m²&quot;)</span>
<span class="pre">print(f&quot;Numerical</span> <span class="pre">total</span> <span class="pre">area:</span>&#160;&#160;&#160;&#160; <span class="pre">{A_calc:.3e}</span> <span class="pre">m²&quot;)</span>
<span class="pre">print(f&quot;Relative</span> <span class="pre">error:</span> <span class="pre">{(A_calc</span> <span class="pre">-</span> <span class="pre">A_theoretical)</span> <span class="pre">/</span> <span class="pre">A_theoretical:.3e}&quot;)</span>
<span class="pre">`</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ExoCcycle.utils.cellAreaOnSphere">
<span class="sig-prename descclassname"><span class="pre">ExoCcycle.utils.</span></span><span class="sig-name descname"><span class="pre">cellAreaOnSphere</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">clat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6371000.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#cellAreaOnSphere"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.cellAreaOnSphere" title="Link to this definition">¶</a></dt>
<dd><p>Compute the surface area of a latitude-longitude grid cell on a sphere.</p>
<p>This function calculates the surface area of a single rectangular cell
centered at latitude <code class="docutils literal notranslate"><span class="pre">clat</span></code> on a spherical body, using an approximation
valid for small angular resolutions. The area is derived from the spherical
surface differential:</p>
<div class="math notranslate nohighlight">
\[A = R^2 \, \Delta\lambda \, \Delta\phi \, \cos(\phi)\]</div>
<p>where <code class="docutils literal notranslate"><span class="pre">R</span></code> is the sphere’s radius, <code class="docutils literal notranslate"><span class="pre">Δλ</span></code> and <code class="docutils literal notranslate"><span class="pre">Δφ</span></code> are cell widths in
radians (longitude and latitude), and <code class="docutils literal notranslate"><span class="pre">φ</span></code> is the cell center latitude.</p>
<dl>
<dt>Args:</dt><dd><dl class="simple">
<dt>clat (float):</dt><dd><p>Center latitude of the cell, in <strong>degrees</strong>.</p>
</dd>
<dt>resolution (float, optional):</dt><dd><p>Angular resolution of the cell in <strong>degrees</strong> (applied to both
latitude and longitude). Defaults to <code class="docutils literal notranslate"><span class="pre">1.0</span></code>.</p>
</dd>
<dt>radius (float, optional):</dt><dd><p>Radius of the spherical body in <strong>meters</strong>. Defaults to Earth’s mean
radius (<code class="docutils literal notranslate"><span class="pre">6371e3</span></code>).</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>float:</dt><dd><p>Cell surface area in <strong>square meters</strong>.</p>
</dd>
</dl>
</dd>
<dt>Raises:</dt><dd><dl class="simple">
<dt>ValueError:</dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">resolution</span></code> is not positive or exceeds 180°.</p>
</dd>
<dt>TypeError:</dt><dd><p>If input arguments are not numeric.</p>
</dd>
</dl>
</dd>
<dt>Notes:</dt><dd><ul class="simple">
<li><p>The function assumes a perfectly spherical body.</p></li>
<li><p>For fine resolutions (≤ 5°), this approximation agrees well with
the spherical excess formula.</p></li>
<li><p>Units: meters are used internally and for the output.</p></li>
</ul>
</dd>
<dt>Example:</dt><dd><p>Compute the surface area of a 1° × 1° cell centered at 45°N on Earth:</p>
<p><code class="docutils literal notranslate"><span class="pre">`python</span>
<span class="pre">import</span> <span class="pre">numpy</span> <span class="pre">as</span> <span class="pre">np</span>
<span class="pre">area</span> <span class="pre">=</span> <span class="pre">cellAreaOnSphere(45,</span> <span class="pre">resolution=1.0)</span>
<span class="pre">print(f&quot;Cell</span> <span class="pre">area:</span> <span class="pre">{area/1e6:.2f}</span> <span class="pre">km²&quot;)</span>
<span class="pre">`</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ExoCcycle.utils.combine_lists">
<span class="sig-prename descclassname"><span class="pre">ExoCcycle.utils.</span></span><span class="sig-name descname"><span class="pre">combine_lists</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">lists</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#combine_lists"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.combine_lists" title="Link to this definition">¶</a></dt>
<dd><p>Compute the Cartesian product of multiple input lists.</p>
<p>Returns a NumPy array of shape <code class="docutils literal notranslate"><span class="pre">(number_of_combinations,</span> <span class="pre">N)</span></code>, where each
row is one unique combination (i.e., the Cartesian product) of the input lists.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>*lists</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">sequence</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">array_like</span></code>) – One or more input sequences. Each sequence should contain only numeric
values (<code class="docutils literal notranslate"><span class="pre">int</span></code> or <code class="docutils literal notranslate"><span class="pre">float</span></code>). Lists need not be the same length.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A 2D array of shape <code class="docutils literal notranslate"><span class="pre">(number_of_combinations,</span> <span class="pre">N)</span></code>, containing all
unique combinations from the input lists.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a> – If no input lists are provided.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>If inputs contain mixed data types or non-numeric values, NumPy may upcast
the array to <code class="docutils literal notranslate"><span class="pre">dtype=object</span></code>. This function is intended for numeric inputs.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference external" href="https://docs.python.org/3/library/itertools.html#itertools.product" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">itertools.product</span></code></a></dt><dd><p>Python standard library function that computes Cartesian products.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p>Build combinations of file IDs and ensemble sizes.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">itertools</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">file_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;file1.nc&quot;</span><span class="p">,</span> <span class="s2">&quot;file2.nc&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">file_name_ids</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ensemble_sizes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">combine_lists</span><span class="p">(</span><span class="n">file_name_ids</span><span class="p">,</span> <span class="n">ensemble_sizes</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">file_id</span><span class="p">,</span> <span class="n">ens</span> <span class="ow">in</span> <span class="n">A</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;values:&quot;</span><span class="p">,</span> <span class="n">file_id</span><span class="p">,</span> <span class="n">ens</span><span class="p">,</span> <span class="n">file_names</span><span class="p">[</span><span class="n">file_id</span><span class="p">])</span>
<span class="go">values: 0 10 file1.nc</span>
<span class="go">values: 0 50 file1.nc</span>
<span class="go">values: 1 10 file2.nc</span>
<span class="go">values: 1 50 file2.nc</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ExoCcycle.utils.create_file_structure">
<span class="sig-prename descclassname"><span class="pre">ExoCcycle.utils.</span></span><span class="sig-name descname"><span class="pre">create_file_structure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">list_of_directories</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">root</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#create_file_structure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.create_file_structure" title="Link to this definition">¶</a></dt>
<dd><p>Create directories from a provided list of paths.</p>
<p>Each path in <code class="docutils literal notranslate"><span class="pre">list_of_directories</span></code> is created if it does not already exist.
When <code class="docutils literal notranslate"><span class="pre">root</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code> (default), each provided path is treated as
relative to the current working directory (<code class="docutils literal notranslate"><span class="pre">os.getcwd()</span></code>) and is
<strong>prepended</strong> with it. When <code class="docutils literal notranslate"><span class="pre">root</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, the paths are used as-is
(e.g., absolute paths like <code class="docutils literal notranslate"><span class="pre">/data/...</span></code>).</p>
<dl>
<dt>Args:</dt><dd><dl>
<dt>list_of_directories (list[str]):</dt><dd><p>List of directory paths to create, e.g.:</p>
<p><code class="docutils literal notranslate"><span class="pre">[&quot;/data&quot;,</span>
<span class="pre">&quot;/data/folder1&quot;,</span> <span class="pre">&quot;/data/folder1/folder1&quot;,</span>
<span class="pre">&quot;/data/folder2&quot;,</span> <span class="pre">&quot;/data/folder2/folder1&quot;,</span>
<span class="pre">&quot;/data/folder3&quot;]</span></code></p>
<p>Note: This function creates exactly the directories provided in this
list; it does <strong>not</strong> automatically create missing parents unless
they are also included in the list and appear earlier.</p>
</dd>
<dt>root (bool, optional):</dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, use each path exactly as given.
If <code class="docutils literal notranslate"><span class="pre">False</span></code>, prefix each path with <code class="docutils literal notranslate"><span class="pre">os.getcwd()</span></code>. Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
</dd>
<dt>verbose (bool, optional):</dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, prints a message listing any directories that already
existed. Defaults to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>None:</dt><dd><p>Writes directories to the filesystem; no return value.</p>
</dd>
</dl>
</dd>
<dt>Raises:</dt><dd><dl class="simple">
<dt>PermissionError:</dt><dd><p>If the process lacks permission to create one or more directories.</p>
</dd>
<dt>FileNotFoundError:</dt><dd><p>If a parent directory does not exist and was not provided earlier
in <code class="docutils literal notranslate"><span class="pre">list_of_directories</span></code>.</p>
</dd>
<dt>OSError:</dt><dd><p>For other OS-level errors triggered by <code class="docutils literal notranslate"><span class="pre">os.mkdir</span></code>.</p>
</dd>
</dl>
</dd>
<dt>Notes:</dt><dd><ul class="simple">
<li><p>Paths are created with <code class="docutils literal notranslate"><span class="pre">os.mkdir</span></code> (single-level). Provide parent
directories first if they do not already exist.</p></li>
<li><p>Existing directories are collected and, when <code class="docutils literal notranslate"><span class="pre">verbose</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>,
reported at the end of execution.</p></li>
<li><p>This function uses simple string concatenation when <code class="docutils literal notranslate"><span class="pre">root</span></code> is
<code class="docutils literal notranslate"><span class="pre">False</span></code> (<code class="docutils literal notranslate"><span class="pre">os.getcwd()</span> <span class="pre">+</span> <span class="pre">path</span></code>). Ensure your provided paths begin
with a path separator (e.g., <code class="docutils literal notranslate"><span class="pre">&quot;/data&quot;</span></code>) for the intended result.</p></li>
</ul>
</dd>
<dt>Example:</dt><dd><p>Create a small tree under the current working directory:</p>
<p><a href="#id55"><span class="problematic" id="id56">``</span></a><a href="#id57"><span class="problematic" id="id58">`</span></a>python
create_file_structure(</p>
<blockquote>
<div><p>[“/data”, “/data/raw”, “/data/processed”],
root=False,
verbose=True</p>
</div></blockquote>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ExoCcycle.utils.downloadSolarSystemBodies">
<span class="sig-prename descclassname"><span class="pre">ExoCcycle.utils.</span></span><span class="sig-name descname"><span class="pre">downloadSolarSystemBodies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#downloadSolarSystemBodies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.downloadSolarSystemBodies" title="Link to this definition">¶</a></dt>
<dd><p>Download and process standardized topography models for key Solar System bodies.</p>
<p>This function downloads and prepares global topography models for all
planetary bodies integrated into <strong>ExoCcycle</strong>, currently including
<em>Venus</em>, <em>Earth</em>, <em>Mars</em>, and the <em>Moon</em>.
For each body, the function:
1. Downloads raw topography data.
2. Creates a NetCDF file at 1° resolution.
3. Re-runs the postprocessing routine to generate GMT-compatible outputs.</p>
<dl>
<dt>Args:</dt><dd><dl class="simple">
<dt>data_dir (str):</dt><dd><p>Path to the base directory where local data are stored.
The function will create or use the subdirectory
<code class="docutils literal notranslate"><span class="pre">[data_dir]/topographies</span></code> to store downloaded files.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>None:</dt><dd><p>The function writes new NetCDF and GMT-compatible topography files
to disk but does not return a value.</p>
</dd>
</dl>
</dd>
<dt>Raises:</dt><dd><dl class="simple">
<dt>FileNotFoundError:</dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">data_dir</span></code> does not exist or is inaccessible.</p>
</dd>
<dt>ImportError:</dt><dd><p>If the required <code class="docutils literal notranslate"><span class="pre">Bathymetry</span></code> module is not available.</p>
</dd>
<dt>Exception:</dt><dd><p>For unexpected download, read, or file I/O failures.</p>
</dd>
</dl>
</dd>
<dt>Notes:</dt><dd><ul class="simple">
<li><p>The function uses <code class="xref py py-class docutils literal notranslate"><span class="pre">Bathymetry.BathyMeasured</span></code> from the
<strong>ExoCcycle</strong> package to handle downloads and resampling.</p></li>
<li><p>Each planetary body is processed at a default resolution of 1°.</p></li>
<li><p>If files already exist in <code class="docutils literal notranslate"><span class="pre">data_dir/topographies</span></code>, they may be
reused or overwritten depending on implementation of
<code class="docutils literal notranslate"><span class="pre">Bathymetry.BathyMeasured</span></code>.</p></li>
</ul>
</dd>
<dt>Example:</dt><dd><p>Download topography datasets for all supported Solar System bodies
into a local <code class="docutils literal notranslate"><span class="pre">data</span></code> directory:</p>
<p><code class="docutils literal notranslate"><span class="pre">`python</span>
<span class="pre">from</span> <span class="pre">ExoCcycle</span> <span class="pre">import</span> <span class="pre">Bathymetry</span>
<span class="pre">downloadSolarSystemBodies(&quot;./data&quot;)</span>
<span class="pre">`</span></code></p>
<p>This will populate:
<code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">./data/topographies/venus_1deg.nc</span>
<span class="pre">./data/topographies/earth_1deg.nc</span>
<span class="pre">./data/topographies/mars_1deg.nc</span>
<span class="pre">./data/topographies/moon_1deg.nc</span>
<span class="pre">`</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ExoCcycle.utils.eaNodes">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ExoCcycle.utils.</span></span><span class="sig-name descname"><span class="pre">eaNodes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'undefined':</span> <span class="pre">True}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precalculated</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precalculate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#eaNodes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.eaNodes" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Equal-area node generator and utilities for spherical grids.</p>
<p>This class builds a grid of node centroids arranged as equal-area
diamond-shaped regions on the surface of a sphere. It can optionally
persist the generated grid, connectivity, and related metadata to a
compressed <code class="docutils literal notranslate"><span class="pre">.npz</span></code> file, and later reload them. It also supports
interpolating values from a gridded dataset onto the equal-area nodes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>, <em>optional</em>) – Initialization options. Recognized keys include:
- <code class="docutils literal notranslate"><span class="pre">&quot;resolution&quot;</span></code> (float): Node spacing in <strong>degrees</strong>.
- <code class="docutils literal notranslate"><span class="pre">&quot;dataGrid&quot;</span></code> (str): Path to an input data grid (used by user code).
If <code class="docutils literal notranslate"><span class="pre">{&quot;undefined&quot;:</span> <span class="pre">True}</span></code> is provided (default), the class sets
internal defaults for resolution and paths.</p></li>
<li><p><strong>precalculated</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, attempt to load a previously saved set of attributes
from disk on init. Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>precalculate</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, write a saved set of attributes to disk after creating
the grid. Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="ExoCcycle.utils.eaNodes.inputs">
<span class="sig-name descname"><span class="pre">inputs</span></span><a class="headerlink" href="#ExoCcycle.utils.eaNodes.inputs" title="Link to this definition">¶</a></dt>
<dd><p>Initialization dictionary (stored as provided or with defaults).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ExoCcycle.utils.eaNodes.resolution">
<span class="sig-name descname"><span class="pre">resolution</span></span><a class="headerlink" href="#ExoCcycle.utils.eaNodes.resolution" title="Link to this definition">¶</a></dt>
<dd><p>Grid spacing in degrees.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ExoCcycle.utils.eaNodes.dataGrid">
<span class="sig-name descname"><span class="pre">dataGrid</span></span><a class="headerlink" href="#ExoCcycle.utils.eaNodes.dataGrid" title="Link to this definition">¶</a></dt>
<dd><p>Path to an input grid (if provided).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ExoCcycle.utils.eaNodes.interpGrid">
<span class="sig-name descname"><span class="pre">interpGrid</span></span><a class="headerlink" href="#ExoCcycle.utils.eaNodes.interpGrid" title="Link to this definition">¶</a></dt>
<dd><p>Path to the equal-area node list in lon/lat.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ExoCcycle.utils.eaNodes.output">
<span class="sig-name descname"><span class="pre">output</span></span><a class="headerlink" href="#ExoCcycle.utils.eaNodes.output" title="Link to this definition">¶</a></dt>
<dd><p>Path to a default output file used in downstream processing.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ExoCcycle.utils.eaNodes.filename1">
<span class="sig-name descname"><span class="pre">filename1</span></span><a class="headerlink" href="#ExoCcycle.utils.eaNodes.filename1" title="Link to this definition">¶</a></dt>
<dd><p>Path to text file containing node indices and XYZ coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ExoCcycle.utils.eaNodes.filename2">
<span class="sig-name descname"><span class="pre">filename2</span></span><a class="headerlink" href="#ExoCcycle.utils.eaNodes.filename2" title="Link to this definition">¶</a></dt>
<dd><p>Path to text file containing node lon/lat coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">ealon,</span> <span class="pre">ealat</span></span></dt>
<dd><p>Node longitudes and latitudes (degrees), populated by <code class="docutils literal notranslate"><span class="pre">makegrid</span></code> or load.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code> or <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ExoCcycle.utils.eaNodes.connectionNodeIDs">
<span class="sig-name descname"><span class="pre">connectionNodeIDs</span></span><a class="headerlink" href="#ExoCcycle.utils.eaNodes.connectionNodeIDs" title="Link to this definition">¶</a></dt>
<dd><p>Array with columns: [node_id, nbr_1, nbr_2, nbr_3, nbr_4]. Populated by <code class="docutils literal notranslate"><span class="pre">makegrid</span></code> or load.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ExoCcycle.utils.eaNodes.connectionNodeDis">
<span class="sig-name descname"><span class="pre">connectionNodeDis</span></span><a class="headerlink" href="#ExoCcycle.utils.eaNodes.connectionNodeDis" title="Link to this definition">¶</a></dt>
<dd><p>Array with columns: [node_id, d1, d2, d3, d4] (distances on unit sphere). Populated by <code class="docutils literal notranslate"><span class="pre">makegrid</span></code> or load.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">color,</span> <span class="pre">hist</span></span></dt>
<dd><p>User-facing placeholders (e.g., colors for plotting).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">any</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ExoCcycle.utils.eaNodes.data">
<span class="sig-name descname"><span class="pre">data</span></span><a class="headerlink" href="#ExoCcycle.utils.eaNodes.data" title="Link to this definition">¶</a></dt>
<dd><p>Mapping of interpolated variable name → values sampled at equal-area nodes.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">precalculated,</span> <span class="pre">precalculate</span></span></dt>
<dd><p>Flags controlling load/save behavior.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Notes</p>
<ul class="simple">
<li><p>All file artifacts are written under <code class="docutils literal notranslate"><span class="pre">./Nodes</span></code> (created if absent).</p></li>
<li><p>This class assumes a <strong>unit sphere</strong> for geometry; distances are in radians
when using great-circle formulas (see internal helpers).</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.utils.eaNodes.interp2IrregularGrid">
<span class="sig-name descname"><span class="pre">interp2IrregularGrid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#eaNodes.interp2IrregularGrid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.eaNodes.interp2IrregularGrid" title="Link to this definition">¶</a></dt>
<dd><p>Interpolate values from a gridded file to the equal-area node locations.</p>
<p>Uses GMT’s <code class="docutils literal notranslate"><span class="pre">grdtrack</span></code> to sample the provided grid at lon/lat points
stored in <code class="docutils literal notranslate"><span class="pre">self.filename2</span></code> and stores the resulting values under
<code class="docutils literal notranslate"><span class="pre">self.data[name]</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – Path to the input grid file to be sampled by GMT (e.g., NetCDF grid).</p></li>
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – Key under which sampled values will be stored in <code class="docutils literal notranslate"><span class="pre">self.data</span></code>.</p></li>
<li><p><strong>resolution</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <em>optional</em>) – Unused placeholder (kept for API symmetry). Defaults to <code class="docutils literal notranslate"><span class="pre">1</span></code>.</p></li>
<li><p><strong>Attributes</strong> (<em>(</em><em>Re</em><em>)</em><em>defined</em>)</p></li>
<li><p><strong>----------------------</strong></p></li>
<li><p><strong>data</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>) – Adds/overwrites entry <code class="docutils literal notranslate"><span class="pre">self.data[name]</span></code> with sampled values
(NumPy array of length equal to the number of nodes).</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The method runs:
<code class="docutils literal notranslate"><span class="pre">gmt</span> <span class="pre">grdtrack</span> <span class="pre">-R-181/181/-90/90</span> <span class="pre">{filename2}</span> <span class="pre">-G{path}</span> <span class="pre">-N</span> <span class="pre">&gt;</span> <span class="pre">temp.txt</span> <span class="pre">-Vq</span></code>
to ensure wrap-around at the dateline for node sampling.</p></li>
<li><p>A temporary <code class="docutils literal notranslate"><span class="pre">temp.txt</span></code> is produced and then removed.</p></li>
<li><p>Requires GMT to be installed and accessible on <code class="docutils literal notranslate"><span class="pre">PATH</span></code>.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.utils.eaNodes.makegrid">
<span class="sig-name descname"><span class="pre">makegrid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">plotq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#eaNodes.makegrid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.eaNodes.makegrid" title="Link to this definition">¶</a></dt>
<dd><p>Construct the equal-area diamond grid and nearest-neighbor connectivity.</p>
<p>This method tessellates the sphere with 12 rotated diamond patches,
generates node coordinates on a <strong>unit sphere</strong>, writes them to disk in
XYZ and lon/lat formats, and builds up to 4 nearest-neighbor connections
per node based on great-circle distances.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>plotq</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <em>optional</em>) – If non-zero, renders a 3D Plotly visualization of node positions.
<code class="docutils literal notranslate"><span class="pre">1</span></code> plots a scatter of non-duplicate nodes. Defaults to <code class="docutils literal notranslate"><span class="pre">0</span></code>.</p></li>
<li><p><strong>Attributes</strong> (<em>(</em><em>Re</em><em>)</em><em>defined</em>)</p></li>
<li><p><strong>----------------------</strong></p></li>
<li><p><strong>ealat</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – Node latitudes/longitudes in degrees (read from written files).</p></li>
<li><p><strong>ealon</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – Node latitudes/longitudes in degrees (read from written files).</p></li>
<li><p><strong>connectionNodeIDs</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">shape</span> <span class="pre">(N</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">5)</span></code>) – Columns: [node_id, nbr1, nbr2, nbr3, nbr4], with <code class="docutils literal notranslate"><span class="pre">None</span></code> where absent.</p></li>
<li><p><strong>connectionNodeDis</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">shape</span> <span class="pre">(N</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">5)</span></code>) – Columns: [node_id, d1, d2, d3, d4] (unit-sphere chord/arc distances).</p></li>
<li><p><strong>color</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – Colors used for plotting patches (flattened, duplicates removed).</p></li>
<li><p><strong>Effects</strong> (<em>Side</em>)</p></li>
<li><p><strong>------------</strong></p></li>
<li><p><strong>absent.</strong> (<em>- Creates directory ./Nodes if</em>)</p></li>
<li><p><strong>Writes</strong> (<em>-</em>) – <ul>
<li><p><code class="docutils literal notranslate"><span class="pre">EA_Nodes_{resolution}_xyz.txt</span></code> (node ID + x, y, z)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">EA_Nodes_{resolution}_LatLon.txt</span></code> (lon, lat)</p></li>
</ul>
</p></li>
<li><p><strong>True</strong><strong>)</strong><strong>.</strong> (<em>- Optionally writes a compressed .npz</em><em> (</em><em>if self.precalculate is</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.utils.eaNodes.rotate_around_vec_by_a">
<span class="sig-name descname"><span class="pre">rotate_around_vec_by_a</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#eaNodes.rotate_around_vec_by_a"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.eaNodes.rotate_around_vec_by_a" title="Link to this definition">¶</a></dt>
<dd><p>Build a 3×3 rotation matrix for rotation by angle <code class="docutils literal notranslate"><span class="pre">A</span></code> about an arbitrary axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>A</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – Rotation angle in <strong>radians</strong>.</p></li>
<li><p><strong>x</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – Components of the rotation axis vector (need not be unit length).</p></li>
<li><p><strong>y</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – Components of the rotation axis vector (need not be unit length).</p></li>
<li><p><strong>z</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – Components of the rotation axis vector (need not be unit length).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Rotation matrix <code class="docutils literal notranslate"><span class="pre">R</span></code> such that <code class="docutils literal notranslate"><span class="pre">R</span> <span class="pre">&#64;</span> <span class="pre">v</span></code> rotates vector <code class="docutils literal notranslate"><span class="pre">v</span></code> by
<code class="docutils literal notranslate"><span class="pre">A</span></code> about the axis <code class="docutils literal notranslate"><span class="pre">(x,</span> <span class="pre">y,</span> <span class="pre">z)</span></code> (right-hand rule).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">shape</span> <span class="pre">(3</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">3)</span></code></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Implements Rodrigues’ rotation formula after normalizing the axis.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.utils.eaNodes.rotate_vector">
<span class="sig-name descname"><span class="pre">rotate_vector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">from_vec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_vec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">by_angle</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#eaNodes.rotate_vector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.eaNodes.rotate_vector" title="Link to this definition">¶</a></dt>
<dd><p>Rotate a vector about the axis defined by <code class="docutils literal notranslate"><span class="pre">from_vec</span> <span class="pre">×</span> <span class="pre">to_vec</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>from_vec</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">array_like</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">shape</span> <span class="pre">(3,)</span></code>) – Reference vector that defines the rotation axis with <code class="docutils literal notranslate"><span class="pre">to_vec</span></code>.</p></li>
<li><p><strong>to_vec</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">array_like</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">shape</span> <span class="pre">(3,)</span></code>) – Target vector that defines the rotation axis with <code class="docutils literal notranslate"><span class="pre">from_vec</span></code>.</p></li>
<li><p><strong>by_angle</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – Rotation angle in <strong>radians</strong>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Rotated copy of <code class="docutils literal notranslate"><span class="pre">from_vec</span></code> by <code class="docutils literal notranslate"><span class="pre">by_angle</span></code> around <code class="docutils literal notranslate"><span class="pre">from_vec</span> <span class="pre">×</span> <span class="pre">to_vec</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">shape</span> <span class="pre">(3,)</span></code></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The axis is the cross product of the two input vectors. No normalization
of the inputs is required; the axis is normalized internally.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.utils.eaNodes.save_or_load_attributes">
<span class="sig-name descname"><span class="pre">save_or_load_attributes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'w'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#eaNodes.save_or_load_attributes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.eaNodes.save_or_load_attributes" title="Link to this definition">¶</a></dt>
<dd><p>Save or load all class attributes to/from a compressed <code class="docutils literal notranslate"><span class="pre">.npz</span></code> file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mode</strong> (<code class="docutils literal notranslate"><span class="pre">{'w','r'}</span></code>, <em>optional</em>) – <ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'w'</span></code>: write current attributes to disk</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'r'</span></code>: read attributes from disk into this object</p></li>
</ul>
</p></li>
<li><p><strong>File</strong></p></li>
<li><p><strong>----</strong></p></li>
<li><p><strong>named</strong> (<em>The file is created under ./Nodes and</em>)</p></li>
<li><p><strong>EA_Nodes_{resolution}.npz.</strong></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if the operation succeeded, <code class="docutils literal notranslate"><span class="pre">False</span></code> if reading failed
due to a missing file.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Paths like <code class="docutils literal notranslate"><span class="pre">filename1</span></code>, <code class="docutils literal notranslate"><span class="pre">filename2</span></code>, <code class="docutils literal notranslate"><span class="pre">interpGrid</span></code>, and <code class="docutils literal notranslate"><span class="pre">output</span></code>
are <strong>recomputed</strong> on load to reflect the current working directory,
rather than trusting serialized paths from another system.</p></li>
<li><p>Dict-like attributes are stored with <code class="docutils literal notranslate"><span class="pre">allow_pickle=True</span></code>.</p></li>
</ul>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ExoCcycle.utils.edllNodes">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ExoCcycle.utils.</span></span><span class="sig-name descname"><span class="pre">edllNodes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'undefined':</span> <span class="pre">True}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precalculated</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precalculate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">region</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#edllNodes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.edllNodes" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Equally spaced latitude–longitude node generator (EDLL) with utilities.</p>
<p>This class constructs a grid of points evenly spaced in <em>latitude</em> and
<em>longitude</em> over a user-specified rectangular region. It mirrors the I/O
and attribute structure of <a class="reference internal" href="#ExoCcycle.utils.eaNodes" title="ExoCcycle.utils.eaNodes"><code class="xref py py-class docutils literal notranslate"><span class="pre">eaNodes</span></code></a> so downstream code can treat
both grid types uniformly. The class can persist grid geometry and basic
connectivity to a compressed <code class="docutils literal notranslate"><span class="pre">.npz</span></code> and reload it later. It also supports
sampling gridded datasets onto the node locations via GMT <code class="docutils literal notranslate"><span class="pre">grdtrack</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>, <em>optional</em>) – Initialization options. Recognized keys include:
- <code class="docutils literal notranslate"><span class="pre">&quot;resolution&quot;</span></code> (float): Node spacing in <strong>degrees</strong> (Δlon = Δlat).
- <code class="docutils literal notranslate"><span class="pre">&quot;dataGrid&quot;</span></code> (str): Path to an input data grid (for user workflows).
If <code class="docutils literal notranslate"><span class="pre">{&quot;undefined&quot;:</span> <span class="pre">True}</span></code> (default), internal defaults are assigned.</p></li>
<li><p><strong>precalculated</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, attempt to load a previously saved set of attributes from
disk upon initialization. Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>precalculate</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, write the current attributes to disk after grid creation.
Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>region</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">array_like</span></code> or <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>, <em>optional</em>) – 2×2 array-like defining the analysis extent as
<code class="docutils literal notranslate"><span class="pre">[[lon_min,</span> <span class="pre">lat_min],</span> <span class="pre">[lon_max,</span> <span class="pre">lat_max]]</span></code> in <strong>degrees</strong>.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, a small default region is used: <code class="docutils literal notranslate"><span class="pre">[[-100,</span> <span class="pre">20],</span> <span class="pre">[-80,</span> <span class="pre">31]]</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="ExoCcycle.utils.edllNodes.inputs">
<span class="sig-name descname"><span class="pre">inputs</span></span><a class="headerlink" href="#ExoCcycle.utils.edllNodes.inputs" title="Link to this definition">¶</a></dt>
<dd><p>Initialization dictionary (stored as provided or with defaults).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ExoCcycle.utils.edllNodes.resolution">
<span class="sig-name descname"><span class="pre">resolution</span></span><a class="headerlink" href="#ExoCcycle.utils.edllNodes.resolution" title="Link to this definition">¶</a></dt>
<dd><p>Grid spacing in degrees.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ExoCcycle.utils.edllNodes.region">
<span class="sig-name descname"><span class="pre">region</span></span><a class="headerlink" href="#ExoCcycle.utils.edllNodes.region" title="Link to this definition">¶</a></dt>
<dd><p>Region bounding box <code class="docutils literal notranslate"><span class="pre">[[lon_min,</span> <span class="pre">lat_min],</span> <span class="pre">[lon_max,</span> <span class="pre">lat_max]]</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">shape</span> <span class="pre">(2</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">2)</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ExoCcycle.utils.edllNodes.dataGrid">
<span class="sig-name descname"><span class="pre">dataGrid</span></span><a class="headerlink" href="#ExoCcycle.utils.edllNodes.dataGrid" title="Link to this definition">¶</a></dt>
<dd><p>Path to an input grid (if provided).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ExoCcycle.utils.edllNodes.interpGrid">
<span class="sig-name descname"><span class="pre">interpGrid</span></span><a class="headerlink" href="#ExoCcycle.utils.edllNodes.interpGrid" title="Link to this definition">¶</a></dt>
<dd><p>Path to the node list in lon/lat text format.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ExoCcycle.utils.edllNodes.output">
<span class="sig-name descname"><span class="pre">output</span></span><a class="headerlink" href="#ExoCcycle.utils.edllNodes.output" title="Link to this definition">¶</a></dt>
<dd><p>Default output path (for user workflows).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ExoCcycle.utils.edllNodes.filename1">
<span class="sig-name descname"><span class="pre">filename1</span></span><a class="headerlink" href="#ExoCcycle.utils.edllNodes.filename1" title="Link to this definition">¶</a></dt>
<dd><p>File with node indices and XYZ coordinates (txt).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ExoCcycle.utils.edllNodes.filename2">
<span class="sig-name descname"><span class="pre">filename2</span></span><a class="headerlink" href="#ExoCcycle.utils.edllNodes.filename2" title="Link to this definition">¶</a></dt>
<dd><p>File with node lon/lat coordinates (txt).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">ealon,</span> <span class="pre">ealat</span></span></dt>
<dd><p>Node longitudes/latitudes (degrees), defined after <a class="reference internal" href="#ExoCcycle.utils.edllNodes.makegrid" title="ExoCcycle.utils.edllNodes.makegrid"><code class="xref py py-meth docutils literal notranslate"><span class="pre">makegrid()</span></code></a>
or when loading a saved grid.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code> or <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ExoCcycle.utils.edllNodes.connectionNodeIDs">
<span class="sig-name descname"><span class="pre">connectionNodeIDs</span></span><a class="headerlink" href="#ExoCcycle.utils.edllNodes.connectionNodeIDs" title="Link to this definition">¶</a></dt>
<dd><p>Array with columns: <code class="docutils literal notranslate"><span class="pre">[node_id,</span> <span class="pre">west_id,</span> <span class="pre">east_id,</span> <span class="pre">north_id,</span> <span class="pre">south_id]</span></code>,
where missing neighbors are <code class="docutils literal notranslate"><span class="pre">None</span></code> (set by <a class="reference internal" href="#ExoCcycle.utils.edllNodes.makegrid" title="ExoCcycle.utils.edllNodes.makegrid"><code class="xref py py-meth docutils literal notranslate"><span class="pre">makegrid()</span></code></a>).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ExoCcycle.utils.edllNodes.connectionNodeDis">
<span class="sig-name descname"><span class="pre">connectionNodeDis</span></span><a class="headerlink" href="#ExoCcycle.utils.edllNodes.connectionNodeDis" title="Link to this definition">¶</a></dt>
<dd><p>Array with columns: <code class="docutils literal notranslate"><span class="pre">[node_id,</span> <span class="pre">dW,</span> <span class="pre">dE,</span> <span class="pre">dN,</span> <span class="pre">dS]</span></code> (unit-sphere distances),
set by <a class="reference internal" href="#ExoCcycle.utils.edllNodes.makegrid" title="ExoCcycle.utils.edllNodes.makegrid"><code class="xref py py-meth docutils literal notranslate"><span class="pre">makegrid()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">color,</span> <span class="pre">hist</span></span></dt>
<dd><p>Placeholders for symmetry with <a class="reference internal" href="#ExoCcycle.utils.eaNodes" title="ExoCcycle.utils.eaNodes"><code class="xref py py-class docutils literal notranslate"><span class="pre">eaNodes</span></code></a> (no semantic meaning here).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">any</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ExoCcycle.utils.edllNodes.data">
<span class="sig-name descname"><span class="pre">data</span></span><a class="headerlink" href="#ExoCcycle.utils.edllNodes.data" title="Link to this definition">¶</a></dt>
<dd><p>Mapping of sampled variable name → values at node locations.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">precalculated,</span> <span class="pre">precalculate</span></span></dt>
<dd><p>Flags controlling load/save behavior.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Notes</p>
<ul class="simple">
<li><p>All artifacts are written under <code class="docutils literal notranslate"><span class="pre">./Nodes</span></code> (created if missing).</p></li>
<li><p>Spherical calculations assume a <strong>unit sphere</strong> unless otherwise noted.</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.utils.edllNodes.interp2IrregularGrid">
<span class="sig-name descname"><span class="pre">interp2IrregularGrid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#edllNodes.interp2IrregularGrid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.edllNodes.interp2IrregularGrid" title="Link to this definition">¶</a></dt>
<dd><p>Interpolate gridded values to node locations via GMT <code class="docutils literal notranslate"><span class="pre">grdtrack</span></code>.</p>
<p>Samples the provided grid at the lon/lat node positions stored in
<code class="docutils literal notranslate"><span class="pre">self.filename2</span></code> and writes the sampled values into
<code class="docutils literal notranslate"><span class="pre">self.data[name]</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – Path to an input grid readable by GMT (e.g., NetCDF grid).</p></li>
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – Key to store the sampled values in <code class="docutils literal notranslate"><span class="pre">self.data</span></code>.</p></li>
<li><p><strong>resolution</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <em>optional</em>) – Unused placeholder (kept for API symmetry). Defaults to <code class="docutils literal notranslate"><span class="pre">1</span></code>.</p></li>
<li><p><strong>Attributes</strong> (<em>(</em><em>Re</em><em>)</em><em>defined</em>)</p></li>
<li><p><strong>----------------------</strong></p></li>
<li><p><strong>data</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>) – Adds/overwrites entry <code class="docutils literal notranslate"><span class="pre">self.data[name]</span></code> with sampled values
(NumPy array, length = number of nodes).</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Runs:
<code class="docutils literal notranslate"><span class="pre">gmt</span> <span class="pre">grdtrack</span> <span class="pre">-R-181/181/-90/90</span> <span class="pre">{filename2}</span> <span class="pre">-G{path}</span> <span class="pre">-N</span> <span class="pre">&gt;</span> <span class="pre">temp.txt</span> <span class="pre">-Vq</span></code>
using a slightly extended longitude range to handle wrap-around at the dateline.</p></li>
<li><p>A temporary <code class="docutils literal notranslate"><span class="pre">temp.txt</span></code> is produced and then removed.</p></li>
<li><p>Requires GMT to be installed and available on <code class="docutils literal notranslate"><span class="pre">PATH</span></code>.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.utils.edllNodes.makegrid">
<span class="sig-name descname"><span class="pre">makegrid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">plotq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#edllNodes.makegrid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.edllNodes.makegrid" title="Link to this definition">¶</a></dt>
<dd><p>Build the equally spaced lon–lat grid and 4-neighbor connectivity.</p>
<p>This method creates a regular lattice over <code class="docutils literal notranslate"><span class="pre">self.region</span></code> with spacing
<code class="docutils literal notranslate"><span class="pre">self.resolution</span></code> in both longitude and latitude, writes node
coordinates to disk (XYZ and lon/lat), and constructs a 4-neighbor
connectivity (west, east, north, south) with unit-sphere distances.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>plotq</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">1</span></code>, display a 3D Plotly visualization of the nodes on a sphere.
Defaults to <code class="docutils literal notranslate"><span class="pre">0</span></code>.</p></li>
<li><p><strong>Attributes</strong> (<em>(</em><em>Re</em><em>)</em><em>defined</em>)</p></li>
<li><p><strong>----------------------</strong></p></li>
<li><p><strong>ealon</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – Node longitudes and latitudes (degrees), flattened meshgrid.</p></li>
<li><p><strong>ealat</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – Node longitudes and latitudes (degrees), flattened meshgrid.</p></li>
<li><p><strong>connectionNodeIDs</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">shape</span> <span class="pre">(N</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">5)</span></code>) – Node ID plus west/east/north/south neighbor IDs (<code class="docutils literal notranslate"><span class="pre">None</span></code> at edges).</p></li>
<li><p><strong>connectionNodeDis</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">shape</span> <span class="pre">(N</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">5)</span></code>) – Node ID plus corresponding distances to those neighbors (unit sphere).</p></li>
<li><p><strong>Effects</strong> (<em>Side</em>)</p></li>
<li><p><strong>------------</strong></p></li>
<li><p><strong>Writes</strong> (<em>-</em>) – <ul>
<li><p><code class="docutils literal notranslate"><span class="pre">EDLL_Nodes_{resolution}_xyz.txt</span></code> (node ID + x, y, z)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">EDLL_Nodes_{resolution}_LatLon.txt</span></code> (lon, lat)</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.utils.edllNodes.save_or_load_attributes">
<span class="sig-name descname"><span class="pre">save_or_load_attributes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'w'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#edllNodes.save_or_load_attributes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.edllNodes.save_or_load_attributes" title="Link to this definition">¶</a></dt>
<dd><p>Save or load all class attributes to/from a compressed <code class="docutils literal notranslate"><span class="pre">.npz</span></code> file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mode</strong> (<code class="docutils literal notranslate"><span class="pre">{'w',</span> <span class="pre">'r'}</span></code>, <em>optional</em>) – <ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'w'</span></code>: Write current attributes to disk.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'r'</span></code>: Read attributes from disk into this object.</p></li>
</ul>
</p></li>
<li><p><strong>File</strong></p></li>
<li><p><strong>----</strong></p></li>
<li><p><strong>named</strong> (<em>Stored under ./Nodes and</em>)</p></li>
<li><p><strong>EDLL_Nodes_{resolution}.npz.</strong></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if the operation succeeded, <code class="docutils literal notranslate"><span class="pre">False</span></code> if reading failed
because the file was not found.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Paths like <code class="docutils literal notranslate"><span class="pre">filename1</span></code>, <code class="docutils literal notranslate"><span class="pre">filename2</span></code>, <code class="docutils literal notranslate"><span class="pre">interpGrid</span></code>, and <code class="docutils literal notranslate"><span class="pre">output</span></code>
are <strong>recomputed</strong> on load to reflect the current working directory,
rather than trusting serialized paths from another system.</p></li>
<li><p>Dict-like attributes are stored with <code class="docutils literal notranslate"><span class="pre">allow_pickle=True</span></code>.</p></li>
</ul>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ExoCcycle.utils.filterNc">
<span class="sig-prename descclassname"><span class="pre">ExoCcycle.utils.</span></span><span class="sig-name descname"><span class="pre">filterNc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'gt':</span> <span class="pre">None,</span> <span class="pre">'inputFile':</span> <span class="pre">None,</span> <span class="pre">'lr':</span> <span class="pre">None,</span> <span class="pre">'outputFile':</span> <span class="pre">None,</span> <span class="pre">'threshold':</span> <span class="pre">None}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepVars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['lat',</span> <span class="pre">'lon',</span> <span class="pre">'bathymetry']</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#filterNc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.filterNc" title="Link to this definition">¶</a></dt>
<dd><p>Filters and copies selected variables from a NetCDF file into a new one.</p>
<p>This function opens an input NetCDF file, copies only the specified
variables and their required dimensions, and optionally filters one
variable by a numeric threshold (setting values to <code class="docutils literal notranslate"><span class="pre">NaN</span></code>). The result
is written to a new NetCDF file in <code class="docutils literal notranslate"><span class="pre">NETCDF4_CLASSIC</span></code> format while
preserving global attributes.</p>
<dl>
<dt>Args:</dt><dd><dl>
<dt>options (dict, optional):</dt><dd><p>Configuration dictionary controlling file I/O and filtering.
Recognized keys include:</p>
<ul class="simple">
<li><p><strong>inputFile</strong> (<cite>str</cite> or <cite>path-like</cite>): Path to the source NetCDF file to read. <strong>Required</strong>.</p></li>
<li><p><strong>outputFile</strong> (<cite>str</cite> or <cite>path-like</cite>, optional): Path to the destination NetCDF file to create.
Defaults to <code class="docutils literal notranslate"><span class="pre">os.getcwd()</span> <span class="pre">+</span> <span class="pre">&quot;/filteredNc.nc&quot;</span></code>.</p></li>
<li><p><strong>threshold</strong> (<cite>float</cite>, optional): Threshold used for filtering values in <code class="docutils literal notranslate"><span class="pre">varName</span></code>.</p></li>
<li><p><strong>le</strong> (<cite>bool</cite>, optional): If True, sets values <code class="docutils literal notranslate"><span class="pre">&lt;=</span> <span class="pre">threshold</span></code> in <code class="docutils literal notranslate"><span class="pre">varName</span></code> to <code class="docutils literal notranslate"><span class="pre">NaN</span></code>.</p></li>
<li><p><strong>gt</strong> (<cite>bool</cite>, optional): If True, sets values <code class="docutils literal notranslate"><span class="pre">&gt;</span> <span class="pre">threshold</span></code> in <code class="docutils literal notranslate"><span class="pre">varName</span></code> to <code class="docutils literal notranslate"><span class="pre">NaN</span></code>.</p></li>
<li><p><strong>varName</strong> (<cite>str</cite>, optional): Name of the variable to which the threshold filtering applies.</p></li>
</ul>
<p>If a key is not provided, a default value is assigned at runtime.
Both <code class="docutils literal notranslate"><span class="pre">le</span></code> and <code class="docutils literal notranslate"><span class="pre">gt</span></code> cannot be True simultaneously — an error will be raised if this occurs.</p>
</dd>
<dt>keepVars (list of str, optional):</dt><dd><p>List of variable names to retain and copy into the output file.
Only dimensions required by these variables are written.
Defaults to <code class="docutils literal notranslate"><span class="pre">['lat',</span> <span class="pre">'lon',</span> <span class="pre">'bathymetry']</span></code>.</p>
</dd>
</dl>
</dd>
<dt>Raises:</dt><dd><dl class="simple">
<dt>ValueError:</dt><dd><ul class="simple">
<li><p>If both <code class="docutils literal notranslate"><span class="pre">le</span></code> and <code class="docutils literal notranslate"><span class="pre">gt</span></code> are True (mutually exclusive filtering).</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">inputFile</span></code> is not defined in the options dictionary.</p></li>
</ul>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>None:</dt><dd><p>The function writes a new NetCDF file to disk and does not return a value.</p>
</dd>
</dl>
</dd>
<dt>Notes:</dt><dd><ul class="simple">
<li><p>Filtering is applied only when the variable name matches <code class="docutils literal notranslate"><span class="pre">options[&quot;varName&quot;]</span></code>.</p></li>
<li><p>Other listed variables are copied verbatim.</p></li>
<li><p>The input file is never modified; a new file is always created.</p></li>
<li><p>If the filtered variable has an integer dtype, assigning <code class="docutils literal notranslate"><span class="pre">NaN</span></code> may upcast
the result when read back into NumPy.</p></li>
</ul>
</dd>
<dt>See Also:</dt><dd><p>netCDF4.Dataset: Interface for reading and writing NetCDF files.
numpy.isnan: Check for NaN values.
os.getcwd: Used to determine the default output path.</p>
</dd>
<dt>Example:</dt><dd><p>Copy latitude, longitude, and bathymetry variables while filtering
bathymetry values below sea level:</p>
<p><a href="#id59"><span class="problematic" id="id60">``</span></a><a href="#id61"><span class="problematic" id="id62">`</span></a>python
import os</p>
<dl class="simple">
<dt>opts = {</dt><dd><p>“inputFile”: “in.nc”,
“outputFile”: os.path.join(os.getcwd(), “out.nc”),
“threshold”: 0.0,
“le”: True,    # set values &lt;= 0.0 to NaN
“gt”: False,   # do not filter values &gt; threshold
“varName”: “bathymetry”</p>
</dd>
</dl>
<p>}</p>
<p>filterNc(opts, keepVars=[“lat”, “lon”, “bathymetry”])  # doctest: +SKIP
<a href="#id63"><span class="problematic" id="id64">``</span></a><a href="#id65"><span class="problematic" id="id66">`</span></a></p>
<p>The resulting file <code class="docutils literal notranslate"><span class="pre">out.nc</span></code> will contain only the specified variables
and their dimensions, with bathymetry filtered according to the given threshold.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ExoCcycle.utils.haversine_distance">
<span class="sig-prename descclassname"><span class="pre">ExoCcycle.utils.</span></span><span class="sig-name descname"><span class="pre">haversine_distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lat1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#haversine_distance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.haversine_distance" title="Link to this definition">¶</a></dt>
<dd><p>Great-circle distance via the Haversine formula.</p>
<p>Computes the central–angle distance between two points on a sphere and
returns the arc length in the same units as <code class="docutils literal notranslate"><span class="pre">radius</span></code>. Supports NumPy
broadcasting, so <code class="docutils literal notranslate"><span class="pre">lat2</span></code>/<code class="docutils literal notranslate"><span class="pre">lon2</span></code> may be vectors/arrays.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lat1</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a> or <code class="xref py py-class docutils literal notranslate"><span class="pre">array_like</span></code>) – Latitude of the first point in <strong>degrees</strong> (positive north).</p></li>
<li><p><strong>lon1</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a> or <code class="xref py py-class docutils literal notranslate"><span class="pre">array_like</span></code>) – Longitude of the first point in <strong>degrees</strong> (positive east).</p></li>
<li><p><strong>lat2</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a> or <code class="xref py py-class docutils literal notranslate"><span class="pre">array_like</span></code>) – Latitude of the second point in <strong>degrees</strong>. Can be a vector/array
broadcastable against <code class="docutils literal notranslate"><span class="pre">lat1</span></code>.</p></li>
<li><p><strong>lon2</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a> or <code class="xref py py-class docutils literal notranslate"><span class="pre">array_like</span></code>) – Longitude of the second point in <strong>degrees</strong>. Can be a vector/array
broadcastable against <code class="docutils literal notranslate"><span class="pre">lon1</span></code>.</p></li>
<li><p><strong>radius</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – Sphere radius (e.g., <code class="docutils literal notranslate"><span class="pre">6371e3</span></code> for Earth in meters). The returned
distance uses the same units.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>distance</strong> – Great-circle distance(s) between the points, in units of <code class="docutils literal notranslate"><span class="pre">radius</span></code>.
Shape follows NumPy broadcasting of the inputs.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a> or <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Formula: <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">=</span> <span class="pre">sin²(Δφ/2)</span> <span class="pre">+</span> <span class="pre">cos</span> <span class="pre">φ1</span> <span class="pre">·</span> <span class="pre">cos</span> <span class="pre">φ2</span> <span class="pre">·</span> <span class="pre">sin²(Δλ/2)</span></code>,
<code class="docutils literal notranslate"><span class="pre">c</span> <span class="pre">=</span> <span class="pre">2·atan2(√a,</span> <span class="pre">√(1−a))</span></code>, <code class="docutils literal notranslate"><span class="pre">d</span> <span class="pre">=</span> <span class="pre">R·c</span></code>.</p></li>
<li><p>Inputs are converted to radians internally.</p></li>
<li><p>Works for scalar or array inputs; all arguments are broadcast together.</p></li>
</ul>
<p class="rubric">Examples</p>
<p>Distance (km) between two cities (approx.):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">R_earth</span> <span class="o">=</span> <span class="mf">6371.0</span>  <span class="c1"># km</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">haversine_distance</span><span class="p">(</span><span class="mf">37.7749</span><span class="p">,</span> <span class="o">-</span><span class="mf">122.4194</span><span class="p">,</span> <span class="mf">34.0522</span><span class="p">,</span> <span class="o">-</span><span class="mf">118.2437</span><span class="p">,</span> <span class="n">R_earth</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">round</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># San Francisco ↔ Los Angeles</span>
<span class="go">559.1</span>
</pre></div>
</div>
<p>Vectorized against a single origin:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lat1</span><span class="p">,</span> <span class="n">lon1</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lat2</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lon2</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">haversine_distance</span><span class="p">(</span><span class="n">lat1</span><span class="p">,</span> <span class="n">lon1</span><span class="p">,</span> <span class="n">lat2</span><span class="p">,</span> <span class="n">lon2</span><span class="p">,</span> <span class="n">R_earth</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(3,)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ExoCcycle.utils.lonlat2xyz">
<span class="sig-prename descclassname"><span class="pre">ExoCcycle.utils.</span></span><span class="sig-name descname"><span class="pre">lonlat2xyz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">longitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#lonlat2xyz"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.lonlat2xyz" title="Link to this definition">¶</a></dt>
<dd><p>Convert geographic coordinates (longitude, latitude) to Cartesian (X, Y, Z) coordinates
on a sphere.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>longitude</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a> or <code class="xref py py-class docutils literal notranslate"><span class="pre">array_like</span></code>) – Longitude(s) in degrees. Positive east of Greenwich.</p></li>
<li><p><strong>latitude</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a> or <code class="xref py py-class docutils literal notranslate"><span class="pre">array_like</span></code>) – Latitude(s) in degrees. Positive north of the equator.</p></li>
<li><p><strong>radius</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, <em>optional</em>) – Radius of the sphere. Defaults to 1.0 (unit sphere).
For Earth, use ~6_371_000 meters.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>x, y, z</strong> – Cartesian coordinates corresponding to the input points, in the same
units as <code class="docutils literal notranslate"><span class="pre">radius</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a> or <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This transformation assumes a right-handed coordinate system:
- The X-axis passes through longitude = 0°, latitude = 0°.
- The Y-axis passes through longitude = 90°, latitude = 0°.
- The Z-axis points toward the North Pole (latitude = +90°).</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lonlat2xyz</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">(1.0, 0.0, 0.0)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lonlat2xyz</span><span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">(6.123233995736766e-17, 1.0, 0.0)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lonlat2xyz</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">90</span><span class="p">)</span>
<span class="go">(0.0, 0.0, 1.0)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ExoCcycle.utils.makeFolderSeries">
<span class="sig-prename descclassname"><span class="pre">ExoCcycle.utils.</span></span><span class="sig-name descname"><span class="pre">makeFolderSeries</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fldBase</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fldBase'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxFolders</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#makeFolderSeries"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.makeFolderSeries" title="Link to this definition">¶</a></dt>
<dd><p>Create a uniquely named folder in a numbered series.</p>
<p>The function attempts to create a new folder following the pattern
<code class="docutils literal notranslate"><span class="pre">&quot;{fldBase}_{i}&quot;</span></code>, where <code class="docutils literal notranslate"><span class="pre">i</span></code> starts at 0 and increments until
a non-existing folder name is found or <code class="docutils literal notranslate"><span class="pre">maxFolders</span></code> is reached.
Once a folder is successfully created, its name (including the
numeric suffix) is returned.</p>
<dl>
<dt>Args:</dt><dd><dl class="simple">
<dt>fldBase (str, optional):</dt><dd><p>The base name for the folder series (e.g., <code class="docutils literal notranslate"><span class="pre">&quot;run&quot;</span></code> will produce
<code class="docutils literal notranslate"><span class="pre">run_0</span></code>, <code class="docutils literal notranslate"><span class="pre">run_1</span></code>, …). Defaults to <code class="docutils literal notranslate"><span class="pre">&quot;fldBase&quot;</span></code>.</p>
</dd>
<dt>maxFolders (int, optional):</dt><dd><p>The maximum number of folders to attempt before giving up.
Defaults to <code class="docutils literal notranslate"><span class="pre">1000</span></code>.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>str:</dt><dd><p>The name (path) of the folder successfully created, e.g. <code class="docutils literal notranslate"><span class="pre">&quot;fldBase_3&quot;</span></code>.</p>
</dd>
</dl>
</dd>
<dt>Raises:</dt><dd><dl class="simple">
<dt>FileExistsError:</dt><dd><p>If all possible folder names up to <code class="docutils literal notranslate"><span class="pre">maxFolders</span> <span class="pre">-</span> <span class="pre">1</span></code> already exist.</p>
</dd>
<dt>PermissionError:</dt><dd><p>If the process lacks permission to create folders in the current directory.</p>
</dd>
<dt>OSError:</dt><dd><p>For other OS-level errors during directory creation.</p>
</dd>
</dl>
</dd>
<dt>Notes:</dt><dd><ul class="simple">
<li><p>The function stops and returns as soon as a new folder is successfully created.</p></li>
<li><p>If all <code class="docutils literal notranslate"><span class="pre">maxFolders</span></code> already exist, the function raises <code class="docutils literal notranslate"><span class="pre">FileExistsError</span></code>.</p></li>
<li><p>Folders are created in the current working directory unless <code class="docutils literal notranslate"><span class="pre">fldBase</span></code> includes a path.</p></li>
</ul>
</dd>
<dt>Example:</dt><dd><p>Create the first available folder in a series named <code class="docutils literal notranslate"><span class="pre">simulation_0</span></code>, <code class="docutils literal notranslate"><span class="pre">simulation_1</span></code>, etc.:</p>
<p><code class="docutils literal notranslate"><span class="pre">`python</span>
<span class="pre">folder_path</span> <span class="pre">=</span> <span class="pre">makeFolderSeries(&quot;simulation&quot;,</span> <span class="pre">maxFolders=100)</span>
<span class="pre">print(f&quot;Created</span> <span class="pre">folder:</span> <span class="pre">{folder_path}&quot;)</span>
<span class="pre">`</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ExoCcycle.utils.mergerPackages">
<span class="sig-prename descclassname"><span class="pre">ExoCcycle.utils.</span></span><span class="sig-name descname"><span class="pre">mergerPackages</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">package</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#mergerPackages"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.mergerPackages" title="Link to this definition">¶</a></dt>
<dd><p>Return a predefined basin-merger configuration (or a pass-through default).</p>
<p>This helper provides ready-made <strong>basin merging strategies</strong> for different
reconstruction/modeling setups. Each strategy is encoded as a dictionary
describing:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>how to <strong>merge small basins</strong> below one or more thresholds, and</p></li>
<li><p>(optionally) how to <strong>merge specific basin IDs</strong> at designated
time/epoch markers.</p></li>
</ol>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>package</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <em>optional</em>) – <p>Name of the preset to load. Recognized values include (non-exhaustive):
- <code class="docutils literal notranslate"><span class="pre">&quot;EarthRecon3Basins_CM2009&quot;</span></code>
- <code class="docutils literal notranslate"><span class="pre">&quot;Lite&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Lite1&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Lite2&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Lite3&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Lite4&quot;</span></code>
- <code class="docutils literal notranslate"><span class="pre">&quot;LiteShelf0,3degree&quot;</span></code>
- <code class="docutils literal notranslate"><span class="pre">&quot;None&quot;</span></code>  (merge logic on, with zero threshold)
- <code class="docutils literal notranslate"><span class="pre">&quot;EarthRecon3BasinsRK2021_H_2,10e-12&quot;</span></code>,</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">&quot;EarthRecon3BasinsRK2021_H_4,80e-12&quot;</span></code>,
<code class="docutils literal notranslate"><span class="pre">&quot;EarthRecon3BasinsRK2021_H_8,00e-12&quot;</span></code></p>
</div></blockquote>
<p>Any other value (including the empty string) returns a conservative
default that <strong>does not merge</strong> basins.</p>
</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <em>optional</em>) – Currently not used inside this function, but included for API symmetry.
Default is <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><strong>mergerPackage</strong> – A configuration dictionary. Common keys:</p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">&quot;mergeSmallBasins&quot;</span></code><span class="classifier">dict</span></dt><dd><p>Controls threshold-based merging of very small basins.
Sub-keys:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;on&quot;</span></code> : bool — enable/disable this step.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;threshold&quot;</span></code> : ndarray of float — one or more thresholds.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;thresholdMethod&quot;</span></code> : str — interpretation of thresholds
(e.g., <code class="docutils literal notranslate"><span class="pre">&quot;%&quot;</span></code> means percent of total area).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;mergeMethod&quot;</span></code> : str — how to choose the target basin
(e.g., <code class="docutils literal notranslate"><span class="pre">&quot;nearBasinEdge&quot;</span></code>).</p></li>
</ul>
</div></blockquote>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">&quot;verbose&quot;</span></code><span class="classifier">bool</span></dt><dd><p>Optional flag for downstream verbosity.</p>
</dd>
</dl>
<p>The following keys may be present in some presets:</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">&quot;mergerID&quot;</span></code><span class="classifier">ndarray of int</span></dt><dd><p>Time/epoch markers or other indices at which explicit mergers
are defined.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">&quot;mergersX&quot;</span></code><span class="classifier">dict</span></dt><dd><p>For a marker <code class="docutils literal notranslate"><span class="pre">X</span></code> in <code class="docutils literal notranslate"><span class="pre">&quot;mergerID&quot;</span></code>, maps <strong>basin label</strong> (as a
string, e.g., <code class="docutils literal notranslate"><span class="pre">&quot;0&quot;</span></code>) to a <strong>list of basin IDs</strong> to merge with at
that marker. Example:
<code class="docutils literal notranslate"><span class="pre">'mergers10':</span> <span class="pre">{'0':[0,6,7,9,10],</span> <span class="pre">'1':[1,4],</span> <span class="pre">'2':[2,3,4,5]}</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">&quot;arrangeX&quot;</span></code><span class="classifier">list of int</span></dt><dd><p>Optional permutation of basin display/order at marker <code class="docutils literal notranslate"><span class="pre">X</span></code>.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Thresholds in the <code class="docutils literal notranslate"><span class="pre">&quot;mergeSmallBasins&quot;</span></code> block are typically <strong>decimal
fractions</strong> of total surface area; e.g., <code class="docutils literal notranslate"><span class="pre">0.5</span></code> means <em>0.5%</em> when
<code class="docutils literal notranslate"><span class="pre">thresholdMethod</span> <span class="pre">==</span> <span class="pre">&quot;%&quot;</span></code>.</p></li>
<li><p>Basin labels in the merger maps are <strong>strings</strong> (<code class="docutils literal notranslate"><span class="pre">&quot;0&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;1&quot;</span></code>, …),
while the lists they map to contain <strong>integer</strong> basin IDs.</p></li>
<li><p>The return value is intended to be consumed by a higher-level routine
that actually <strong>applies</strong> these merges to basin geometries/IDs.</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cfg</span> <span class="o">=</span> <span class="n">mergerPackages</span><span class="p">(</span><span class="s1">&#39;Lite&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfg</span><span class="p">[</span><span class="s1">&#39;mergeSmallBasins&#39;</span><span class="p">]</span>
<span class="go">{&#39;on&#39;: True, &#39;threshold&#39;: array([0.1 , 0.5]),</span>
<span class="go"> &#39;thresholdMethod&#39;: &#39;%&#39;, &#39;mergeMethod&#39;: &#39;nearBasinEdge&#39;}</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cfg</span> <span class="o">=</span> <span class="n">mergerPackages</span><span class="p">(</span><span class="s1">&#39;EarthRecon3Basins_CM2009&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="mi">10</span> <span class="ow">in</span> <span class="n">cfg</span><span class="p">[</span><span class="s1">&#39;mergerID&#39;</span><span class="p">]</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">keys</span><span class="p">())[:</span><span class="mi">3</span><span class="p">]</span>
<span class="go">[&#39;arrange0&#39;, &#39;arrange15&#39;, &#39;arrange20&#39;]  # plus many others (varies by preset)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ExoCcycle.utils.polygonAreaOnSphere">
<span class="sig-prename descclassname"><span class="pre">ExoCcycle.utils.</span></span><span class="sig-name descname"><span class="pre">polygonAreaOnSphere</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vertices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6371000.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#polygonAreaOnSphere"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.polygonAreaOnSphere" title="Link to this definition">¶</a></dt>
<dd><p>Compute the area of a spherical polygon via the spherical-excess method.</p>
<p>Great-circle arcs are assumed between consecutive vertices. The polygon
may be open or explicitly closed (i.e., repeating the first vertex at the
end is optional).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vertices</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list[tuple[float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float]]</span></code>) – Sequence of <code class="docutils literal notranslate"><span class="pre">(latitude,</span> <span class="pre">longitude)</span></code> vertex coordinates in <strong>degrees</strong>.
At least three vertices are required. Longitude may be any degree value
(wrapping is handled modulo 360).</p></li>
<li><p><strong>radius</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, <em>optional</em>) – Sphere radius. The default is Earth’s mean radius in meters
(<code class="docutils literal notranslate"><span class="pre">6371e3</span></code>). The output units scale with <code class="docutils literal notranslate"><span class="pre">radius**2</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Polygon area on the sphere, in the same squared units as <code class="docutils literal notranslate"><span class="pre">radius</span></code>
(e.g., m² when <code class="docutils literal notranslate"><span class="pre">radius</span></code> is in meters).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Edges are geodesics (great-circle segments).</p></li>
<li><p>The algorithm uses a running sum of signed angles; the final area is
based on the spherical excess <span class="math notranslate nohighlight">\(E = \left|\sum \alpha_i - (n-2)\pi\right|\)</span>.</p></li>
<li><p>Vertex ordering (clockwise vs. counter-clockwise) does not affect the
magnitude of the returned area due to the absolute value, but self-
intersecting polygons are not supported.</p></li>
<li><p>Numerical stability can degrade for very small polygons or for polygons
spanning antipodal points.</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Approximate area of a 1°x1° patch near the equator</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verts</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">area_m2</span> <span class="o">=</span> <span class="n">polygonAreaOnSphere</span><span class="p">(</span><span class="n">verts</span><span class="p">)</span>  <span class="c1"># radius default in meters</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#ExoCcycle.utils.haversine_distance" title="ExoCcycle.utils.haversine_distance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">haversine_distance</span></code></a></dt><dd><p>Great-circle distance between two points on a sphere.</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ExoCcycle.utils.synthField">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ExoCcycle.utils.</span></span><span class="sig-name descname"><span class="pre">synthField</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">registration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputFID</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#synthField"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.synthField" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>synthField is used to make synthetic bathymetry fields that can be
applied to communitiy detection algorithms to evaluate the algorithms’
efficacy.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.utils.synthField.addLine">
<span class="sig-name descname"><span class="pre">addLine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">startPos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">endPos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">magnitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#synthField.addLine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.synthField.addLine" title="Link to this definition">¶</a></dt>
<dd><p>addLine method is used to add a line of values
from startPos to endPos and assign them a magnitude.
Note that this method will override other non Nan
values. Note that this method can only make vertical
and horizonal lines and have the thickness of the
class’ resolution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>startPos</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">LIST</span></code>) – Starting position of position of the line (lon, lat),
in degrees.</p></li>
<li><p><strong>endPos</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">LIST</span></code>) – Ending position of position of the line (lon, lat),
in degrees.</p></li>
<li><p><strong>magnitude</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">FLOAT</span></code>) – magnitude of line, represented as a multiple of
1.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.utils.synthField.addShape">
<span class="sig-name descname"><span class="pre">addShape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">magnitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#synthField.addShape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.synthField.addShape" title="Link to this definition">¶</a></dt>
<dd><p>Add a cluster of magnitude values of a input shape
and size and centered at some position. The size
will be limited to the resolution of the synthField.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">STRING</span></code>) – The shape of the continent. Either ‘circle’ or
‘square’.</p></li>
<li><p><strong>size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">FLOAT</span></code>) – Input radius of circle or half length square,
in degrees.</p></li>
<li><p><strong>position</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">LIST</span></code>) – Input center position of the shape (lon, lat),
in degrees.</p></li>
<li><p><strong>magnitude</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">FLOAT</span></code>) – magnitude of shape, represented as a multiple of
1.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.utils.synthField.makenetCDF">
<span class="sig-name descname"><span class="pre">makenetCDF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#synthField.makenetCDF"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.synthField.makenetCDF" title="Link to this definition">¶</a></dt>
<dd><p>makenetCDF method is used to save the user created
grid to a netCDF4.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.utils.synthField.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#synthField.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.synthField.plot" title="Link to this definition">¶</a></dt>
<dd><p>plot is a simple plot method for class development.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ExoCcycle.utils.synthField.runTest">
<span class="sig-name descname"><span class="pre">runTest</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#synthField.runTest"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.synthField.runTest" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ExoCcycle.utils.weightedAvgAndStd">
<span class="sig-prename descclassname"><span class="pre">ExoCcycle.utils.</span></span><span class="sig-name descname"><span class="pre">weightedAvgAndStd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#weightedAvgAndStd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.weightedAvgAndStd" title="Link to this definition">¶</a></dt>
<dd><p>Compute the weighted average and weighted standard deviation.</p>
<p>The function calculates the mean and standard deviation of a numeric array
while accounting for a set of weights. NaN values in <code class="docutils literal notranslate"><span class="pre">values</span></code> are masked,
and the corresponding entries in <code class="docutils literal notranslate"><span class="pre">weights</span></code> are ignored.
The weights are normalized internally so that they sum to 1 (hence they
must not all be zero or NaN).</p>
<dl>
<dt>Args:</dt><dd><dl class="simple">
<dt>values (numpy.ndarray):</dt><dd><p>Array of numeric data for which to compute the weighted average and
standard deviation.</p>
</dd>
<dt>weights (numpy.ndarray):</dt><dd><p>Array of non-negative weights corresponding to <code class="docutils literal notranslate"><span class="pre">values</span></code>.
Must have the same shape as <code class="docutils literal notranslate"><span class="pre">values</span></code>.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>tuple[float, float]:</dt><dd><p>A tuple <code class="docutils literal notranslate"><span class="pre">(average,</span> <span class="pre">standard_deviation)</span></code> containing the weighted
mean and weighted standard deviation.</p>
</dd>
</dl>
</dd>
<dt>Raises:</dt><dd><dl class="simple">
<dt>ValueError:</dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">values</span></code> and <code class="docutils literal notranslate"><span class="pre">weights</span></code> do not have the same shape.</p>
</dd>
<dt>ZeroDivisionError:</dt><dd><p>If all weights are zero or NaN (cannot normalize).</p>
</dd>
<dt>TypeError:</dt><dd><p>If input arrays contain non-numeric types.</p>
</dd>
</dl>
</dd>
<dt>Notes:</dt><dd><ul class="simple">
<li><p>NaN values in <code class="docutils literal notranslate"><span class="pre">values</span></code> are automatically masked out.</p></li>
<li><p>The function uses <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.average.html#numpy.average" title="(in NumPy v2.3)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.average()</span></code></a> for mean and variance computation.</p></li>
<li><p>Variance is computed efficiently as
<code class="docutils literal notranslate"><span class="pre">np.average((values</span> <span class="pre">-</span> <span class="pre">mean)**2,</span> <span class="pre">weights=weights)</span></code>.</p></li>
<li><p>Returned standard deviation is the square root of this weighted variance.</p></li>
</ul>
</dd>
<dt>Example:</dt><dd><p>Compute a weighted mean and standard deviation:</p>
<p><code class="docutils literal notranslate"><span class="pre">`python</span>
<span class="pre">import</span> <span class="pre">numpy</span> <span class="pre">as</span> <span class="pre">np</span>
<span class="pre">values</span> <span class="pre">=</span> <span class="pre">np.array([1.0,</span> <span class="pre">2.0,</span> <span class="pre">3.0,</span> <span class="pre">np.nan])</span>
<span class="pre">weights</span> <span class="pre">=</span> <span class="pre">np.array([0.2,</span> <span class="pre">0.3,</span> <span class="pre">0.5,</span> <span class="pre">np.nan])</span>
<span class="pre">avg,</span> <span class="pre">std</span> <span class="pre">=</span> <span class="pre">weightedAvgAndStd(values,</span> <span class="pre">weights)</span>
<span class="pre">print(f&quot;Weighted</span> <span class="pre">mean:</span> <span class="pre">{avg:.2f},</span> <span class="pre">Weighted</span> <span class="pre">std:</span> <span class="pre">{std:.2f}&quot;)</span>
<span class="pre">`</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ExoCcycle.utils.xyz2lonlat">
<span class="sig-prename descclassname"><span class="pre">ExoCcycle.utils.</span></span><span class="sig-name descname"><span class="pre">xyz2lonlat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ExoCcycle/utils.html#xyz2lonlat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ExoCcycle.utils.xyz2lonlat" title="Link to this definition">¶</a></dt>
<dd><p>Convert Cartesian (X, Y, Z) coordinates to geographic coordinates
(longitude, latitude) on a sphere.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a> or <code class="xref py py-class docutils literal notranslate"><span class="pre">array_like</span></code>) – X coordinate(s), in the same units as <code class="docutils literal notranslate"><span class="pre">radius</span></code>.</p></li>
<li><p><strong>y</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a> or <code class="xref py py-class docutils literal notranslate"><span class="pre">array_like</span></code>) – Y coordinate(s), in the same units as <code class="docutils literal notranslate"><span class="pre">radius</span></code>.</p></li>
<li><p><strong>z</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a> or <code class="xref py py-class docutils literal notranslate"><span class="pre">array_like</span></code>) – Z coordinate(s), in the same units as <code class="docutils literal notranslate"><span class="pre">radius</span></code>.</p></li>
<li><p><strong>radius</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, <em>optional</em>) – Radius of the sphere. Defaults to 1.0 (unit sphere).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>longitude, latitude</strong> – Geographic coordinates in degrees.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a> or <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Longitude is computed from <code class="docutils literal notranslate"><span class="pre">atan2(y,</span> <span class="pre">x)</span></code>, ranging from -180° to 180°.</p></li>
<li><p>Latitude is computed from <code class="docutils literal notranslate"><span class="pre">atan2(z,</span> <span class="pre">sqrt(x²</span> <span class="pre">+</span> <span class="pre">y²))</span></code>, ranging from -90° to 90°.</p></li>
<li><p>The input coordinates need not be normalized by <code class="docutils literal notranslate"><span class="pre">radius</span></code>; this function
accounts for magnitude automatically.</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">xyz2lonlat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">(0.0, 0.0)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">xyz2lonlat</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">(90.0, 0.0)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">xyz2lonlat</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">(0.0, 90.0)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-ExoCcycle">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-ExoCcycle" title="Link to this heading">¶</a></h2>
<p>Created on Tue Sep  6 15:20:00 2024</p>
<p>&#64;author: Matthew Bogumil</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">ExoCcycle</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">ExoCcycle</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">ExoCcycle package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-ExoCcycle.Bathymetry">ExoCcycle.Bathymetry module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-ExoCcycle.plotHelper">ExoCcycle.plotHelper module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-ExoCcycle.utils">ExoCcycle.utils module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-ExoCcycle">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="modules.html">ExoCcycle</a><ul>
      <li>Previous: <a href="modules.html" title="previous chapter">ExoCcycle</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, ExoCcycle authors.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.1.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="../_sources/apidoc/ExoCcycle.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>